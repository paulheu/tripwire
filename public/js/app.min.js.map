{"version":3,"sources":["helpers.js","eve-scout.js","init.js","options.js","layout.js","tripwire.js","global-hooks.js","wormholeRendering.js","widget-inlinecomplete.js","systemAnalysis.js","favourite.js","invasions.js","guidance.js","systemRendering.js","chain-map-renderer-base.js","chain-map-renderer-orgchart-side.js","chain-map-renderer-orgchart-top.js","chain-map-renderer-orgchart.js","chain-map-renderer-radial.js","chain-map.js","guidance_profiles.js","systemPanel.js","active.js","addSignature.js","api.js","automapper.js","comments.js","deleteSignature.js","editSignature.js","esi.js","eve.js","genericSystemTypes.js","parse.js","paste.js","redo.js","serverStatus.js","sync.js","systemChange.js","tutorials.js","undo.js","activity-graph.js","ckeditor.js","firefox-jquery-css-zoom.js","fw.js","maskRendering.js","mass.js","tracking.js","wormholeAnalysis.js","dialogs/admin-dialog.js","dialogs/base-dialog.js","dialogs/mask-dialog.js","dialogs/mass-dialog.js","dialogs/options-dialog.js","dialogs/ping-dialog.js","dialogs/signature-delete-dialog.js","dialogs/signature-dialog.js"],"names":["Object","sort","obj","prop","swapped","prev","i","Number","tmp","index","val","cs","key","toLowerCase","find","$","fn","serializeObject","self","this","json","push_counters","patterns","validate","push","fixed","named","build","base","value","push_counter","undefined","each","serializeArray","test","name","k","keys","match","merge","reverse_key","pop","replace","RegExp","extend","jQuery","letterToNumbers","string","toUpperCase","letters","sum","length","Math","pow","indexOf","substr","positionRelativeTo","elem","ancestor","elemPos","getBoundingClientRect","ancestorPos","left","scrollLeft","top","scrollTop","lookupMultiple","map","propertyName","lookupString","suppress","values","split","results","v","r","join","originalAddClassMethod","addClass","originalRemoveClassMethod","removeClass","className","result","apply","arguments","trigger","eveScout","_EveScoutSignatureConnection","_this","links","active","options","chain","tabs","evescout","nodeNameSuffix","findLinks","systemID","ids","ti","eveScoutLink","eveScoutID","id","nodeDefaults","life","remaining_hours","mass","out_system_id","assign","parent","parentID","signatureID","in_signature","type","wh_exits_outward","wh_type","child","nextChildID","in_system_id","out_signature","refresh","ajax","url","dataType","done","data","status","xhr","_","isEqual","console","info","redraw","fail","error","warn","setInterval","setTimeout","findSystemID","systemName","appData","systems","viewingSystem","attr","viewingSystemID","server","app_name","version","window","stop","location","init","masks","tripwire","maskRendering","update","saveTimer","localOverrides","localOptions","JSON","parse","localStorage","getItem","userID","character","characterID","characterName","background","uiscale","favorites","grid","tracking","characterOptions","corporationID","gridlines","aura","lineWeight","scrollWithoutCtrl","node-reference","zoom","sigNameLocation","routingLimit","routeSecurity","routeIgnore","enabled","renderer","nodeSpacing","x","y","signatures","editType","copySeparator","pasteLife","alignment","sigID","sigType","sigAge","leadsTo","sigLife","sigMass","buttons","follow","chainWidget","viewing","signaturesWidget","autoMapper","saveDelay","delay","clearTimeout","save","stringify","get","setItem","mode","load","set","set_tracking_text","local","constructor","reset","defaults","hasOwnProperty","oog","data-col","col","data-row","row","data-sizex","size_x","data-sizey","size_y","css","width","height","favorite","parseInt","home","kspace","inArray","a","href","hostname","pathname","search","html","filter","$tab","clone","append","guidance","clearCache","gridster","widget_selector","avoid_overlapped_widgets","widget_base_dimensions","widget_margins","autogrow_cols","helper","draggable","start","e","ui","resize","handle_class","min_size","$widget","serialize_params","$w","wgd","disable","disable_resize","visibility","click","hasClass","serialize","enable","enable_resize","timer","client","wormholes","list","undo","sessionStorage","redo","serverSignatureCount","activity","esi","refreshRate","connected","ageFormat","instance","Date","getTime","sync","setAgeFormat","format","countdown","cookies","getCookie","c_name","c_value","document","cookie","c_start","c_end","unescape","substring","setCookie","exdays","exdate","setDate","getDate","escape","toUTCString","protocol","serverTime","time","chainMap","draw","pastEOL","since","layout","whTooltip","sig","item","tooltip","sig2Type","whType","Intl","NumberFormat","jump","ageTooltip","date","lifeTime","getMonth","getHours","getMinutes","createdByName","modifiedTime","modifiedByName","successCallback","alwaysCallback","getSystemIDsByNames","systemNames","on","preventDefault","system","systemChange","source","target","previousElementSibling","navigator","clipboard","writeText","innerText","ctrlKey","parseFloat","originalEvent","wheelDelta","fadeIn","timeout","keydown","activeElement","is","metaKey","keyCode","getSelection","toString","output","signature","wormhole","initialID","secondaryID","otherSignature","genericSystemTypes","lifeLength","lifeLeft","text","focus","select","Notify","splice","getElementById","style","display","innerHTML","f","systemInfo","systemAnalysis","analyse","systemRendering","renderSystem","toggle","EVE","show","hide","isInPanel","content","color","stick","jBox","offset","animation","autoClose","ValidationTooltips","fade","Tooltips","attach","getContent","position","outside","SystemActivityToolTips","appendTo","reposition","repositionOnOpen","createOnInit","onOpen","targetPos","tooltipWidth","closest","container","offsetHeight","WormholeRouteToolTips","WormholeTypeToolTips","adjustDistance","responsiveWidth","OccupiedToolTips","pointer","minWidth","repositionOnContent","offsetWidth","setContent","cache","occupants","chars","b","shipTypeName","formatSignatureID","linkSig","sigName","sortable","items","axis","tolerance","containment","newTabs","setActiveTab","stopPropagation","dialog","Remove Tab","remove","l","Cancel","resizable","minHeight","dialogClass","OK","submit","open","close","create","inlinecomplete","aSigSystems","maxSize","thera","checked","eq","contextmenu","delegate","menu","event","my","at","of","children","colName","cmd","beforeOpen","effect","duration","nodeElem","showInfo","setDestination","collapsed","collapse","existingTabIndex","newTab","wormholeID","class","characters","existingTab","moogle","prototype","setFlare","flare","flares","removeFlare","tablesorter","sortReset","widgets","textExtraction","2","node","toggleClass","shiftKey","nextUntil","addBack","add","autoOpen","Ok","easing","wormholeRendering","formatEndTypes","types","override","Array","isArray","overrideSystem","eligibleTypes","genericSystemType","systemTypeClass","systemTypeName","renderWormholeType","from","renderMass","trunc","widget","autocomplete","_create","_coerceSource","element","_selectInit","_super","_value","originalReturn","_superApply","change","_suggest","bind","_initSource","request","response","matcher","escapeRegex","term","dataSource","label","_renderItem","ul","renderResult","renderers","_close","input_source","addToSelect","select_added_value","select_source","unshift","removeFromSelect","wrapper","selectItemMapper","select_item_mapper","trim","toArray","_createShowAllButton","that","wasOpen","button","icons","primary","customDropdown","_search","wormholeType","mutators","classForTypeName","addMutator","m","leadsToPointer","nodeClass","nodeSecurity","nodeFaction","security","factionID","getDummySystem","baseSecurity","pathSymbol","systemTypeModifiers","forEach","mutate","effectClass","mutator_favourite","_FavouriteMutator","invasions","_Invasions","pathSymbolMap","stellar_reconnaissance","triglavian_minor_victory","escalating_liminality","final_liminality","edencom_minor_victory","redoubt","bulwark","fortress","textMap","keyBy","system_id","derived_security_status","updated_at","system_name","system_security","system_sovereignty","systemInvasion","tip","sorter","adjustCostForOptions","mapCost","toSystem","adjustJumpCost","to","cost","Guidance","jumpCostModifiers","reduce","modifier","findPaths","end","limit","endsInStart","costs","0","predecessors","addToOpen","vertex","bucket","shift","currentCost","adjacentNodes","vertexText","totalCost","vertexCost","extractShortest","nodes","u","predecessor","reverse","kSpaceCache","findShortestPath","cacheKey","cachedPath","connections","closed","renderPath","path","systemMarkup","slice","s","renderEffect","tag","ChainMapRendererBase","owner","ready","drawing","switchTo","newDiv","createElement","appendChild","switchFrom","div","parentNode","removeChild","mapData","updateCollapsed","drawInner","lines","arcFactor","level","maps","nodesById","ri","rows","inNode","c","mapNode","minArc","newMap","circles","arc","circle","connection","styles","concat","markup","mi","ci","ni","mapDiv","innerContainer","firstChild","range","initialRads","bounds","makeDivsForRing","radRange","min","max","domNode","finalPositions","w","h","cx","cy","centringOptions","parentWidth","parentHeight","rootNode","outerContainer","canvas","getElementsByTagName","ctx","getContext","scale","translate","maxCi","drawGridlines","lineWeightFactor","drawConnections","lineWidth","auraColor","propertyFromCssClass","shadowBlur","shadowColor","strokeStyle","ai","stroke","restore","setLineDash","dashed","drawFunction","beginPath","moveTo","drawConnection","minRad","maxRad","parentCollapsed","rads_per_arc","acc","rad_offset","getNodeRadialPosition","dr","rad_centre","alignment_delta","adjustAlignmentDelta","skipLevels","frag","createRange","createContextualFragment","dblclick","nodeRadialPosition","setPosition","excess","nextBounds","PI","lineTo","root_node","property","cssText","body","getComputedStyle","getPropertyValue","ChainMapRendererOrgchartSide","GRID_SIZE","project","rad","cp1","cp2","bezierCurveTo","fillStyle","font","fillText","ChainMapRendererOrgchartTop","endpoint_y","ChainMapRendererOrgchart","google","visualization","OrgChart","allowHtml","allowCollapse","size","events","addListener","collapseHandler","DataView","DataTable","cols","charts","setOnLoadCallback","newView","nodeId","nodeVal","updateLines","drawNodeLine","addModes","jquerySelector","prefixes","doModeClasses","removeModes","classFunc","prefix","$node","nodeIndex","ceil","cellIndex","$connector","$parent","nodeCol","connectorCell","colSpan","parentIndex","newparentIndex","checkSystem","$connecte","me","tempCol","breaker","skip","lastLineData","getCollapsedNodes","collapsedSystems","ChainMapRendererRadial","CIRCLE_SIZE","first_ring_delta","ringX","ringY","radToCartesian","sin","theta","cos","skipped","radPosition","ellipse","view","thirdPartySuppliers","orgChart","orgChartTop","orgChartSide","radial","useRenderer","elements","querySelectorAll","getAttribute","shipJumps","podKills","shipKills","npcKills","getElementsByClassName","jumps","setAttribute","pods","ships","npcs","attachedElements","detach","occupied","count","next","topLevel","tab","makeSystemNode","whId","inSigId","nodeTypeMarkup","additionalClasses","systemType","systemNameText","chainNode","statics","shortCodeMap","High-Sec","Low-Sec","Null-Sec","Triglavian","Class-1","Class-2","Class-3","Class-4","Class-5","Class-6","classMap","H","L","N","▼","formatStatics","makeCalcChildNode","childID","targetSystem","shortest","calcNode","calculated","nth","chainList","connectedTo","addCalcChildNodes","chainLinks","regionID","chainData","usedLinks","sig1","sig2","sig1Type","parentType","childType","floor","random","sigIndex","supplier","supplierNodes","supplierNode","thirdParty","systemsInChainMap","sigText","modifiers","connectionWormhole","wormholeAnalysis","wormholeFromTypePair","likelyWormhole","parentModifiers","chainModifiers","p","cm","parentPathHome","pathHome","exits","newIndex","rawMap","drawRetryTimer","systemPanel","expires","universeJumps","getResponseHeader","ship_jumps","then","universeKills","pod_kills","ship_kills","npc_kills","guidance_profiles","blueLootSystems","chainExits","renderRoute","targets","addPathHome","cssClass","categoryText","inChain","exitSystem","n","editSigs","editComments","editSig","editComment","animate","backgroundColor","fadeOut","makeSigInfo","wh","wormholeTypeText","formattedType","lifeText","critical","stable","addSig","option","disabled","returnLinkText","sigInfo","leadsToText","tr","until","moment","utc","toDate","onExpiry","alwaysExpire","compact","serverSync","wrapInner","slideDown","$set","replaceWith","contents","setReturnSig","sigToRemoveId","sigToUpdate","returnSig","sigToRemove","sigDialog","overwriteSignature","payload","API","indicator","APIrefresh","expire","periodsToSeconds","onTick","t","automapState","pendingDecision","wormholesForJump","toType","toClass","holeTargetTypeName","holeClasses","log","noMapSystems","stationID","shipTypeID","initial","secondary","automap","title","signature2","resultSet","formatSystem","empty","trElem","action","comments","modified","$comment","comment","err","message","sticky","commentID","before","created","deleteSig","slideUp","edit","locationTimer","shipTimer","onlineTimer","baseUrl","userAgent","oauth","subject","accessToken","isExpired","tokenExpire","subtract","isBefore","updateTracking","stationName","shipID","shipName","massOptions","expired","param","token","user_agent","jqXHR","locationDate","solar_system_id","station_id","stationLookup","always","reference","ship","shipDate","ship_item_id","resetMassOptions","ship_name","ship_type_id","typeLookup","online","characterStatus","typeID","destinationID","clear_waypoints","beginning","destination_id","clear_other_waypoints","add_to_beginning","headers","Authorization","X-User-Agent","targetID","target_id","eveStatus","idLookup","eveIDs","contentType","processData","characterLookup","eveID","async","corporationLookup","allianceLookup","searchString","categories","strict","fullLookup","promise","Deferred","category","characterData","corporation_id","corporationData","corporation","alliance_id","allianceData","alliance","resolve","parseOauth","_data","$clone","removeAttr","characterChange","updateSignatureTable","newSigsInSystem","mask","column","editing","sigEditing","currentSystem","signatureCount","updateReturnStatus","wormholeId","returnSigId","needReturn","pasteSignatures","processing","rowParse","scanner","columns","validScanGroups","validTypes","Combat Site","Data Site","Gas Site","Ore Site","Relic Site","Wormhole","Site de combat","Site de données","Site de collecte de gaz","Site de minerai","Site de reliques","Trou de ver","Kampfgebiet","Datengebiet","Gasgebiet","Mineraliengebiet","Reliktgebiet","Wurmloch","戦闘サイト","データサイト","ガスサイト","鉱石サイト","遺物サイト","ワームホール","전투 사이트","데이터 사이트","가스 사이트","채광 사이트","유물 사이트","웜홀","Боевой район","Информационный район","Газовый район","Астероидный район","Археологический район","Червоточина","scanGroup","parsePaste","paste","pasteIDs","removes","scan","clipboardData","getData","blur","lastIndex","redoItem","serverStatus","players","times","updateServerTime","maxTimeByProperty","maxTime","maxTimeString","signatureTime","flareCount","flareTime","last_modified","commentCount","commentTime","o","wormholeInitialIDs","wormholeSecondaryIDs","notify","discord_integration","history","replaceState","effects","bad","whClass","abs","securityText","HS","LS","NS","Trig","toFixed","fw","factionMarkup","fi","regions","tutorial","introJs","setOptions","showStepNumbers","steps","querySelector","intro","exitOnEsc","exitOnOverlayClick","skipLabel","onchange","_currentStep","previousMask","stepFunc","_options","setOption","exiting","exit","goToStep","off","onexit","undoItem","graph","span","role","calc","d","getValue","sourceColumn","setColumns","selectHandler","selections","AreaChart","isStacked","hAxis","textStyle","fontName","fontSize","showTextEvery","vAxis","viewWindowMode","viewWindow","maxValue","gridlineColor","pointSize","chartArea","legend","showColorCode","annotations","domain","focusTarget","CKConfig","skin","allowedContent","extraPlugins","enterMode","CKEDITOR","ENTER_BR","removeDialogTabs","autoGrow_onStartup","autoGrow_minHeight","toolbar_minToolbar","toolbar_maxToolbar","toolbar","smallToolbar","maximizedToolbar","fontSize_style","font-size","overrides","attributes","cke","editor","domEvent","altKey","selected_ranges","getRanges","startContainer","parents","getParents","getFirst","getNext","selectElement","selectRanges","ev","definition","getContents","commentSortHandler","sortOrder","sortElem","containerElem","nextSort","flexDirection","removeAllRanges","$this","instances","modifiedDate","createdDate","destroy","Delete","cssNumber","cssHooks","computed","extra","$e","clientWidth","clientHeight","transform","transformOrigin","bot","right","marginBottom","marginRight","_FactionWarfare","listeners","SamanuniAthounonGateOpen","occupier_faction_id","factions","contested","victory_points","victory_points_threshold","renderMask","global","corporate","ownerType","newActive","activeMask","joined","joinedBy","addEventListener","maskFunctions","updateActiveMask","higgs","charOptions","defaultCharacterOptions","showShip","textContent","dataset","characterid","wasActive","delete","esiDelete","objAndKey","targetSystemID","systemText","lookupText","findIndex","eligibleWormholeTypes","sourceDef","targetDef","coerce","def","matches","possibleSystems","exclusions","genericTypes","some","genericType","systemTypeMatch","entries","wt","notFrom","notLeadsTo","dummyWormholes","GATE","SML","dummy","MED","LRG","XLG","type1","type2","system1","system2","class1","class2","isHighClass","classes","isKSpace","inferKSpace","String","refreshTimer","$total","$ajax","refreshWindow","abort","$row","$col","modal","Close","$menuItem","sortList","parentElement","getMasks","iconBar","optional","admin","img","afterFunction","maskChange","Save","joinMask","maskID","completeFunction","Confirm","makeAccessListNode","extraAttributes","maskElem","send","Create","selectmenu","Add","total","getMassClass","jumpMass","parseMassData","totalMass","smallMass","mediumMass","largeMass","xlMass","shipData","originalMass","shipFlagsText","shipType","shipFlags","massClass","typeName","toID","fromSystem","massData","j","massMarkup","slider","Reset","stats","system_visits","account","logins","lastLogin","username","setUpSlider","step","slide","accordion","heightStyle","collapsible","direction","Send","fromSignature","openDeleteDialog","vm","successFunction","deleteDialogVM","signaturePayload","sigs","sigDialogVM","openSignatureDialog","sigId","aSigWormholes","K162","getTargetName","sigTypeDropdownFiller","extractor","eligible","durationPicker","not","form","valid","signatureID_Alpha","signatureID_Numeric","sigKey","existing","signatureType","wormholeName","signatureLength","signatureID2_Alpha","signatureID2_Numeric","wormholeName2","wormholeType2","wormholeLife","wormholeMass","signatureName","sigAlpha","delegateSave"],"mappings":"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","file":"app.min.js","sourcesContent":["Object.sort = function(obj, prop) {\r\n\tvar swapped, prev;\r\n\tdo {\r\n\t\tswapped = false, prev = null;\r\n\t\tfor (var i in obj) {\r\n\t\t\tif (prev && Number(obj[i][prop]) < Number(obj[prev][prop])) {\r\n\t\t\t\tvar tmp = obj[i];\r\n\t\t\t\tobj[i] = obj[prev];\r\n\t\t\t\tobj[prev] = tmp;\r\n\t\t\t\tswapped = true;\r\n\t\t\t}\r\n\t\t\tprev = i;\r\n\t\t}\r\n\t} while (swapped);\r\n}\r\n\r\nObject.index = function(obj, prop, val, cs) {\r\n\tfor (var key in obj) {\r\n\t\tif (!cs && obj[key][prop] == val) {\r\n\t\t\treturn key;\r\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\r\n\t\t\treturn key;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObject.find = function(obj, prop, val, cs) {\r\n\tfor (var key in obj) {\r\n\t\tif (!cs && obj[key][prop] == val) {\r\n\t\t\treturn obj[key];\r\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\r\n\t\t\treturn obj[key];\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\n(function($){\r\n    $.fn.serializeObject = function(){\r\n\r\n        var self = this,\r\n            json = {},\r\n            push_counters = {},\r\n            patterns = {\r\n                \"validate\": /^[a-zA-Z][a-zA-Z0-9_]*(?:\\[(?:\\d*|[a-zA-Z0-9_]+)\\])*$/,\r\n                \"key\":      /[a-zA-Z0-9_]+|(?=\\[\\])/g,\r\n                \"push\":     /^$/,\r\n                \"fixed\":    /^\\d+$/,\r\n                \"named\":    /^[a-zA-Z0-9_]+$/\r\n            };\r\n\r\n\r\n        this.build = function(base, key, value){\r\n            base[key] = value;\r\n            return base;\r\n        };\r\n\r\n        this.push_counter = function(key){\r\n            if(push_counters[key] === undefined){\r\n                push_counters[key] = 0;\r\n            }\r\n            return push_counters[key]++;\r\n        };\r\n\r\n        $.each($(this).serializeArray(), function(){\r\n\r\n            // skip invalid keys\r\n            if(!patterns.validate.test(this.name)){\r\n                return;\r\n            }\r\n\r\n            var k,\r\n                keys = this.name.match(patterns.key),\r\n                merge = this.value,\r\n                reverse_key = this.name;\r\n\r\n            while((k = keys.pop()) !== undefined){\r\n\r\n                // adjust reverse_key\r\n                reverse_key = reverse_key.replace(new RegExp(\"\\\\[\" + k + \"\\\\]$\"), '');\r\n\r\n                // push\r\n                if(k.match(patterns.push)){\r\n                    merge = self.build([], self.push_counter(reverse_key), merge);\r\n                }\r\n\r\n                // fixed\r\n                else if(k.match(patterns.fixed)){\r\n                    merge = self.build([], k, merge);\r\n                }\r\n\r\n                // named\r\n                else if(k.match(patterns.named)){\r\n                    merge = self.build({}, k, merge);\r\n                }\r\n            }\r\n\r\n            json = $.extend(true, json, merge);\r\n        });\r\n\r\n        return json;\r\n    };\r\n})(jQuery);\r\n\r\nvar letterToNumbers = function(string) {\r\n    string = string.toUpperCase();\r\n    var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', sum = 0, i;\r\n    for (i = 0; i < string.length; i++) {\r\n        sum += Math.pow(letters.length, i) * (letters.indexOf(string.substr(((i + 1) * -1), 1)) + 1);\r\n    }\r\n    return sum;\r\n};\r\n\r\n/** Find the relative position of one element within the hierarchy tree of another */\r\nfunction positionRelativeTo(elem, ancestor) {\r\n\tconst elemPos = elem.getBoundingClientRect(),\r\n\t\tancestorPos = ancestor.getBoundingClientRect();\r\n\treturn { \r\n\t\tleft: elemPos.left - ancestorPos.left + ancestor.scrollLeft,\r\n\t\ttop: elemPos.top - ancestorPos.top + ancestor.scrollTop\r\n\t};\r\n}\r\n\r\n/** Look up one or more values in a comma separated string as keys in a data map, and return a property from the results in a new comma separated string.\r\nConvenience function for UI mapping.\r\nWill throw a failure message, unless suppress=true in which case it will return undefined, if \r\nany of the lookups fail to resolve. */\r\nfunction lookupMultiple(map, propertyName, lookupString, suppress) {\r\n\tconst values = lookupString.split(',');\r\n\tconst results = [];\r\n\tfor(var i = 0; i < values.length; i++) {\r\n\t\tconst v = values[i];\r\n\t\tconst r = map[v];\r\n\t\tif(!r) { \r\n\t\t\tif(suppress) { return undefined;}\r\n\t\t\telse { throw 'Value ' + v + ' did not match anything in ' + map; }\r\n\t\t}\r\n\t\tresults.push(r[propertyName]);\r\n\t}\r\n\treturn results.join(',');\r\n}\r\n\r\n// Global CSS class change event\r\n(function($) {\r\n    var originalAddClassMethod = $.fn.addClass;\r\n\tvar originalRemoveClassMethod = $.fn.removeClass;\r\n\r\n    $.fn.addClass = function(className) {\r\n        // Execute the original method.\r\n        var result = originalAddClassMethod.apply(this, arguments);\r\n\r\n        // trigger a custom event\r\n        this.trigger('classchange', className);\r\n\r\n        // return the original result\r\n        return result;\r\n    }\r\n\r\n\t$.fn.removeClass = function(className) {\r\n        // Execute the original method.\r\n        var result = originalRemoveClassMethod.apply(this, arguments);\r\n\r\n        // trigger a custom event\r\n        this.trigger('classchange', className);\r\n\r\n        // return the original result\r\n        return result;\r\n    }\r\n})(jQuery);\r\n\r\n","const eveScout = new _EveScoutSignatureConnection();\r\n\r\nfunction _EveScoutSignatureConnection() {\r\n\tconst _this = this;\r\n\t\r\n\tthis.links = [];\r\n\t\r\n\tthis.active = function() {\r\n\t\treturn 'undefined' !== typeof options && options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout;\r\n\t}\r\n\t\r\n\tthis.nodeNameSuffix = 'eve-scout';\r\n\t\r\n\tthis.findLinks = function(systemID, ids) {\r\n\t\tif(!this.active()) { return []; }\r\n\t\t\r\n\t\tconst r = [];\r\n\t\tfor(var ti = 0; ti < this.links.length; ti++) {\r\n\t\t\tconst eveScoutLink = this.links[ti];\r\n\t\t\tconst eveScoutID = 'ES-' + eveScoutLink.id;\r\n\t\t\t\r\n\t\t\tconst nodeDefaults = {\r\n\t\t\t\tlife: eveScoutLink.remaining_hours >= 4 ? 'stable' : 'critical',\r\n\t\t\t\tmass: 'stable',\t// they no longer attempt to track mass\r\n\t\t\t\tid: eveScoutID,\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tif(eveScoutLink.out_system_id == systemID) {\t// Connection from this hole\r\n\t\t\t\tr.push(Object.assign({\r\n\t\t\t\t\t\r\n\t\t\t\t\tparent: {\r\n\t\t\t\t\t\tid: ids.parentID,\r\n\t\t\t\t\t\tsystemID: systemID,\r\n\t\t\t\t\t\tsignatureID: eveScoutLink.in_signature,\r\n\t\t\t\t\t\ttype: eveScoutLink.wh_exits_outward ? eveScoutLink.wh_type : 'K162'\r\n\t\t\t\t\t},\tchild: {\r\n\t\t\t\t\t\tid: ids.nextChildID++,\r\n\t\t\t\t\t\tsystemID: eveScoutLink.in_system_id,\r\n\t\t\t\t\t\tsignatureID: eveScoutLink.out_signature,\r\n\t\t\t\t\t\ttype: eveScoutLink.wh_exits_outward ? 'K162' : eveScoutLink.wh_type\r\n\t\t\t\t\t}\r\n\t\t\t\t}, nodeDefaults));\r\n\t\t\t} else if(eveScoutLink.in_system_id == systemID) { // Connection to this hole\r\n\t\t\t\tr.push(Object.assign({\r\n\t\t\t\t\tparent: {\r\n\t\t\t\t\t\tid: ids.parentID,\r\n\t\t\t\t\t\tsystemID: systemID,\r\n\t\t\t\t\t\tsignatureID: eveScoutLink.out_signature,\r\n\t\t\t\t\t\ttype: eveScoutLink.wh_exits_outward ? 'K162' : eveScoutLink.wh_type\r\n\t\t\t\t\t},\tchild: {\r\n\t\t\t\t\t\tid: ids.nextChildID++,\r\n\t\t\t\t\t\tsystemID: eveScoutLink.out_system_id,\r\n\t\t\t\t\t\tsignatureID: eveScoutLink.in_signature,\r\n\t\t\t\t\t\ttype: eveScoutLink.wh_exits_outward ? eveScoutLink.wh_type : 'K162'\r\n\t\t\t\t\t}\r\n\t\t\t\t}, nodeDefaults));\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn r;\r\n\t}\r\n\t\r\n\t/** Refresh the signature data from the public Eve-Scout API */\r\n\tthis.refresh = function() {\r\n\t\tif(!_this.active()) {\r\n\t\t\treturn;\t// only look for Thera data if on a tab with the option selected\r\n\t\t}\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t\turl: 'cached_third_party.php?key=eve-scout-signatures',\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"JSON\"\r\n\t\t}).done(function(data, status, xhr) {\t\r\n\t\t\tif(!_.isEqual(data, _this.links)) {\r\n\t\t\t\tconsole.info('Updating map for EvE Scout update');\r\n\t\t\t\t_this.links = data;\r\n\t\t\t\tchain.redraw();\r\n\t\t\t}\r\n\t\t}).fail(function(xhr, status, error) {\r\n\t\t\tconsole.warn('Failed to fetch signatures from eve-scout.com: ' + status, error);\r\n\t\t});\r\n\t};\r\n\t\r\n\tsetInterval(this.refresh, 60000);\r\n\tsetTimeout(this.refresh, 0);\r\n}","function findSystemID(systemName) {\r\n\tfor(let k in appData.systems) {\r\n\t\tif(appData.systems[k].name.toUpperCase() === systemName.toUpperCase()) return k; \r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nvar viewingSystem = $(\"meta[name=system]\").attr(\"content\");\r\nvar viewingSystemID = findSystemID(viewingSystem);\r\nvar server = $(\"meta[name=server]\").attr(\"content\");\r\nvar app_name = $(\"meta[name=app_name]\").attr(\"content\");\r\nvar version = $(\"meta[name=version]\").attr(\"content\");\r\n\r\n// Reload with default system if it was invalid\r\nif(!viewingSystemID) { window.stop(); window.location = '?system=Jita'; }\r\n\r\n// Use this to test performance of javascript code lines\r\n// var startTime = window.performance.now();\r\n// console.log(\"stint: \"+ (window.performance.now() - startTime));\r\n\r\nif(init.masks) {\r\n\tsetTimeout(() => {\r\n\t\ttripwire.masks = init.masks;\r\n\t\tmaskRendering.update(tripwire.masks);\r\n\t}, 0);\t// so maskRendering exists when it gets called\r\n}\r\n","var options = new function() {\r\n\tvar localOverrides = [\"grid\"];\r\n\tvar localOptions = JSON.parse(localStorage.getItem(\"tripwire_options\"));\r\n\tvar saveTimer;\r\n\r\n\tthis.userID = init.userID;\r\n\tthis.character = {id: init.characterID, name: init.characterName};\r\n\tthis.background = null;\r\n\tthis.uiscale = 1.0;\r\n\tthis.favorites = [];\r\n\tthis.grid = {};\r\n\tthis.tracking = {active: \"new\", characterOptions: {}};\r\n\tthis.masks = {active: init.corporationID + \".2\"};\r\n\tthis.chain = {gridlines: true, aura: true, lineWeight: 1.0, scrollWithoutCtrl: false, active: 0, tabs: [], \"node-reference\": \"type\", zoom: 1.0, sigNameLocation: 'name', routingLimit: 15, routeSecurity: 'shortest', routeIgnore: { enabled: false, systems: [ 'Tama', 'Rancer' ] }, renderer: 'radial', nodeSpacing: { x: 1.0, y: 1.0 } };\r\n\tthis.signatures = {editType: \"unknown\", copySeparator: \",\", pasteLife: 72, alignment: {sigID: \"centerAlign\", sigType: \"centerAlign\", sigAge: \"centerAlign\", leadsTo: \"centerAlign\", sigLife: \"centerAlign\", sigMass: \"centerAlign\"}};\r\n\tthis.buttons = {follow: false, chainWidget: {viewing: false, favorites: false}, signaturesWidget: {autoMapper: false}};\r\n\r\n\tthis.saveDelay = function(delay) {\r\n\t\tif (saveTimer) clearTimeout(saveTimer);\r\n\r\n\t\tsaveTimer = setTimeout(\"options.save()\", delay);\r\n\t};\r\n\r\n\t// Saves options in both cookie and database\r\n\tthis.save = function() {\r\n\t\tvar options = JSON.stringify(window.options.get());\r\n\r\n\t\tlocalStorage.setItem(\"tripwire_options\", options);\r\n\r\n\t\treturn $.ajax({\r\n\t\t\turl: \"options.php\",\r\n\t\t\tdata: {mode: \"set\", options: options},\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdataType: \"JSON\"\r\n\t\t});\r\n\t};\r\n\r\n\t// Loads options via passed object else cookie\r\n\tthis.load = function(data) {\r\n\t\tif (data && typeof(data) != \"undefined\") {\r\n\t\t\tthis.set(this, data);\r\n\t\t} else if (localOptions) {\r\n\t\t\tthis.set(this, localOptions);\r\n\t\t}\r\n\r\n\t\tthis.apply();\r\n\t\tif(tripwire) { set_tracking_text(); }\r\n\t};\r\n\r\n\t// Gets options from this by exluding types == function\r\n\tthis.get = function() {\r\n\t\tvar data = {};\r\n\r\n\t\tfor (var x in this) {\r\n\t\t\tif (typeof(this[x]) != \"function\") {\r\n\t\t\t\tdata[x] = this[x];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t};\r\n\r\n\t// Sets this from passed object\r\n\tthis.set = function(local, data) {\r\n\t\tfor (var prop in data) {\r\n\t\t\tif (data[prop] && data[prop].constructor && data[prop].constructor === Object) {\r\n\t\t\t\tif (local) {\r\n\t\t\t\t\tif(typeof(local[prop]) === 'undefined') { local[prop] = {}; }\r\n\t\t\t\t\tthis.set(local[prop], data[prop]);\r\n\t\t\t\t}\r\n\t\t\t} else if (local) {\r\n\t\t\t\tlocal[prop] = data[prop];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tthis.reset = function() {\r\n\t\tfor (var x in this) {\r\n\t\t\tif (typeof(this[x]) != \"function\") {\r\n\t\t\t\tthis[x] = JSON.parse(JSON.stringify(this.reset.defaults[x]));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Applies settings\r\n\tthis.apply = function() {\r\n\t\t// Local browser overrides\r\n\t\tif (localOptions) {\r\n            for (key in localOverrides) {\r\n                this[localOverrides[key]] = localOptions[localOverrides[key]];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Grid layout (detect old IGB setting options)\r\n\t\tif (this.grid.hasOwnProperty(\"oog\") && Object.keys(this.grid.oog||{}).length) {\r\n\t\t\t$.each(this.grid.oog, function() {\r\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\r\n\t\t\t\t\t.css({width: this.width, height: this.height});\r\n\t\t\t});\r\n\t\t} else if (Object.keys(this.grid||{}).length) {\r\n\t\t\t$.each(this.grid, function() {\r\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\r\n\t\t\t\t\t.css({width: this.width, height: this.height});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Make sure favorites are all ints and not strings\r\n\t\tthis.favorites = $.map(this.favorites, function(favorite) {\r\n\t\t\treturn parseInt(favorite);\r\n\t\t});\r\n\r\n\t\t// Buttons\r\n\t\tif (this.buttons.follow) $(\"#follow\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.home) $(\"#home\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.kspace) $(\"#k-space\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.viewing) $(\"#show-viewing\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.favorites) $(\"#show-favorite\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.evescout) $(\"#eve-scout\").addClass(\"active\");\r\n\t\tif ($.inArray(parseInt(viewingSystemID), this.favorites) !== -1) $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\");\r\n\t\tif (this.buttons.signaturesWidget.autoMapper) $(\"#toggle-automapper\").addClass(\"active\");\r\n\r\n\t\t// UI Scale\r\n\t\tif (this.uiscale) {\r\n\t\t\t$(\"body\").css(\"zoom\", this.uiscale);\r\n\t\t}\r\n\r\n\t\t// Chain zoom\r\n\t\tif (this.chain.zoom) {\r\n\t\t\t$(\"#chainParent\").css(\"zoom\", this.chain.zoom);\r\n\t\t}\r\n\r\n\t\t// Background\r\n\t\tif (this.background) {\r\n\t\t\tvar a = $('<a>', { href:this.background } )[0];\r\n\t\t\t$(\"#wrapper\").attr(\"style\", \"background-image: url(https://\" + a.hostname + a.pathname + a.search + \");\");\r\n\t\t} else {\r\n\t\t\t$(\"#wrapper\").attr(\"style\", \"\");\r\n\t\t}\r\n\r\n\t\t// Characters in Options\r\n\t\t$(\"#dialog-options #characters\").html(\"<img src='https://image.eveonline.com/Character/\"+init.characterID+\"_64.jpg' />\");\r\n\r\n\t\t// Active mask\r\n\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+this.masks.active+\"']\").attr(\"checked\", true);\r\n\r\n\t\t// Chain tabs\r\n\t\t$(\"#chainTabs\").html(\"\");\r\n\t\tfor (var x in this.chain.tabs) {\r\n\t\t\tif (this.chain.tabs[x]) {\r\n\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\r\n\r\n\t\t\t\t$tab.attr(\"id\", x).find(\".name\").data(\"tab\", this.chain.tabs[x].systemID).html(this.chain.tabs[x].name);\r\n\t\t\t\tif (x == this.chain.active) { $tab.addClass(\"current\"); }\r\n\r\n\t\t\t\t$(\"#chainTabs\").append($tab);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Reset routing cache in case routing options changed\r\n\t\tif(guidance) { guidance.clearCache(); }\r\n\r\n\t\t// Draw chain if Tripwire is initialized\r\n\t\tif (typeof(tripwire) !== \"undefined\") {\r\n\t\t\tchain.redraw();\r\n\t\t}\r\n\t};\r\n\r\n\tthis.reset.defaults = JSON.parse(JSON.stringify(this.get()));\r\n\tthis.load(init && init.options ? init.options : null);\r\n}\r\n","var grid = $(\".gridster ul\").gridster({\r\n\twidget_selector: \"li.gridWidget\",\r\n\tavoid_overlapped_widgets: false,\r\n\twidget_base_dimensions: [50, 50],\r\n\twidget_margins: [5, 5],\r\n\tautogrow_cols: true,\r\n\thelper: \"clone\",\r\n\tdraggable: {\r\n\t\tstart: function(e, ui) {\r\n\t\t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\r\n\t\t}\r\n\t},\r\n\tresize: {\r\n    \tenabled: true,\r\n    \thandle_class: \"grid-resize\",\r\n    \tmin_size: [4, 4],\r\n    \tstart: function(e) {\r\n    \t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\r\n    \t},\r\n    \tstop: function(e, ui, $widget) {\r\n    \t\t//var width = parseInt($(\".gridster\").css(\"margin-left\")) + this.container_width;\r\n    \t\t//$(\"#wrapper\").css({width: width + \"px\"})\r\n    \t\tswitch ($widget.attr(\"id\")) {\r\n    \t\t\tcase \"infoWidget\":\r\n    \t\t\t\tsetTimeout(\"activity.redraw();\", 300);\r\n    \t\t\t\tbreak;\r\n    \t\t}\r\n    \t}\r\n\t},\r\n\tserialize_params: function($w, wgd) {\r\n\t\treturn {\r\n\t\t\tid: $w.attr(\"id\"),\r\n\t\t\tcol: wgd.col,\r\n\t\t\trow: wgd.row,\r\n\t\t\tsize_x: wgd.size_x,\r\n\t\t\tsize_y: wgd.size_y,\r\n\t\t\twidth: $w.width(),\r\n\t\t\theight: $w.height()\r\n\t\t}\r\n\t}\r\n}).data(\"gridster\").disable();\r\n\r\ngrid.disable_resize();\r\n$(\".grid-resize\").addClass(\"hidden\").attr(\"data-icon\", \"resize\");\r\n\r\n$(\".gridster\").css({visibility: \"visible\"});\r\n$(\".gridster > *\").addClass(\"gridster-transition\");\r\n\r\n$(\"#layout\").click(function() {\r\n\tif (!$(this).hasClass(\"active\")) {\r\n\t\tgrid.enable();\r\n\t\tgrid.enable_resize();\r\n\t\t$(\".grid-resize\").removeClass(\"hidden\");\r\n\r\n\t\t$(this).addClass(\"active\");\r\n\t} else {\r\n\t\tgrid.disable();\r\n\t\tgrid.disable_resize();\r\n\t\t$(\".grid-resize\").addClass(\"hidden\");\r\n\r\n\t\t$(this).removeClass(\"active\");\r\n\r\n\t\toptions.grid = grid.serialize();\r\n\r\n\t\toptions.save();\r\n\t}\r\n});\r\n","var tripwire = new function() {\r\n    this.timer, this.xhr;\r\n\tthis.version = version;\r\n\tthis.client = {signatures: {}, wormholes: {}};\r\n\tthis.server = {signatures: {}, wormholes: {}};\r\n\tthis.signatures = {list: {}, undo: JSON.parse(sessionStorage.getItem(\"tripwire_undo\")) || {}, redo: JSON.parse(sessionStorage.getItem(\"tripwire_redo\")) || {}};\r\n\tthis.serverSignatureCount = 0;\r\n\tthis.activity = {};\r\n\tthis.data = {tracking: {}, esi: {}};\r\n\tthis.refreshRate = 5000;\r\n\tthis.connected = true;\r\n\tthis.ageFormat = \"HM\";\r\n\tthis.instance = window.name ? window.name : (new Date().getTime() / 1000, window.name = new Date().getTime() / 1000);\r\n\r\n\t// Reference to `this` that can be used inside of functions\r\n\tvar _this = this\r\n\r\n    // Command to start/stop tripwire updates\r\n\t// ToDo: Include API and Server timers\r\n\tthis.stop = function() {\r\n\t\tclearTimeout(this.timer);\r\n\t\treturn this.timer;\r\n\t};\r\n\r\n\tthis.start = function() {\r\n\t\treturn this.sync();\r\n\t}\r\n\r\n    // Command to change Age format\r\n\t// ToDo: Cookie change to keep\r\n\tthis.setAgeFormat = function(format) {\r\n\t\tvar format = typeof(format) !== 'undefined' ? format : this.ageFormat;\r\n\r\n\t\t$(\"span[data-age]\").each(function() {\r\n\t\t\t$(this).countdown(\"option\", {format: format});\r\n\t\t});\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tthis.cookies = {\r\n\t\tgetCookie: function(c_name) {\r\n\t\t\tvar c_value = document.cookie;\r\n\r\n\t\t\tvar c_start = c_value.indexOf(\" \" + c_name + \"=\");\r\n\t\t\tif (c_start == -1) {\r\n\t\t\t\tc_start = c_value.indexOf(c_name + \"=\");\r\n\t\t\t}\r\n\r\n\t\t\tif (c_start == -1) {\r\n\t\t\t\tc_value = null;\r\n\t\t\t} else {\r\n\t\t\t\tc_start = c_value.indexOf(\"=\", c_start) + 1;\r\n\t\t\t\tvar c_end = c_value.indexOf(\";\", c_start);\r\n\r\n\t\t\t\tif (c_end == -1) {\r\n\t\t\t\t\tc_end = c_value.length;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tc_value = unescape(c_value.substring(c_start, c_end));\r\n\t\t\t}\r\n\r\n\t\t\treturn c_value;\r\n\t\t},\r\n\r\n\t\tsetCookie: function(c_name, value, exdays) {\r\n\t\t\tvar exdate = new Date();\r\n\t\t\texdate.setDate(exdate.getDate() + exdays);\r\n\t\t\tvar c_value = escape(value) + ((exdays == null) ? \"\" : \"; expires=\"+exdate.toUTCString());\r\n\r\n\t\t\tdocument.cookie = c_name + \"=\" + c_value + \";\" + (document.location.protocol == \"https:\" ? \"secure;\" : \"\");\r\n\t\t}\r\n\t};\r\n\r\n    this.serverTime = function() {\r\n\t\tthis.time;\r\n\r\n\t\tthis.serverTime.getTime = function() {\r\n\t\t\treturn tripwire.serverTime.time;\r\n\t\t}\r\n\t}\r\n    this.serverTime();\r\n\r\n    // Handles putting chain together\r\n\tthis.chainMap = function() {\r\n\t\tthis.chainMap.parse = function(data) {\r\n\t\t\tchain.draw(data);\r\n\t\t}\r\n\t}\r\n    this.chainMap();\r\n\r\n    this.pastEOL = function() {\r\n\t\tvar options = {since: $(this).countdown('option', 'until'), format: \"HM\", layout: \"-{hnn}{sep}{mnn}&nbsp;\"};\r\n\t\t$(this).countdown(\"option\", options);\r\n\t}\r\n\r\n    // Handles WH Type hover-over tooltip\r\n\t// ToDo: Use native JS\r\n\tthis.whTooltip = function(sig) {\r\n\t\tif (viewingSystemID == sig.systemID) {\r\n\t\t\tif ($.inArray(sig.type, $.map(appData.wormholes, function(item, index) { return index;})) >= 0) {\r\n\t\t\t\tvar type = sig.type;\r\n\t\t\t\tvar tooltip = '';\r\n\t\t\t} else {\r\n\t\t\t\tvar type = sig.sig2Type;\r\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+(type || 'Unknown')+\"<br/>\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif ($.inArray(sig.sig2Type, $.map(appData.wormholes, function(item, index) { return index;})) >= 0) {\r\n\t\t\t\tvar type = sig.sig2Type;\r\n\t\t\t\tvar tooltip = '';\r\n\t\t\t} else {\r\n\t\t\t\tvar type = sig.type;\r\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+(type || 'Unknown')+\"<br/>\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ($.inArray(type, $.map(appData.wormholes, function(item, index) { return index;})) >= 0) {\r\n\t\t\tvar whType = true;\r\n\t\t} else {\r\n\t\t\tvar whType = false;\r\n\t\t}\r\n\r\n\t\ttooltip += \"<b>Life:</b> \"+(whType?appData.wormholes[type].life:\"Unknown\")+\"<br/>\";\r\n\r\n\t\tif (whType) {\r\n\t\t\tswitch (appData.wormholes[type].leadsTo.split(\"-\")[0]) {\r\n\t\t\t\tcase 'High':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='hisec'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Low':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='lowsec'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Null':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='nullsec'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Class':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='wh'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t}\r\n\r\n\t\t\ttooltip += \"<b>Max Mass</b>: \"+(Intl.NumberFormat().format(tripwire.wormholes[type].mass))+\" Kg<br/>\";\r\n\r\n\t\t\ttooltip += \"<b>Max Jumpable</b>: \"+(Intl.NumberFormat().format(tripwire.wormholes[type].jump))+\" Kg<br/>\";\r\n\t\t}\r\n\r\n\t\treturn tooltip;\r\n\t}\r\n\r\n\t// Handles Age hover-over tooltip\r\n\t// ToDo: Use native JS\r\n\tthis.ageTooltip = function(sig) {\r\n\t\t// var date = new Date(sig.lifeTime);\r\n\t\t// var localOffset = date.getTimezoneOffset() * 60000;\r\n\t\t// date = new Date(date.getTime() + localOffset);\r\n        var date = new Date(sig.lifeTime);\r\n\r\n\t\tvar tooltip = \"<table class=\\\"age-tooltip-table\\\"><tr>\"\r\n        + \"<th>Created:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\r\n        + \"<td>\"+sig.createdByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\r\n        + \"</tr>\";\r\n\r\n\t\tif (sig.lifeTime != sig.modifiedTime) {\r\n\t\t\tdate = new Date(sig.modifiedTime);\r\n\t\t\t// localOffset = date.getTimezoneOffset() * 60000;\r\n\t\t\t// date = new Date(date.getTime() + localOffset);\r\n      \r\n\t\t\ttooltip += \"<tr><th>Last Modified:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\r\n          + \"<td>\"+sig.modifiedByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\r\n          + \"</tr>\";\r\n\t\t}\r\n\r\n\t\ttooltip += \"</table>\";\r\n\r\n\t\treturn tooltip;\r\n\t}\r\n\r\n    this.refresh = function(mode, data, successCallback, alwaysCallback) {\r\n\t\tvar mode = mode || 'refresh';\r\n\r\n\t\tthis.sync(mode, data, successCallback, alwaysCallback);\r\n\t}\r\n\r\n\t// getSystemIDsByNames performs a case-insensitive search of the internal\r\n\t// list of systems looking for matches on each system name in the given\r\n\t// comma-separated list of names. A comma-separated list of system IDs is\r\n\t// returned if all systems are found, otherwise the empty string is returned.\r\n\tthis.getSystemIDsByNames = function(systemNames) {\r\n\t\tif (!_this.systems) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tconst values = systemNames.split(\",\");\r\n\t\tconst systems = [];\r\n\t\tfor(var i = 0; i < values.length; i++) {\r\n\t\t\tfor (systemID in _this.systems) {\r\n\t\t\t\tconst system = _this.systems[systemID];\r\n\t\t\t\tif (system.name.toLowerCase() == values[i].toLowerCase()) {\r\n\t\t\t\t\tsystems.push(systemID);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (values.length != systems.length) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\treturn systems.join(\",\");\r\n\t}\r\n}\r\n","$(\"body\").on(\"click\", \"a[href^='.?system=']\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tvar system = $(this).attr(\"href\").replace(\".?system=\", \"\");\r\n\tvar systemID = Object.index(tripwire.systems, \"name\", system);\r\n\r\n\ttripwire.systemChange(systemID);\r\n});\r\n\r\n$(\"body\").on(\"submit\", \"#systemSearch\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tvar system = $(this).find(\"[name='system']\").val();\r\n\tvar systemID = Object.index(tripwire.systems, \"name\", system, true) || false;\r\n\r\n\tif (systemID !== false) {\r\n\t\ttripwire.systemChange(systemID);\r\n\t\t$(this).find(\"[name='system']\").val(\"\");\r\n\t\t$(\"#search\").click();\r\n\t}\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#undo:not(.disabled)\", function() {\r\n\ttripwire.undo();\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#redo:not(.disabled)\", function() {\r\n\ttripwire.redo();\r\n});\r\n\r\n// Bind class=copy to copy the text of the previous element\r\n$(\".copy\").on('click', function(e) {\r\n\te.preventDefault();\r\n\tconst source = e.target.previousElementSibling;\r\n\tif(source) { navigator.clipboard.writeText(source.innerText); }\r\n\telse { console.warn('Copy event couldn\\'t find a source', e); }\r\n});\r\n\r\n// Chain map zooming (Gets funky if you push things too far)\r\n$(\"#chainParent\").on(\"wheel\", function(e) {\r\n\tif(!(options.chain.scrollWithoutCtrl || e.ctrlKey)) { return; }\r\n\te.preventDefault();\r\n\tvar zoom = parseFloat($(\"#chainParent\").css(\"zoom\")) || 1.0;\r\n\tvar min = 0.6;\r\n\tvar max = 2.0;\r\n\r\n    if (e.originalEvent.wheelDelta / 120 > 0 && zoom < max) {\r\n\t\t$(\"#chainParent\").css(\"zoom\", zoom + 0.1);\r\n    } else if (e.originalEvent.wheelDelta / 120 < 0 && zoom > min) {\r\n\t\t$(\"#chainParent\").css(\"zoom\", zoom - 0.1);\r\n    }\r\n\r\n\t// Show the reset zoom button for awhile\r\n\t$(\"#chain-zoom-reset\").fadeIn(200);\r\n\tif (this.timeout) clearTimeout(this.timeout);\r\n\tthis.timeout = setTimeout('$(\"#chain-zoom-reset\").fadeOut(200);', 3000);\r\n\r\n\t// Save options\r\n\toptions.chain.zoom = parseFloat($(\"#chainParent\").css(\"zoom\"));\r\n\toptions.saveDelay(2000);\r\n});\r\n\r\n$(\"#chain-zoom-reset\").on(\"click\", function() {\r\n\t$(\"#chainParent\").css(\"zoom\", 1);\r\n\toptions.chain.zoom = 1;\r\n\toptions.saveDelay(2000);\r\n});\r\n\r\n$(document).keydown(function(e)\t{\r\n\t//Abort - user is in input or textarea\r\n\tif ($(document.activeElement).is(\"textarea, input\")) return;\r\n\r\n\t// Ctrl key hooks\r\n\tif (e.metaKey || e.ctrlKey) {\r\n\r\n\t\tif (e.keyCode === 89 && !$(\"#redo\").hasClass(\"disabled\")) {\r\n\t\t\t// Ctrl-y redo hook\r\n\t\t\te.preventDefault();\r\n\t\t\t$(\"#redo\").click();\r\n\t\t\tNotify.trigger(\"Redoing last undo\");\r\n\t\t} else if (e.keyCode === 90 && !$(\"#undo\").hasClass(\"disabled\")) {\r\n\t\t\t// Ctrl-z undo hook\r\n\t\t\te.preventDefault();\r\n\t\t\t$(\"#undo\").click();\r\n\t\t\tNotify.trigger(\"Undoing last action\");\r\n\t\t} else if (e.keyCode === 65) {\r\n\t\t\t// Ctrl-a select all (signatures) hook\r\n\t\t\te.preventDefault();\r\n\t\t\t$(\"#sigTable tbody tr\").addClass(\"selected\");\r\n\t\t\t$(\"#signaturesWidget #delete-signature\").trigger(\"delete:refresh\");\r\n\t\t} else if (e.keyCode === 67) {\r\n\t\t\t// Ctrl-c copy selected signatures hook\r\n\t\t\tif (window.getSelection().toString() === \"\") {\r\n\t\t\t\tvar output = \"\";\r\n\t\t\t\t$(\"#sigTable tbody tr.selected\").each(function(row) {\r\n\t\t\t\t\tvar signature = tripwire.client.signatures[$(this).data(\"id\")];\r\n\t\t\t\t\tvar row = [];\r\n\r\n\t\t\t\t\tif (signature.signatureID) {\r\n\t\t\t\t\t\trow.push(signature.signatureID.substring(0, 3).toUpperCase() + \"-\" + (signature.signatureID.substring(3, 6) || \"###\"));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trow.push(\"null\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trow.push(signature.type);\r\n\t\t\t\t\tif (signature.type === \"wormhole\") {\r\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\t\t\t\t\tvar otherSignature = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\trow.push(wormhole.type || \"null\" );\r\n\t\t\t\t\t\trow.push(tripwire.systems[signature.systemID] ? tripwire.systems[signature.systemID].name : appData.genericSystemTypes[signature.systemID]);\r\n\t\t\t\t\t\trow.push(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : appData.genericSystemTypes[otherSignature.systemID]);\r\n\t\t\t\t\t\trow.push(wormhole.life);\r\n\t\t\t\t\t\trow.push(wormhole.mass);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trow.push(signature.name);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trow.push(signature.createdByName);\r\n\t\t\t\t\trow.push(signature.lifeTime);\r\n\t\t\t\t\trow.push(signature.lifeLength);\r\n\t\t\t\t\trow.push(signature.lifeLeft);\r\n\t\t\t\t\trow.push(signature.modifiedByName);\r\n\t\t\t\t\trow.push(signature.modifiedTime);\r\n\t\t\t\t\toutput += row.join(options.signatures.copySeparator) + \"\\r\\n\";\r\n\t\t\t\t});\r\n\t\t\t\t$(\"#clipboard\").text(output);\r\n\t\t\t\t$(\"#clipboard\").focus();\r\n\t\t\t\t$(\"#clipboard\").select();\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\t// delete key keyhooks\r\n\t\tif (e.keyCode == 46 && $(\"#sigTable tr.selected\").length > 0) {\r\n\t\t\t$(\"#delete-signature\").click();\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// $(\"#APIclock\").knob({angleArc: 359.9, height: 20, width: 20, max: 60, readOnly: true, displayInput: false, fgColor: \"#CCC\", bgColor: \"#666\"});\r\n\r\n$(\"#follow\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"active\"))\r\n\t\t$(this).removeClass(\"active\");\r\n\telse\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\toptions.buttons.follow = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n})\r\n\r\n$(\"#show-viewing\").click(function() {\r\n\tif ($(this).hasClass(\"active\"))\r\n\t\t$(this).removeClass(\"active\");\r\n\telse\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\tchain.redraw();\r\n\r\n\toptions.buttons.chainWidget.viewing = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n});\r\n\r\n$(\"#show-favorite\").click(function() {\r\n\tif ($(this).hasClass(\"active\"))\r\n\t\t$(this).removeClass(\"active\");\r\n\telse\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\tchain.redraw();\r\n\r\n\toptions.buttons.chainWidget.favorites = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n});\r\n\r\n$(\"#system-favorite\").click(function() {\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\").attr(\"data-icon\", \"star-empty\");\r\n\r\n\t\toptions.favorites.splice(options.favorites.indexOf(parseInt(viewingSystemID)), 1);\r\n\t} else {\r\n\t\t$(this).attr(\"data-icon\", \"star\").addClass(\"active\");\r\n\r\n\t\toptions.favorites.push(parseInt(viewingSystemID));\r\n\t}\r\n\r\n\tif ($(\"#show-favorite\").hasClass(\"active\"))\r\n\t\tchain.redraw();\r\n\r\n\toptions.save();\r\n});\r\n\r\n$('#favorite-dropdown-toggle').click(function() {\r\n\tconst target = document.getElementById('favorite-panel');\r\n\tif(target.style.display === 'none') {\r\n\t\tconst listWrapper = document.getElementById('favorite-panel-wrapper');\r\n\t\tlistWrapper.innerHTML = options.favorites.length == 0 ? '<p>You have no favourites. Use the star to add a system.</p>'\r\n\t\t\t: options.favorites.map(function(f) {\r\n\t\t\t\tconst systemInfo = systemAnalysis.analyse(f);\r\n\t\t\t\treturn '<p>' + systemRendering.renderSystem(systemInfo) + '</p>';\r\n\t\t\t}).join('\\n');\r\n\t\ttarget.style.display = '';\r\n\t} else { target.style.display = 'none'; }\r\n});\r\n\r\n$(\"#search\").click(function(e) {\r\n\t$(\"#searchSpan\").toggle();\r\n\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\t\tif (tripwire.client.EVE && tripwire.client.EVE.systemName)\r\n\t\t\t$(\"#currentSpan\").show();\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\t\t$(\"#currentSpan\").hide();\r\n\r\n\t\t$(\"#searchSpan input[name=system]\").focus().select();\r\n\t}\r\n});\r\n\r\n$(\"#toggle-automapper\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\t}\r\n\r\n\toptions.buttons.signaturesWidget.autoMapper = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n});\r\n\r\n$(\"#user\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\r\n\t\t$(\"#login > #panel\").css({display: \"none\"});\r\n\r\n\t\t//$(\"#wrapper\").unbind(\"click\");\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\t\t$(\"#login > #panel\").css({display: \"inline\"});\r\n\t\t$(\"#loginForm input[name=username]\").focus().select();\r\n\t}\r\n});\r\n$(\"#wrapper\").click(function(e) { // Click outside closes\r\n\tif(!(e.originalEvent && e.originalEvent.isInPanel)) {\r\n\t\t$(\"#login > #panel\").css({display: \"none\"});\r\n\t\t$(\"#user\").removeClass(\"active\");\r\n\t}\r\n});\r\n$(\"#login\").click(function(e) { // click inside doesn't\r\n\te.originalEvent.isInPanel = true;\r\n})\r\n\r\n\r\n$(\"#logout\").click(function() {\r\n\twindow.location = \"logout.php\";\r\n});\r\n\r\nvar Notify = new function() {\r\n\tthis.trigger = function(content, color, stick, id) {\r\n\t\tvar color = typeof(color) !== \"undefined\" ? color : \"blue\";\r\n\t\tvar stick = typeof(stick) !== \"undefined\" ? stick : 10000;\r\n\t\tvar id = typeof(id) !== \"undefined\" ? id : null;\r\n\r\n\t\tnew jBox(\"Notice\", {\r\n\t\t\tid: id,\r\n\t\t\tcontent: content,\r\n\t\t\toffset: {y: 35},\r\n\t\t\tanimation: \"flip\",\r\n\t\t\tcolor: color,\r\n\t\t\tautoClose: stick\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// Init valdiation tooltips\r\nvar ValidationTooltips = new jBox(\"Tooltip\", {\r\n\ttrigger: null,\r\n\taddClass: \"validation-tooltip\",\r\n\tanimation: \"flip\",\r\n\tfade: 0\r\n});\r\n\r\nvar Tooltips = new jBox(\"Tooltip\", {\r\n\tattach: $(\"[data-tooltip]\"),\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {x: \"right\", y: \"center\"},\r\n\toutside: \"x\"\r\n});\r\n\r\nvar SystemActivityToolTips = new jBox(\"Tooltip\", {\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {y: \"bottom\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\t\tvar nodePos = this.source.closest(\"[data-nodeid]\").position();\r\n\t\tvar parentPos = this.source.closest(\".nodeActivity\").position();\r\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\r\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\r\n\t\tvar tooltipWidth = this.container.parent().width();\r\n\t\t// var tooltipHeight = this.container.parent().height();\r\n\r\n\t\tthis.options.position = {x: targetPos.left + 3 - tooltipWidth /2 , y: targetPos.top + this.target[0].offsetHeight};\r\n\t}\r\n});\r\n\r\nvar WormholeRouteToolTips = new jBox(\"Tooltip\", {\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {y: \"bottom\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\r\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\r\n\t\tvar tooltipWidth = this.container.parent().width();\r\n\t\t// var tooltipHeight = this.container.parent().height();\r\n\t\t\r\n\t\tthis.options.position = {x: targetPos.left + 3 - tooltipWidth /2 , y: targetPos.top + this.target[0].offsetHeight};\r\n\t}\r\n});\r\n\r\nvar WormholeTypeToolTips = new jBox(\"Tooltip\", {\r\n\tattach: $(\"#chainMap .whEffect[data-icon]\"),\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {x: \"left\", y: \"center\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\toutside: \"x\",\r\n\tadjustDistance: 100,\r\n\tresponsiveWidth: false,\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\t\tvar tooltipWidth = this.container.parent().width();\r\n\r\n\t\tthis.options.position = {x: targetPos.left - tooltipWidth - 10, y: targetPos.top - 3};\r\n\t}\r\n});\r\n\r\nvar OccupiedToolTips = new jBox(\"Tooltip\", {\r\n\tpointer: \"top:-3\",\r\n\tposition: {x: \"right\", y: \"center\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\toutside: \"x\",\r\n\tminWidth: 100,\r\n\tanimation: \"move\",\r\n\tadjustDistance: 100,\r\n\tresponsiveWidth: false,\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\trepositionOnContent: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar tooltip = this;\r\n\t\tconst nodeElemJ = this.source.closest(\"[data-nodeid]\");\r\n\t\tvar systemID = nodeElemJ.data(\"nodeid\");\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\r\n\t\tthis.options.position = {x: targetPos.left + this.target[0].offsetWidth, y: targetPos.top - 3};\r\n\r\n\t\ttooltip.setContent(\"&nbsp;\");\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: \"occupants.php\",\r\n\t\t\tdataType: \"JSON\",\r\n\t\t\tdata: \"systemID=\"+systemID,\r\n\t\t\tcache: false\r\n\t\t}).done(function(data) {\r\n\t\t\tif (data && data.occupants) {\r\n\t\t\t\tvar chars = \"<table>\";\r\n\r\n\t\t\t\t// Sort by characterName\r\n\t\t\t\tdata.occupants.sort(function(a, b) {\r\n\t\t\t\t\tif (a.characterName.toLowerCase() < b.characterName.toLowerCase()) return -1;\r\n\t\t\t\t\tif (a.characterName.toLowerCase() > b.characterName.toLowerCase()) return 1;\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfor (var x in data.occupants) {\r\n\t\t\t\t\tchars += \"<tr><td>\"+data.occupants[x].characterName+\"</td><td style='padding-left: 10px;'>\"+(data.occupants[x].shipTypeName?data.occupants[x].shipTypeName:\"\")+\"</td></tr>\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tchars += \"</table>\";\r\n\t\t\t\ttooltip.setContent(chars);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\n\r\n$(\"#chainTabs\").sortable({\r\n\titems: \"> .tab\",\r\n\taxis: \"x\",\r\n\tdelay: 150,\r\n\ttolerance: \"pointer\",\r\n\tcontainment: \"parent\",\r\n\tupdate: function(e, ui) {\r\n\t\tvar result = $(\"#chainTabs\").sortable(\"toArray\");\r\n\t\tvar newTabs = [];\r\n\r\n\t\tfor (var x in result) {\r\n\t\t\tnewTabs.push(options.chain.tabs[result[x]]);\r\n\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\r\n\t\t}\r\n\r\n\t\toptions.chain.active = $(\".tab.current\").index();\r\n\t\toptions.chain.tabs = newTabs;\r\n\t\toptions.save();\r\n\t}\r\n});\r\n\r\n$(\"#chainTabs\").on(\"click\", \".tab\", function(e) {\r\n\te.preventDefault();\r\n\tchain.setActiveTab($(this).hasClass(\"current\") ? null : $(this).index())\r\n});\r\n\r\n$(\"#chainTabs\").on(\"click\", \".closeTab\", function(e) {\r\n\te.stopPropagation();\r\n\tvar $tab = $(this).closest(\".tab\");\r\n\r\n\t$(\"#dialog-confirm #msg\").html(\"This tab will be removed, are you sure?\");\r\n\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\tbuttons: {\r\n\t\t\t\"Remove Tab\": function() {\r\n\t\t\t\tvar i = $tab.index();\r\n\r\n\t\t\t\toptions.chain.active = $(\".tab.current\").index();\r\n\t\t\t\toptions.chain.tabs.splice(i, 1);\r\n\t\t\t\toptions.save();\r\n\r\n\t\t\t\t$tab.remove();\r\n\t\t\t\tif ($(\"#chainTabs .tab.current\").length == 0) {\r\n\t\t\t\t\t$(\"#chainTabs .tab:last\").click();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var x = 0, l = $(\"#chainTabs .tab\").length; x < l; x++) {\r\n\t\t\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t},\r\n\t\t\tCancel: function() {\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t}\r\n\t\t}\r\n\t}).dialog(\"open\");\r\n});\r\n\r\n$(\"#newTab\").on(\"click\", function() {\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-newTab\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-newTab\").dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tOK: function() {\r\n\t\t\t\t\t$(\"#newTab_form\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-newTab .name\").val(viewingSystem).focus();\r\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").val(viewingSystem);\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0, renderer: 'system'});\r\n\r\n\t\t\t\t$(\"#newTab_form\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\r\n\t\t\t\t\tvar name = $(\"#dialog-newTab .name\").val();\r\n\t\t\t\t\tvar systemID = tripwire.getSystemIDsByNames($(\"#dialog-newTab .sigSystemsAutocomplete\").val());\r\n\t\t\t\t\tvar thera = $(\"#tabThera\")[0].checked ? true : false;\r\n\r\n\t\t\t\t\tif (!name) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .name\")}).setContent(\"Must have a name!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if (!systemID && $(\"#tabType1\")[0].checked) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .sigSystemsAutocomplete\")}).setContent(\"Must have valid systems (comma separated if multiple)!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if ($(\"#tabType2\")[0].checked) {\r\n\t\t\t\t\t\tsystemID = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\r\n\t\t\t\t\toptions.chain.tabs.push({systemID: systemID, name: name, evescout: thera});\r\n\t\t\t\t\toptions.save();\r\n\r\n\t\t\t\t\t$(\"#chainTabs\").append($tab);\r\n\r\n\t\t\t\t\t$(\"#dialog-newTab\").dialog(\"close\");\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").click(function(e) {\r\n\t\t\t\t\t$(\"#dialog-newTab #tabType1\").click();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-newTab\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-newTab\").dialog(\"open\");\r\n\t}\r\n});\r\n\r\n$(\"#chainTabs\").on(\"click\", \".editTab\", function(e) {\r\n\te.stopPropagation();\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-editTab\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-editTab\").dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tOK: function() {\r\n\t\t\t\t\t$(\"#editTab_form\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-editTab .name\").val(options.chain.tabs[options.chain.active].name).focus();\r\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").val(options.chain.tabs[options.chain.active].systemID != 0 ? lookupMultiple(tripwire.systems, 'name', options.chain.tabs[options.chain.active].systemID) : \"\");\r\n\t\t\t\toptions.chain.tabs[options.chain.active].systemID != 0 ? $(\"#dialog-editTab #editTabType1\")[0].checked = true : $(\"#dialog-editTab #editTabType2\")[0].checked = true;\r\n\t\t\t\t$(\"#dialog-editTab #editTabThera\")[0].checked = options.chain.tabs[options.chain.active].evescout;\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, renderer: 'system', maxSize: 10, delay: 0});\r\n\r\n\t\t\t\t$(\"#editTab_form\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar $tab = $(\"#chainTabs .tab\").eq([options.chain.active]);\r\n\t\t\t\t\tvar name = $(\"#dialog-editTab .name\").val();\r\n\t\t\t\t\tvar systemID = tripwire.getSystemIDsByNames($(\"#dialog-editTab .sigSystemsAutocomplete\").val());\r\n\t\t\t\t\tvar thera = $(\"#editTabThera\")[0].checked ? true : false;\r\n\r\n\t\t\t\t\tif (!name) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .name\")}).setContent(\"Must have a name!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if (!systemID && $(\"#editTabType1\")[0].checked) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .sigSystemsAutocomplete\")}).setContent(\"Must have valid systems (comma separated if multiple)!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if ($(\"#editTabType2\")[0].checked) {\r\n\t\t\t\t\t\tsystemID = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\r\n\t\t\t\t\toptions.chain.tabs[options.chain.active] = {systemID: systemID, name: name, evescout: thera};\r\n\t\t\t\t\toptions.save();\r\n\t\t\t\t\tchain.redraw();\r\n\r\n\t\t\t\t\ttripwire.parse(tripwire.client, \"refresh\");\r\n\r\n\t\t\t\t\t//$(\"#chainTabs\").append($tab);\r\n\r\n\t\t\t\t\t$(\"#dialog-editTab\").dialog(\"close\");\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").click(function(e) {\r\n\t\t\t\t\t$(\"#dialog-editTab #editTabType1\").click();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-editTab\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-editTab\").dialog(\"open\");\r\n\t}\r\n});\r\n\r\n// Signature column context menu\r\n$(\"#signaturesWidget #sigTable thead\").contextmenu({\r\n\tdelegate: \"th.sortable\",\r\n\tmenu: \"#signatureColumnMenu\",\r\n\tposition: function(event, ui) {\r\n        return {my: \"left top\", at: \"center\", of: ui.target};\r\n    },\r\n\tselect: function(e, ui) {\r\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\r\n\r\n\t\tswitch(col) {\r\n\t\t\tcase 1:\r\n\t\t\t\tcolName = \"sigID\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tcolName = \"sigType\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tcolName = \"sigAge\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tcolName = \"leadsTo\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tcolName = \"sigLife\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tcolName = \"sigMass\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tswitch(ui.cmd) {\r\n\t\t\tcase \"leftAlign\":\r\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign rightAlign\").addClass(\"leftAlign\");\r\n\t\t\t\toptions.signatures.alignment[colName] = \"leftAlign\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"centerAlign\":\r\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"leftAlign rightAlign\").addClass(\"centerAlign\");\r\n\t\t\t\toptions.signatures.alignment[colName] = \"centerAlign\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"rightAlign\":\r\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign leftAlign\").addClass(\"rightAlign\");\r\n\t\t\t\toptions.signatures.alignment[colName] = \"rightAlign\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\toptions.save();\r\n\t},\r\n\tbeforeOpen: function(e, ui) {\r\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\r\n\r\n\t\tswitch(col) {\r\n\t\t\tcase 1:\r\n\t\t\t\tcolName = \"sigID\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tcolName = \"sigType\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tcolName = \"sigAge\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tcolName = \"leadsTo\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tcolName = \"sigLife\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tcolName = \"sigMass\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t$(this).contextmenu(\"enableEntry\", \"leftAlign\", true);\r\n\t\t$(this).contextmenu(\"enableEntry\", \"centerAlign\", true);\r\n\t\t$(this).contextmenu(\"enableEntry\", \"rightAlign\", true);\r\n\r\n\t\t$(this).contextmenu(\"enableEntry\", options.signatures.alignment[colName], false);\r\n\t}\r\n});\r\n\r\n// Chain Map Context Menu\r\n$(\"#chainParent\").contextmenu({\r\n\tappendTo: \"#chainParent\",\r\n\tdelegate: \".nodeSystem a\",\r\n\tposition: function(event, ui) {\r\n        return {my: \"left top-1\", at: \"right top\", of: ui.target};\r\n    },\r\n\tmenu: \"#chainMenu\",\r\n\tshow: {effect: \"slideDown\", duration: 150},\r\n\tselect: function(e, ui) {\r\n\t\tconst nodeElem = $(ui.target[0]).closest(\"[data-nodeid]\");\r\n\t\tvar id = nodeElem.data(\"nodeid\");\r\n\t\tvar row = nodeElem.attr(\"id\").replace(\"node\", \"\") -1;\r\n\r\n\t\tswitch(ui.cmd) {\r\n\t\t\tcase \"showInfo\":\r\n\t\t\t\ttripwire.esi.showInfo(id, options.tracking.active);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"setDest\":\r\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, true);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"addWay\":\r\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, false);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"showMap\":\r\n\t\t\t\t// CCPEVE.showMap(id);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"red\":\r\n\t\t\t\tnodeElem.hasClass(\"redNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"yellow\":\r\n\t\t\t\tnodeElem.hasClass(\"yellowNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"green\":\r\n\t\t\t\tnodeElem.hasClass(\"greenNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"mass\":\r\n\t\t\t\t$(\"#dialog-mass\").data(\"id\", nodeElem.data(\"sigid\")).data(\"systemID\", id).dialog(\"open\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ping\":\r\n\t\t\t\t$(\"#dialog-ping\").data(\"id\", nodeElem.data(\"sigid\") || null).data(\"systemID\", id).dialog(\"open\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"collapse\":\r\n\t\t\t\tvar toggle = options.chain.tabs[options.chain.active] ? ($.inArray(id, options.chain.tabs[options.chain.active].collapsed) == -1 ? true : false) : true;\r\n\t\t\t\tchain.renderer.collapse(id, toggle);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"makeTab\":\r\n\t\t\t\tconst existingTabIndex = Object.index(options.chain.tabs, 'systemID', '' + id, false);\r\n\t\t\t\tif(undefined !== existingTabIndex) {\r\n\t\t\t\t\tchain.setActiveTab(existingTabIndex);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst systemName = tripwire.systems[id].name;\r\n\t\t\t\t\toptions.chain.tabs.push({systemID: '' + id, name: systemName});\r\n\t\t\t\t\tvar newTab = $(\"#chainTab .tab\").clone();\r\n\t\t\t\t\tnewTab.attr('id', options.chain.tabs.length - 1).find(\".name\").data(\"tab\", id).html(systemName);\r\n\t\t\t\t\t$(\"#chainTabs\").append(newTab);\r\n\t\t\t\t\tchain.setActiveTab(options.chain.tabs.length - 1);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\tbeforeOpen: function(e, ui) {\r\n\t\tvar wormholeID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"sigid\") || null;\r\n\t\tvar systemID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"nodeid\");\r\n\r\n\t\t// Add check for k-space\r\n\t\tif (tripwire.systems[systemID].class || !tripwire.esi.characters[options.tracking.active]) {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", false);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", false);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\r\n\t\t} else {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", true);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", true);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\r\n\t\t}\r\n\t\t\r\n\t\t// Add check for in-sig\r\n\t\tif (wormholeID) {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", true);\r\n\t\t} else {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", false);\r\n\t\t}\r\n\t\t\r\n\t\t// Add check for tab validity\r\n\t\tconst existingTab = Object.find(options.chain.tabs, 'systemID', '' + systemID, false);\r\n\t\t$('#makeTabMenuItem').text(existingTab ? 'View Tab' : 'Make Tab' );\r\n\t},\r\n\tcreate: function(e, ui) {\r\n\t\t// Fix some bad CSS from jQuery Position\r\n\t\t$(this).find(\".ui-front\").css(\"width\", \"10em\");\r\n\t\t$(this).find(\".ui-front\").css(\"position\", \"\");\r\n\r\n\t\t$.moogle.contextmenu.prototype.setFlare = function(systemID, flare, ui) {\r\n\t\t\tvar data = {\"systemID\": systemID, \"flare\": flare};\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"flares.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: data,\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.result) {\r\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\").addClass(flare+\"Node\");\r\n\r\n\t\t\t\t\tchain.data.flares.flares.push({systemID: systemID, flare: flare, time: null});\r\n\t\t\t\t\tchain.flares(chain.data.flares);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$.moogle.contextmenu.prototype.removeFlare = function(systemID, ui) {\r\n\t\t\tvar data = {\"systemID\": systemID};\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"flares.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: data,\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.result) {\r\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\");\r\n\r\n\t\t\t\t\tchain.data.flares.flares.splice(Object.index(chain.data.flares.flares, \"systemID\", systemID), 1);\r\n\t\t\t\t\tchain.flares(chain.data.flares);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/** Format a signature ID like abc123 as ABC-123 for user display */\r\nfunction formatSignatureID(signatureID) {\r\n\treturn (!signatureID) ? '???-###' :\r\n\t\t(signatureID.length >= 3 ? signatureID.substring(0, 3).toUpperCase() : '') + \"-\" + (signatureID.length == 6 ? signatureID.substring(3, 6) : \"###\");\r\n}\r\n\r\n// Used to generate eve-survival guide link\r\nfunction linkSig(sigName) {\r\n\tvar wormholeSignatures = [\r\n\t\t// Ore sites\r\n\t\t\"Average Frontier Deposit\",\r\n\t\t\"Unexceptional Frontier Deposit\",\r\n\t\t\"Common Perimeter Deposit\",\r\n\t\t\"Exceptional Core Deposit\",\r\n\t\t\"Infrequent Core Deposit\",\r\n\t\t\"Unusual Core Deposit\",\r\n\t\t\"Rarified Core Deposit\",\r\n\t\t\"Isolated Core Deposit\",\r\n\t\t\"Ordinary Permiter Deposit\",\r\n\t\t\"Uncommon Core Deposit\",\r\n\r\n\t\t// Gas Sites\r\n\t\t\"Barren Perimeter Reservoir\",\r\n\t\t\"Minor Perimeter Reservoir\",\r\n\t\t\"Ordinary Perimeter Reservoir\",\r\n\t\t\"Sizeable Perimeter Reservoir\",\r\n\t\t\"Token Perimeter Reservoir\",\r\n\t\t\"Bountiful Frontier Reservoir\",\r\n\t\t\"Vast Frontier Reservoir\",\r\n\t\t\"Instrumental Core Reservoir\",\r\n\t\t\"Vital Core Reservoir\",\r\n\r\n\t\t// Class 1\r\n\t\t\"Perimeter Ambush Point\",\r\n\t\t\"Perimeter Camp\",\r\n\t\t\"Phase Catalyst Node\",\r\n\t\t\"The Line\",\r\n\t\t\"Forgotten Perimeter Coronation Platform\",\r\n\t\t\"Forgotten Perimeter Power Array\",\r\n\t\t\"Unsecured Perimeter Amplifier\",\r\n\t\t\"Unsecured Perimeter Information Center\",\r\n\r\n\t\t// Class 2\r\n\t\t\"Perimeter Checkpoint\",\r\n\t\t\"Perimeter Hangar\",\r\n\t\t\"The Ruins of Enclave Cohort 27\",\r\n\t\t\"Sleeper Data Sanctuary\",\r\n\t\t\"Forgotten Perimeter Gateway\",\r\n\t\t\"Forgotten Perimeter Habitation Coils\",\r\n\t\t\"Unsecured Perimeter Comms Relay\",\r\n\t\t\"Unsecured Perimeter Transponder Farm\",\r\n\r\n\t\t// Class 3\r\n\t\t\"Fortification Frontier Stronghold\",\r\n\t\t\"Outpost Frontier Stronghold\",\r\n\t\t\"Solar Cell\",\r\n\t\t\"The Oruze Construct\",\r\n\t\t\"Forgotten Frontier Quarantine Outpost\",\r\n\t\t\"Forgotten Frontier Recursive Depot\",\r\n\t\t\"Unsecured Frontier Database\",\r\n\t\t\"Unsecured Frontier Receiver\",\r\n\r\n\t\t// Class 4\r\n\t\t\"Frontier Barracks\",\r\n\t\t\"Frontier Command Post\",\r\n\t\t\"Integrated Terminus\",\r\n\t\t\"Sleeper Information Sanctum\",\r\n\t\t\"Forgotten Frontier Conversion Module\",\r\n\t\t\"Forgotten Frontier Evacuation Center\",\r\n\t\t\"Unsecured Frontier Digital Nexus\",\r\n\t\t\"Unsecured Frontier Trinary Hub\",\r\n\r\n\t\t// Class 5\r\n\t\t\"Core Garrison\",\r\n\t\t\"Core Stronghold\",\r\n\t\t\"Oruze Osobnyk\",\r\n\t\t\"Quarantine Area\",\r\n\t\t\"Forgotten Core Data Field\",\r\n\t\t\"Forgotten Core Information Pen\",\r\n\t\t\"Unsecured Frontier Enclave Relay\",\r\n\t\t\"Unsecured Frontier Server Bank\",\r\n\r\n\t\t// Class 6\r\n\t\t\"Core Citadel\",\r\n\t\t\"Core Bastion\",\r\n\t\t\"Strange Energy Readings\",\r\n\t\t\"The Mirror\",\r\n\t\t\"Forgotten Core Assembly Hall\",\r\n\t\t\"Forgotten Core Circuitry Disassembler\",\r\n\t\t\"Unsecured Core Backup Array\",\r\n\t\t\"Unsecured Core Emergence\"\r\n\t];\r\n\r\n\tif (wormholeSignatures.indexOf(sigName) > -1) {\r\n\t\treturn '<a href=\"https://eve-survival.org/wikka.php?wakka='+sigName.replace(/ /g, '')+'\" target=\"_blank\" class=\"siteLink\">'+sigName+'</a>';\r\n\t}\r\n\r\n\treturn sigName;\r\n}\r\n\r\n// Initialize tablesorter plugin on signaturesWidget table\r\n$(\"#sigTable\").tablesorter({\r\n\tsortReset: true,\r\n\twidgets: ['saveSort'],\r\n\ttextExtraction: {\r\n\t\t2: function(node) { return $(node).find(\"span\").data(\"age\"); }\r\n\t}\r\n});\r\n\r\n// Highlight signaturesWidget tr on click\r\n$(\"#sigTable tbody\").on(\"click\", \"tr\", function(e) {\r\n\tif (e.metaKey || e.ctrlKey) {\r\n\t\t// ctrl or cmd key\r\n\t\t$(this).toggleClass(\"selected\");\r\n\t} else if (e.shiftKey) {\r\n\t\t// shift key\r\n\t\t$(this).addClass(\"selected\");\r\n\t\t$(\"#sigTable tbody tr.selected:first\").nextUntil(\"#sigTable tbody tr.selected:last\").addBack().add(\"#sigTable tbody tr.selected:last\").addClass(\"selected\");\r\n\t} else {\r\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\r\n\t\t$(this).addClass(\"selected\");\r\n\t}\r\n});\r\n\r\n// Un-Highlight signaturesWidget tr on clicking outside\r\n$(document).click(function(e) {\r\n    if(!$(e.target).closest('#sigTable tbody').length && !$(e.target).closest('#edit-signature').length && !$(e.target).closest('#delete-signature').length) {\r\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\r\n    }\r\n});\r\n\r\n// Monitor custom 'classchange' event\r\n$(\"#sigTable tbody\").on(\"classchange\", \"tr\", function(e, className) {\r\n\t// Trigger signaturesWidget selected row change custom event\r\n\tif (className === \"selected\") {\r\n\t\t$(\"#signaturesWidget\").trigger(\"selected:change\");\r\n\t}\r\n});\r\n\r\n// Update signaturesWidget based on .selected rows change\r\n$(\"#signaturesWidget\").on(\"selected:change\", function() {\r\n\t// Enable/Disable delete icon\r\n\tif ($(\"#sigTable tr.selected\").length === 0) {\r\n\t\t$(\"#signaturesWidget #delete-signature\").addClass(\"disabled\");\r\n\t} else {\r\n\t\t$(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\r\n\t}\r\n\r\n\t// Enable/Disable edit icon\r\n\tif ($(\"#sigTable tr.selected\").length === 1) {\r\n\t\t$(\"#signaturesWidget #edit-signature\").removeClass(\"disabled\");\r\n\t} else {\r\n\t\t$(\"#signaturesWidget #edit-signature\").addClass(\"disabled\");\r\n\t}\r\n})\r\n\r\n$(\"#dialog-error\").dialog({\r\n\tautoOpen: false,\r\n\tresizable: false,\r\n\tminHeight: 0,\r\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\tbuttons: {\r\n\t\tOk: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\r\n\t},\r\n\tcreate: function() {\r\n\t\t$(this).dialog(\"option\", \"show\", {effect: \"shake\", duration: 150, easing: \"easeOutElastic\"});\r\n\t}\r\n});\r\n\r\n$(\"#dialog-msg\").dialog({\r\n\tautoOpen: false,\r\n\tresizable: false,\r\n\tminHeight: 0,\r\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\tbuttons: {\r\n\t\tOk: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\r\n\t}\r\n});\r\n\r\n$(\"#dialog-confirm\").dialog({\r\n\tautoOpen: false,\r\n\tresizable: false,\r\n\tminHeight: 0,\r\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\tbuttons: {\r\n\t\tCancel: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\r\n\t}\r\n});\r\n\r\nif (window.location.href.indexOf(\"galileo\") != -1) {\r\n\tNotify.trigger(\"This is the test version of Tripwire.<br/>Please use <a href='https://tripwire.cloud-things.com'>Tripwire</a>\")\r\n}\r\n","/** Functions for rendering things relating to wormholes */\r\nconst wormholeRendering = new function() { \r\n\t/** Render a wormhole type (from appData.wormholes).\r\n\t* @param type The type object e.g. appData.wormholes.B274\r\n\t* @param key The wormhole type e.g. 'B274'\r\n\t* @param from What system, or type of system e.g. 'Class-2' the wormhole comes from. If omitted, the type object will be used\r\n\t* @param target As above but for the target of the wormhole\r\n\t*/\r\n\tthis.renderWormholeType = function(type, key, from, target) {\r\n\t\treturn ((key || type.key) ? '<b>' + (key || type.key || '') + '</b>: ' : '') +\r\n\t\t\tformatEndTypes(type.from, from) + '➔' + formatEndTypes(type.leadsTo, target) +\r\n\t\t\t(type.jump ? ' (' + this.renderMass(type.jump) + ')' : '')\r\n\t\t\t;\r\n\t};\r\n\t\r\n\t/** Render a mass number. */\r\n\tthis.renderMass = function(mass) { return Math.trunc(mass / 1e6) + 'kt'; }\r\n\t\r\n\tfunction formatEndTypes(types, override) {\r\n\t\tif(!types) { return '?'; }\r\n\t\ttypes = Array.isArray(types) ? types : [ types ];\r\n\t\t\r\n\t\tif(override) {\r\n\t\t\tconst overrideSystem = override.name ? override :\r\n\t\t\t\tsystemAnalysis.analyse(Object.index(appData.systems, \"name\", override, true) || override);\t// look up real system ID first\r\n\t\t\t\r\n\t\t\tconst eligibleTypes = types.filter(function(type) {\r\n\t\t\t\treturn overrideSystem.name == type || overrideSystem.genericSystemType == type;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif(eligibleTypes.length) { types = eligibleTypes; }\r\n\t\t}\r\n\t\t\r\n\t\treturn types.map(function(type) {\r\n\t\t\tconst systemID = Object.index(appData.systems, \"name\", type, true) || type;\t// look up real system ID first\r\n\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\treturn system ? '<span class=\"' + system.systemTypeClass + '\">' + (system.name || system.systemTypeName) + '</span>' : undefined }\r\n\t\t).filter(function(x) { return x !== undefined; }).join(',');\r\n\t};\r\n}","// Custom inlinecomplete + dropdown input\r\n$.widget(\"custom.inlinecomplete\", $.ui.autocomplete, {\r\n\t_create: function() {\r\n\t\tthis.options.source = this._coerceSource(this.options.source);\r\n\t\t\r\n\t\tif (!this.element.is(\"input\")) {\r\n\t\t\tthis._selectInit();\r\n\t\t}\r\n\r\n\t\t// Invoke the parent function\r\n\t\treturn this._super();\r\n\t},\r\n\t_value: function() {\r\n\t\t// Invoke the parent function\r\n\t\tvar originalReturn = this._superApply(arguments);\r\n\r\n\t\tthis.element.change();\r\n\r\n\t\treturn originalReturn;\r\n\t},\r\n\t_suggest: function(items) {\r\n\t\t// if (this.element.val() != items[0].value) {\r\n\t\t\t// this.element.val(items[0].value.substr(0, this.element.val().length));\r\n\t\t// }\r\n\r\n\t\t// Invoke the parent function\r\n\t\treturn this._super(items);\r\n\t},\r\n\t_coerceSource: function(source) {\r\n\t\t// Allow an object source like tripwire.systems - coerce it to an array\r\n\t\treturn $.isArray(source) ? source :\r\n\t\t\tObject.keys(source).map(function(k) { return Object.assign({ key: k }, source[k]); }.bind(this) );\r\n\t},\r\n\t_initSource: function() {\r\n\t\tthis.source = function(request, response) {\r\n\t\t\tvar matcher = new RegExp(\"^\" + $.ui.autocomplete.escapeRegex(request.term), \"i\");\r\n\t\t\tvar results = new Array(); // results array\r\n\t\t\tconst dataSource = this.options.source;\r\n\t\t\tvar maxSize = this.options.maxSize || 25; // maximum result size\r\n\t\t\t// simple loop for the options\r\n\t\t\tfor (var i = 0, l = dataSource.length; i < l; i++) {\r\n\t\t\t\tconst target = dataSource[i].name || dataSource[i].key || dataSource[i];\r\n\t\t\t\tif (matcher.test(target)) {\r\n\t\t\t\t\tresults.push( { value: target, label: target, content: typeof dataSource[i] === 'object' ? dataSource[i] : undefined });\r\n\r\n\t\t\t\t\tif (maxSize && request.term !== '' && results.length > maxSize) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t // send response\r\n\t\t\t response(results);\r\n\t\t}\r\n\t},\t\r\n\t_renderItem: function( ul, item ) {\r\n\t\tif(item.content && this.options.renderer) {\r\n\t\t\tconst renderFunction = typeof this.options.renderer === 'function' ? this.options.renderer : renderers[this.options.renderer];\r\n\t\t\tconst renderResult = renderFunction(item.content);\r\n\t\t\treturn $( \"<li>\" )\r\n\t\t\t.html( '<span>' + renderResult + '</span>')\r\n\t\t\t.appendTo( ul );\r\n\t\t} else return this._super(ul, item);\r\n\t},\r\n\t_close: function(event) {\r\n\t\tthis.options.source = this.options.input_source ? this.options.input_source : this.options.source;\r\n\r\n\t\t// Invoke the parent function\r\n\t\treturn this._super(event);\r\n\t},\r\n\taddToSelect: function(value) {\r\n\t\tthis.options.select_added_value = value;\r\n\t\tthis.options.select_source.unshift(value);\r\n\t},\r\n\tremoveFromSelect: function(value) {\r\n\t\tif (value) {\r\n\t\t\tthis.options.select_source.splice(value, 1);\r\n\t\t} else if (this.options.select_added_value) {\r\n\t\t\tthis.options.select_source.splice(this.options.select_added_value, 1);\r\n\t\t}\r\n\t\tthis.options.select_added_value = null;\r\n\t},\r\n\t_selectInit: function() {\r\n\t\tthis.element.addClass(\"custom-combobox\");\r\n\t\tthis.wrapper = this.element;\r\n\t\tthis.element = this.wrapper.find(\"input:first\") || this.element;\r\n\t\tthis.select = this.wrapper.find(\"select:first\").remove();\r\n\r\n\t\tthis.options.input_source = this.options.source;\r\n\t\tconst selectItemMapper = this.options.select_item_mapper || function(x) { return x; };\r\n\t\tthis.options.select_source = selectItemMapper(this.select.children(\"option[value!='']\").map(function() { return $.trim(this.text); }).toArray());\r\n\r\n\t\tthis._createShowAllButton();\r\n\t},\r\n\t_createShowAllButton: function() {\r\n        var that = this,\r\n          wasOpen = false;\r\n\r\n        $(\"<a>\")\r\n\t\t\t.attr(\"tabIndex\", that.element.prop(\"tabindex\"))\r\n\t\t\t.attr(\"title\", \"\")\r\n\t\t\t.appendTo(that.wrapper)\r\n\t\t\t.button({icons: {primary: \"ui-icon-triangle-1-s\"}, text: false})\r\n\t\t\t.removeClass(\"ui-corner-all\")\r\n\t\t\t.addClass(\"custom-combobox-toggle ui-corner-right\")\r\n\t\t\t.on(\"mousedown\", function() {\r\n\t\t\t\twasOpen = that.widget().is(\":visible\");\r\n\t\t\t})\r\n\t\t\t.on(\"click\", function() {\r\n\t\t\t\tthat.element.trigger(\"focus\");\r\n\r\n\t\t\t\t// Close if already visible\r\n\t\t\t\tif (wasOpen) {\r\n\t\t\t\t  return;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Pass empty string as value to search for, displaying all results\r\n\t\t\t\tif(that.options.customDropdown) {\r\n\t\t\t\t\tthat.options.select_source = that._coerceSource(that.options.customDropdown())\r\n\t\t\t\t}\r\n\t\t\t\tthat.options.source = that.options.select_source;\r\n\t\t\t\tthat._search(\"\");\r\n\t\t\t});\r\n\t},\r\n});\r\n\r\nconst renderers =  {\r\n\tsystem: function(system) {\r\n\t\treturn systemRendering.renderSystem(systemAnalysis.analyse(undefined, system), 'span');\r\n\t},\r\n\twormholeType: wormholeRendering.renderWormholeType\r\n};\r\n","const systemAnalysis = new function() {\r\n\tconst mutators = [];\r\n\tthis.addMutator = function(m) { mutators.push(m); }\r\n\t\r\n\t/** Extract attributes of the system, and allow mutators to add/modify them.\r\n\t\tOptionally, pass in a system object */\r\n\tthis.analyse = function(systemID, system) {\r\n\t\tif(!system) { system = appData.systems[systemID]; }\r\n\t\tif(!system) { system = getDummySystem(systemID); }\r\n\t\tif(!systemID) { systemID = system.systemID; }\r\n\t\tconst r = Object.assign({}, system);\r\n\t\t\r\n\t\t// Defaults or saved original values\r\n\t\tr.baseSecurity = 1 * system.security;\r\n\t\tr.pathSymbol = '■';\r\n\t\tr.systemTypeModifiers = [];\t\t\r\n\t\tr.systemID = systemID;\r\n\t\t\r\n\t\tmutators.forEach(function(m) { m.mutate(r, systemID); });\r\n\t\t\r\n\t\t// Calculated final values\r\n\t\tr.class = (!r.class || Array.isArray(r.class)) ? r.class : [1 * r.class];\r\n\t\tr.systemTypeClass = r.class ? 'wh class-' + r.class[0] :\r\n\t\t\tr.factionID == 500026 ? 'triglavian' :\r\n\t\t\tr.security >= 0.45 ? 'hisec' :\r\n\t\t\tr.security > 0.0 ? 'lowsec' :\r\n\t\t\tr.security <= 0.0 ? 'nullsec' :\r\n\t\t\t'unknown';\r\n\t\tr.systemTypeName = r.class ? 'C' + r.class.join('/') :\r\n\t\t\tr.factionID == 500026 ? 'Trig' :\r\n\t\t\tr.baseSecurity >= 0.45 ? 'HS' :\r\n\t\t\tr.baseSecurity > 0.0 ? 'LS' :\r\n\t\t\tr.baseSecurity <= 0.0 ? 'NS' :\r\n\t\t\t' ';\r\n\t\tr.genericSystemType = r.class ? r.class.map(x => 'Class-' + x) :\r\n\t\t\tr.factionID == 500026 ? ['Triglavian'] :\r\n\t\t\tr.baseSecurity >= 0.45 ? ['High-Sec'] :\r\n\t\t\tr.baseSecurity > 0.0 ? ['Low-Sec'] :\r\n\t\t\tr.baseSecurity <= 0.0 ? ['Null-Sec'] :\r\n\t\t\tundefined;\r\n\t\tr.effectClass = \r\n\t\t\tr.effect === 'Black Hole' ? 'blackhole' :\r\n\t\t\tr.effect === 'Cataclysmic Variable' ? 'cataclysmic-variable' :\r\n\t\t\tr.effect === 'Magnetar' ? 'magnetar' :\r\n\t\t\tr.effect === 'Pulsar' ? 'pulsar' :\r\n\t\t\tr.effect === 'Red Giant' ? 'red-giant' :\r\n\t\t\tr.effect === 'Wolf-Rayet Star' ? 'wolf-rayet' :\r\n\t\t\tundefined;\r\n\t\t\t\r\n\t\treturn r;\r\n\t};\r\n\t\r\n\t/** Get the classes possible for a 'leads to' text e.g. 'Class-2', 'Dangerous', 'Triglavian' */\r\n\tfunction classForTypeName(leadsTo) {\r\n\t\treturn leadsTo && leadsTo.substring(0, 6) == 'Class-' ? [1 * leadsTo.substring(6)] :\r\n\t\t\t'Dangerous' == leadsTo ? [4,5] :\r\n\t\t\t'Unknown' == leadsTo ? [2,3] :\r\n\t\t\t'Unknown (small)' == leadsTo ? [1,2,3,13] :\r\n\t\t\tundefined;\r\n\t};\r\n\tthis.classForTypeName = classForTypeName;\t// expose public\r\n\t\r\n\t/** Create a dummy system object for fake IDs like 'Null-Sec', 'Class-5' etc */\r\n\tfunction getDummySystem(systemID) {\r\n\t\tconst leadsToPointer = typeof(systemID) === \"string\" && systemID.indexOf(\"|\") >= 0 ? appData.genericSystemTypes[systemID.substring(0, systemID.indexOf(\"|\"))]\r\n\t\t: appData.genericSystemTypes.indexOf(systemID) >= 0 ? systemID\r\n\t\t: appData.genericSystemTypes[systemID];\r\n\t\tconst nodeClass = classForTypeName(leadsToPointer);\r\n\t\tconst nodeSecurity = \r\n\t\t\tleadsToPointer == \"High-Sec\" ? 0.8 :\r\n\t\t\tleadsToPointer == \"Low-Sec\" ? 0.4 :\r\n\t\t\tleadsToPointer == \"Null-Sec\" ? -0.1 :\r\n\t\t\tundefined;\r\n\t\tconst nodeFaction = \r\n\t\t\tleadsToPointer == \"Triglavian\" ? 500026 :\r\n\t\t\tundefined;\r\n\t\t\r\n\t\treturn { security: nodeSecurity, class: nodeClass, factionID: nodeFaction };\r\n\t}\r\n}","const mutator_favourite = new _FavouriteMutator();\r\nsystemAnalysis.addMutator(mutator_favourite);\r\n\r\nfunction _FavouriteMutator() {\r\n\tconst _this = this;\r\n\r\n\tthis.mutate = function(system, systemID) {\r\n\t\tif(options.favorites.indexOf(systemID * 1) >= 0) {\r\n\t\t\tsystem.pathSymbol = '★';\r\n\t\t\tsystem.systemTypeModifiers.push('<span class=\"favorite active\" data-icon=\"star\"></span>');\t\t// star added by CSS\r\n\t\t}\r\n\t}\r\n}","const invasions = new _Invasions();\r\nsystemAnalysis.addMutator(invasions);\r\n\r\nfunction _Invasions() {\r\n\tconst _this = this;\r\n\tconst pathSymbolMap = {\r\n\t\tstellar_reconnaissance: '◆',\r\n\t\t\r\n\t\ttriglavian_minor_victory: '▽',\r\n\t\tescalating_liminality: '▽',\r\n\t\tfinal_liminality: '▼',\r\n\t\t\r\n\t\tedencom_minor_victory: '△',\r\n\t\tredoubt: '△', bulwark: '△',\r\n\t\tfortress: '▲',\r\n\t};\r\n\tconst textMap = {\r\n\t\tstellar_reconnaissance: 'Stellar Reconnaissance',\r\n\t\t\r\n\t\ttriglavian_minor_victory: 'Triglavian Minor Victory',\r\n\t\tescalating_liminality: 'Escalating Liminality',\r\n\t\tfinal_liminality: 'Final Liminality',\r\n\t\t\r\n\t\tedencom_minor_victory: 'EDENCOM Minor Victory',\r\n\t\tredoubt: 'Redoubt',\r\n\t\tbulwark: 'Bulwark',\r\n\t\tfortress: 'EDENCOM Fortress',\r\n\t}\r\n\tconst data = [{\"system_id\":30003088,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-10-04T12:29:02.888Z\",\"system_name\":\"Oyonata\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003894,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-10-01T18:28:09.852Z\",\"system_name\":\"Sabusi\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004302,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T15:36:50.977Z\",\"system_name\":\"Omigiav\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003539,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T14:11:30.759Z\",\"system_name\":\"Miakie\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005074,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T14:02:33.042Z\",\"system_name\":\"Daran\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003570,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T13:47:01.992Z\",\"system_name\":\"Elore\",\"system_security\":\"0.2\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003573,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-28T15:38:24.368Z\",\"system_name\":\"Pertnineere\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003463,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-28T15:38:14.299Z\",\"system_name\":\"Erlendur\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002079,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-09-28T15:37:20.058Z\",\"system_name\":\"Krirald\",\"system_security\":\"0.2\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002652,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-09-28T15:36:53.719Z\",\"system_name\":\"Ala\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30045331,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-28T15:36:28.616Z\",\"system_name\":\"Vaaralen\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003788,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-26T12:44:03.049Z\",\"system_name\":\"Intaki\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002724,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-25T00:51:28.251Z\",\"system_name\":\"Assiettes\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002999,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-24T12:03:23.037Z\",\"system_name\":\"Shastal\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000102,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-23T22:22:21.093Z\",\"system_name\":\"Dysa\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003919,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-22T10:22:11.970Z\",\"system_name\":\"Ashkoo\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004978,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-22T10:21:30.195Z\",\"system_name\":\"Pemene\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004287,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-20T11:25:28.863Z\",\"system_name\":\"Esubara\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002051,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-20T11:25:09.478Z\",\"system_name\":\"Anher\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003823,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-20T11:24:54.777Z\",\"system_name\":\"Kenninck\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001400,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-18T14:03:33.048Z\",\"system_name\":\"Litiura\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005251,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-18T09:42:27.550Z\",\"system_name\":\"Asanot\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005267,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-17T11:18:57.960Z\",\"system_name\":\"Bherdasopt\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002411,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.3\",\"updated_at\":\"2020-09-17T00:30:42.544Z\",\"system_name\":\"Skarkon\",\"system_security\":\"0.1\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003587,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-15T01:16:50.021Z\",\"system_name\":\"Harner\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003904,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-14T16:54:07.359Z\",\"system_name\":\"Col\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005209,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-14T16:53:54.556Z\",\"system_name\":\"Sibe\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004103,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-14T13:40:36.727Z\",\"system_name\":\"Kothe\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005219,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-13T09:34:00.331Z\",\"system_name\":\"Sigga\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002755,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-12T20:51:38.354Z\",\"system_name\":\"Usi\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003824,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-11T08:28:52.435Z\",\"system_name\":\"Archavoinet\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002239,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-11T08:28:42.669Z\",\"system_name\":\"Rammi\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005005,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.5\",\"updated_at\":\"2020-09-10T21:09:12.196Z\",\"system_name\":\"Ignebaener\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000021,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.8\",\"updated_at\":\"2020-09-09T21:16:25.577Z\",\"system_name\":\"Kuharah\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000118,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-09T08:08:17.988Z\",\"system_name\":\"Uanzin\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003794,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-07T23:26:42.297Z\",\"system_name\":\"Stacmon\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003927,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-07T22:18:47.862Z\",\"system_name\":\"Zahefeus\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000109,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-07T20:54:30.351Z\",\"system_name\":\"Berta\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002797,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.9\",\"updated_at\":\"2020-09-06T13:33:29.649Z\",\"system_name\":\"Kaunokka\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30031392,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-09-06T13:33:15.544Z\",\"system_name\":\"Komo\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30004090,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-06T06:22:50.377Z\",\"system_name\":\"Aband\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000060,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-06T01:54:13.794Z\",\"system_name\":\"Janus\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003548,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-05T17:05:22.429Z\",\"system_name\":\"Barira\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000160,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-04T23:48:55.626Z\",\"system_name\":\"Reisen\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30004999,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-04T15:38:27.450Z\",\"system_name\":\"Ladistier\",\"system_security\":\"0.3\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000113,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-04T07:07:27.574Z\",\"system_name\":\"Astabih\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004295,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-02T18:09:55.446Z\",\"system_name\":\"Keba\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001413,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.2\",\"updated_at\":\"2020-09-02T08:11:42.869Z\",\"system_name\":\"Nani\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002386,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-01T08:04:35.922Z\",\"system_name\":\"Gelfiven\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30004973,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T21:17:02.227Z\",\"system_name\":\"Caslemon\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004231,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T20:32:52.884Z\",\"system_name\":\"Shakasi\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004284,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T20:32:43.772Z\",\"system_name\":\"Defsunun\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002266,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T10:38:02.368Z\",\"system_name\":\"Ahmak\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003932,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-29T23:12:29.549Z\",\"system_name\":\"Timudan\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004254,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-28T16:43:28.986Z\",\"system_name\":\"Fihrneh\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004244,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-28T07:55:35.187Z\",\"system_name\":\"Onanam\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002513,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-27T20:59:21.817Z\",\"system_name\":\"Dammalin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30000206,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.5\",\"updated_at\":\"2020-08-27T14:06:44.066Z\",\"system_name\":\"Wirashoda\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002048,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-27T11:14:57.970Z\",\"system_name\":\"Bei\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003090,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-26T23:04:35.948Z\",\"system_name\":\"Saidusairos\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003478,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-26T00:06:02.331Z\",\"system_name\":\"Basan\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004289,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-25T11:33:32.949Z\",\"system_name\":\"Vaini\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30045345,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-24T21:16:26.292Z\",\"system_name\":\"Hirri\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30001358,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-24T08:44:18.165Z\",\"system_name\":\"Ossa\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003061,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-24T07:23:55.183Z\",\"system_name\":\"Mormelot\",\"system_security\":\"0.2\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30040141,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-08-23T11:05:21.929Z\",\"system_name\":\"Urhinichi\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003078,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-22T18:47:39.976Z\",\"system_name\":\"Erkinen\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002530,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-22T15:09:00.523Z\",\"system_name\":\"Avesber\",\"system_security\":\"0.8\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003900,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-22T07:50:34.044Z\",\"system_name\":\"Ham\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002644,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-21T08:26:40.788Z\",\"system_name\":\"Ambeke\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001401,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-21T00:44:17.584Z\",\"system_name\":\"Nonni\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30045328,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.7\",\"updated_at\":\"2020-08-20T14:35:34.268Z\",\"system_name\":\"Ahtila\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003480,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-20T11:19:04.711Z\",\"system_name\":\"Amod\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004141,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-20T01:50:23.539Z\",\"system_name\":\"Hiremir\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002770,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.1\",\"updated_at\":\"2020-08-18T14:53:00.972Z\",\"system_name\":\"Tunudan\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003504,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.7\",\"updated_at\":\"2020-08-18T14:46:27.787Z\",\"system_name\":\"Niarja\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002253,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-18T09:31:28.183Z\",\"system_name\":\"Arshat\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002737,\"status\":\"final_liminality\",\"derived_security_status\":\"0.0\",\"updated_at\":\"2020-08-16T21:29:53.121Z\",\"system_name\":\"Konola\",\"system_security\":\"0.7\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003398,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-16T17:38:55.577Z\",\"system_name\":\"Anbald\",\"system_security\":\"0.7\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003490,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-15T20:27:08.919Z\",\"system_name\":\"Khopa\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001696,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-14T06:57:31.468Z\",\"system_name\":\"Iro\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000192,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.3\",\"updated_at\":\"2020-08-14T01:51:38.839Z\",\"system_name\":\"Otanuomi\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002772,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-13T11:24:31.714Z\",\"system_name\":\"Rairomon\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005284,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-13T11:24:24.229Z\",\"system_name\":\"Promised Land\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30045354,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-13T07:37:02.262Z\",\"system_name\":\"Reitsato\",\"system_security\":\"0.2\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005222,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-12T17:58:16.210Z\",\"system_name\":\"Serren\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003556,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-10T23:13:52.643Z\",\"system_name\":\"Arton\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005086,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-10T06:50:08.222Z\",\"system_name\":\"Arza\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000157,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.3\",\"updated_at\":\"2020-08-10T06:49:46.743Z\",\"system_name\":\"Otela\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003918,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-09T15:49:15.024Z\",\"system_name\":\"Hakana\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002385,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-09T00:34:34.831Z\",\"system_name\":\"Teonusude\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002704,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-07T22:29:26.455Z\",\"system_name\":\"Adrallezoen\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001372,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.9\",\"updated_at\":\"2020-08-07T19:29:54.183Z\",\"system_name\":\"Kino\",\"system_security\":\"0.7\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003908,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-07T07:00:48.775Z\",\"system_name\":\"Bashyam\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000012,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-06T09:30:28.248Z\",\"system_name\":\"Asabona\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005058,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T21:45:44.898Z\",\"system_name\":\"Neesher\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004305,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T21:24:35.293Z\",\"system_name\":\"Esaeel\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003883,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T20:44:57.150Z\",\"system_name\":\"Keberz\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003481,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T07:41:10.729Z\",\"system_name\":\"Unefsih\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003397,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-04T16:45:17.206Z\",\"system_name\":\"Bongveber\",\"system_security\":\"0.9\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002702,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-08-04T11:15:48.842Z\",\"system_name\":\"Archee\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003460,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-03T22:03:14.542Z\",\"system_name\":\"Offikatlin\",\"system_security\":\"0.4\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30004084,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-02T17:58:04.736Z\",\"system_name\":\"Ghesis\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003574,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T20:28:35.755Z\",\"system_name\":\"Boystin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30005213,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T20:20:33.816Z\",\"system_name\":\"Hesarid\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005308,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T10:42:51.414Z\",\"system_name\":\"Jufvitte\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002665,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T02:12:09.248Z\",\"system_name\":\"Misneden\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000188,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T02:11:39.811Z\",\"system_name\":\"Hentogaira\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002557,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-31T18:00:06.264Z\",\"system_name\":\"Atgur\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003058,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-29T09:14:47.194Z\",\"system_name\":\"Olide\",\"system_security\":\"0.7\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30005334,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-28T23:28:39.525Z\",\"system_name\":\"Tierijev\",\"system_security\":\"0.8\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003046,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.5\",\"updated_at\":\"2020-07-28T14:20:51.847Z\",\"system_name\":\"Angymonne\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003514,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-27T18:47:08.094Z\",\"system_name\":\"Yeeramoun\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002760,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-26T11:44:38.056Z\",\"system_name\":\"Manjonakko\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002506,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-23T18:07:27.688Z\",\"system_name\":\"Osoggur\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30005052,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-21T17:37:44.002Z\",\"system_name\":\"Soumi\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003931,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-20T16:54:45.398Z\",\"system_name\":\"Sassecho\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005255,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-20T09:34:48.342Z\",\"system_name\":\"Saphthar\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30020141,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.9\",\"updated_at\":\"2020-07-19T11:16:57.684Z\",\"system_name\":\"Senda\",\"system_security\":\"0.9\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002795,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-18T01:59:01.724Z\",\"system_name\":\"Oshaima\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30000004,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-17T22:26:00.294Z\",\"system_name\":\"Jark\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004263,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-15T21:20:01.593Z\",\"system_name\":\"Feshur\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000062,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-15T15:49:03.146Z\",\"system_name\":\"Iosantin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002241,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-13T01:22:41.989Z\",\"system_name\":\"Rimbah\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004981,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-12T11:24:07.265Z\",\"system_name\":\"Actee\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002242,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-10T19:06:05.853Z\",\"system_name\":\"Mamenkhanar\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003558,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-10T13:51:31.889Z\",\"system_name\":\"Madimal\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001376,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-09T16:04:24.621Z\",\"system_name\":\"Nourvukaiken\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30045329,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-07-08T10:41:47.622Z\",\"system_name\":\"Ichoriya\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005252,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-07T23:49:41.522Z\",\"system_name\":\"Anzalaisio\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004257,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-07T17:15:51.416Z\",\"system_name\":\"Hakatiz\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004108,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-05T01:56:57.535Z\",\"system_name\":\"Chaneya\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000048,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-03T15:11:36.506Z\",\"system_name\":\"Ihal\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003482,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-02T20:56:41.226Z\",\"system_name\":\"Mista\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002225,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.8\",\"updated_at\":\"2020-07-01T14:11:27.451Z\",\"system_name\":\"Harva\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005263,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-01T13:43:12.530Z\",\"system_name\":\"Mozzidit\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005066,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-01T06:43:25.457Z\",\"system_name\":\"Kerying\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002986,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-28T17:43:41.096Z\",\"system_name\":\"Mendori\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001381,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.1\",\"updated_at\":\"2020-06-27T00:02:01.315Z\",\"system_name\":\"Arvasaras\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30001447,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-25T02:19:25.407Z\",\"system_name\":\"Taisy\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002700,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-24T13:40:05.882Z\",\"system_name\":\"Bawilan\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001390,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-24T09:42:32.895Z\",\"system_name\":\"Pakkonen\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003076,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-23T09:02:12.462Z\",\"system_name\":\"Gammel\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003050,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-23T06:32:08.087Z\",\"system_name\":\"Odixie\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000163,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-22T19:28:52.910Z\",\"system_name\":\"Akora\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003073,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-21T07:12:31.404Z\",\"system_name\":\"Netsalakka\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001391,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-20T21:12:20.299Z\",\"system_name\":\"Piekura\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002771,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-20T00:41:47.611Z\",\"system_name\":\"Kulelen\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30000005,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-19T14:36:55.956Z\",\"system_name\":\"Sasta\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005330,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-19T13:21:23.145Z\",\"system_name\":\"Arraron\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000205,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-18T22:06:13.302Z\",\"system_name\":\"Obe\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003856,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-18T12:10:11.496Z\",\"system_name\":\"Athounon\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004250,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-17T11:42:53.830Z\",\"system_name\":\"Chibi\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004268,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-17T08:56:42.286Z\",\"system_name\":\"Shenda\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005236,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-17T07:25:26.811Z\",\"system_name\":\"Noranim\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003829,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-16T22:17:39.177Z\",\"system_name\":\"Renarelle\",\"system_security\":\"0.3\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30005034,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-16T21:32:34.651Z\",\"system_name\":\"Bridi\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003074,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-16T21:31:28.344Z\",\"system_name\":\"Sasiekko\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003392,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-15T19:26:39.709Z\",\"system_name\":\"Eygfe\",\"system_security\":\"0.7\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30001445,\"status\":\"final_liminality\",\"derived_security_status\":\"0.0\",\"updated_at\":\"2020-06-15T03:38:02.163Z\",\"system_name\":\"Nalvula\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30010141,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.2\",\"updated_at\":\"2020-06-14T01:12:53.428Z\",\"system_name\":\"Sakenta\",\"system_security\":\"1.0\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003809,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-13T20:25:21.879Z\",\"system_name\":\"Brellystier\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001718,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-13T05:28:45.485Z\",\"system_name\":\"Paye\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004256,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-11T13:37:54.195Z\",\"system_name\":\"Edilkam\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002645,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-11T00:28:57.560Z\",\"system_name\":\"Carrou\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30045338,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-10T22:28:25.084Z\",\"system_name\":\"Hikkoken\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30004301,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-10T16:44:37.396Z\",\"system_name\":\"Anath\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002575,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-10T05:41:23.824Z\",\"system_name\":\"Sotrenzur\",\"system_security\":\"0.3\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003515,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-08T06:49:36.637Z\",\"system_name\":\"Anila\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004100,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-08T03:04:19.196Z\",\"system_name\":\"Halibai\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002397,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-08T01:10:38.296Z\",\"system_name\":\"Horaka\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002662,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-07T11:22:11.884Z\",\"system_name\":\"Pulin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001383,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-07T06:16:44.145Z\",\"system_name\":\"Vaajaita\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003854,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T19:17:57.398Z\",\"system_name\":\"Alamel\",\"system_security\":\"0.2\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003464,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T19:16:59.888Z\",\"system_name\":\"Aldik\",\"system_security\":\"0.7\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30000182,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T19:04:22.126Z\",\"system_name\":\"Inaya\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30001660,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T17:38:27.602Z\",\"system_name\":\"Dabrid\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001685,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T17:34:50.620Z\",\"system_name\":\"Ordat\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005029,\"status\":\"final_liminality\",\"derived_security_status\":\"-1.0\",\"updated_at\":\"2020-06-06T15:44:51.914Z\",\"system_name\":\"Vale\",\"system_security\":\"0.7\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30045322,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T01:44:55.204Z\",\"system_name\":\"Samanuni\",\"system_security\":\"0.7\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003885,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-05T17:09:39.066Z\",\"system_name\":\"Arzanni\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004248,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-05T00:49:40.255Z\",\"system_name\":\"Haimeh\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003495,\"status\":\"final_liminality\",\"derived_security_status\":\"-1.0\",\"updated_at\":\"2020-06-04T23:08:13.644Z\",\"system_name\":\"Raravoss\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003541,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T16:55:17.838Z\",\"system_name\":\"Faswiba\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002651,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T15:38:07.592Z\",\"system_name\":\"Fasse\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004150,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Shaggoth\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002251,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Sadye\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005260,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Keri\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000105,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Abha\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004992,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Palmon\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002243,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Seiradih\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003553,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Warouh\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"}];\r\n\t\r\n\tthis.invasions = _.keyBy(data, function(x) { return x.system_id; });\r\n\t\r\n\t/** Update the system */\r\n\tthis.mutate = function(system, systemID) {\r\n\t\tconst systemInvasion = this.invasions[systemID];\r\n\t\tif(systemInvasion) {\r\n\t\t\tif(systemInvasion.derived_security_status) { system.security = 1 * systemInvasion.derived_security_status; }\r\n\t\t\tsystem.pathSymbol = pathSymbolMap[systemInvasion.status];\r\n\t\t\tconst tip = textMap[systemInvasion.status] +\r\n\t\t\t\t(systemInvasion.derived_security_status ? '<br>Effective security lowered to ' + systemInvasion.derived_security_status : '');\r\n\t\t\tsystem.systemTypeModifiers.push('<span class=\"invasion ' + systemInvasion.status + '\" data-tooltip=\"' + tip + '\">' + system.pathSymbol + '</span>');\r\n\t\t}\r\n\t}\r\n}","var guidance = (function (undefined) {\r\n\t\r\n\r\n\tvar sorter = function (a, b) {\r\n\t\treturn parseFloat (a) - parseFloat (b);\r\n\t}\r\n\r\n\tfunction adjustCostForOptions(mapCost, toSystem) {\t\t\r\n\t\tvar system = systemAnalysis.analyse(30000000 + 1 * toSystem);\r\n\t\tif(!system) { return mapCost; }\r\n\t\tif(options.chain.routeIgnore.enabled && options.chain.routeIgnore.systems.indexOf(system.name) >= 0) {\r\n\t\t\tmapCost += 100;\t// Penalty for an avoided system\r\n\t\t}\r\n\t\tif(system.name == 'Zarzakh') { mapCost += 100; } // Always avoid Zarzakh for its 6h wait\r\n\t\tswitch(options.chain.routeSecurity) {\r\n\t\t\tcase 'highsec': return mapCost + (system.security < 0.45 ? 100 : 0);\r\n\t\t\tcase 'avoid-high': return mapCost + (system.security >= 0.45 ? 100 : 0);\r\n\t\t\tcase 'avoid-null': return mapCost + (system.security <= 0.0 ? 100 : 0);\r\n\t\t\tdefault: return mapCost;\t// in case of some invalid option, default to shortest\r\n\t\t}\t\r\n\t}\r\n\t\r\n\tfunction adjustJumpCost(from, to, cost) {\r\n\t\treturn Guidance.jumpCostModifiers.reduce((cost, modifier) => modifier(from, to, cost), cost);\r\n\t}\r\n\r\n\t/** Find a path between the start and end nodes (which may be arrays), up to the path length limit */\r\n\tvar findPaths = function (map, start, end, limit) {\r\n\t\tif(!Array.isArray(start)) { start = [start]; } \r\n\t\tif(!Array.isArray(end)) { end = [end]; } \r\n\t\t\r\n\t\tstart = start.filter(function(x) { return map[x]; });\r\n\t\tend = end.filter(function(x) { return map[x]; });\r\n\t\t\r\n\t\tconst endsInStart = end.filter(function(x) { return start.indexOf(x) >= 0; });\r\n\t\tif(endsInStart.length) { return [endsInStart[0]]; }\r\n\t\t\r\n\t\tif(!(start.length && end.length)) { return null; }\t// both ends of path must be in network somewhere\r\n\r\n\t\tvar costs = {},\r\n\t\t    open = {'0': []},\r\n\t\t    predecessors = {},\r\n\t\t    keys;\r\n\t\t\r\n\t\tstart.forEach(function(x) { costs[x] = 0; open[0].push(x); });\r\n\r\n\t\tvar addToOpen = function (cost, vertex) {\r\n\t\t\tvar key = \"\" + cost;\r\n\t\t\tif (!open[key]) open[key] = [];\r\n\t\t\topen[key].push(vertex);\r\n\t\t}\r\n\r\n\t\twhile ((keys = Object.keys(open)).length) {\r\n\t\t\tkeys.sort(sorter);\r\n\r\n\t\t\tvar key = keys[0],\r\n\t\t\t    bucket = open[key],\r\n\t\t\t    node = bucket.shift(),\r\n\t\t\t    currentCost = parseFloat(key),\r\n\t\t\t    adjacentNodes = map[node] || {};\r\n\r\n\t\t\tif (!bucket.length) delete open[key];\r\n\t\t\tif(currentCost >= limit) { break; }\r\n\r\n\t\t\tfor (var vertexText in adjacentNodes) {\r\n\t\t\t\tconst vertex = 1 * vertexText;\r\n\t\t\t    if (adjacentNodes[vertex] !== undefined) {\r\n\t\t\t\t\tvar cost = 1 + adjustCostForOptions(adjacentNodes[vertex], vertex),\r\n\t\t\t\t\t    totalCost = cost + currentCost,\r\n\t\t\t\t\t    vertexCost = costs[vertex];\r\n\t\t\t\t\t\r\n\t\t\t\t\tcost = adjustJumpCost(node, vertex, cost);\r\n\r\n\t\t\t\t\tif ((cost > 0) && (vertexCost === undefined) || (vertexCost > totalCost)) {\r\n\t\t\t\t\t\tcosts[vertex] = totalCost;\r\n\t\t\t\t\t\taddToOpen(totalCost, vertex);\r\n\t\t\t\t\t\tpredecessors[vertex] = node;\r\n\t\t\t\t\t\tif(end.indexOf(vertex) >= 0) {\r\n\t\t\t\t\t\t\treturn extractShortest(predecessors, vertex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn null;\t// never hit any end node\r\n\t}\r\n\r\n\tvar extractShortest = function (predecessors, end) {\r\n\t\tvar nodes = [],\r\n\t\t    u = end;\r\n\r\n\t\twhile (u) {\r\n\t\t\tnodes.push(u);\r\n\t\t\tpredecessor = predecessors[u];\r\n\t\t\tu = predecessors[u];\r\n\t\t}\r\n\r\n\t\tnodes.reverse();\r\n\t\treturn nodes;\r\n\t}\r\n\r\n\t/** Find the best path that connects the given nodes, in that order. The limit will be applied to each path segment, not the path as a whole. */\r\n\tvar findMultiNodePath = function (map, nodes, limit) {\r\n\t\tvar start = nodes.shift(),\r\n\t\t    end,\r\n\t\t    predecessors,\r\n\t\t    path = [],\r\n\t\t    shortest;\r\n\r\n\t\twhile (nodes.length) {\r\n\t\t\tend = nodes.shift();\r\n\t\t\tshortest = findPaths(map, start, end, limit);\r\n\r\n\t\t\tif (shortest) {\r\n\t\t\t\tif (nodes.length) {\r\n\t\t\t\t\tpath.push.apply(path, shortest.slice(0, -1));\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn path.concat(shortest);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tstart = end;\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar Guidance = { kSpaceCache: {}, jumpCostModifiers: [] };\r\n\tGuidance.clearCache = function() { Guidance.kSpaceCache = {}; }\r\n\t\r\n\t/** Find the shortest path between start and end nodes on the given map.\r\n\tThe map should be a dictionary of node IDs where each entry is a dictionary of connected nodes and costs (see appData.map.shortest). An additional cost of 1 per jump will be added.\r\n\tYou may also specify a maximum path length limit, if no path under this length is found then no path will be returned, even if a longer one is available.\r\n\tStart and end nodes may be a single ID or an array of IDs. If arrays are used then a single shortest path between any combination of nodes will be returned */\r\n\tGuidance.findShortestPath = function (map, start, end, limit) {\r\n\t\tif(start > 30000000) { start -= 30000000; }\r\n\t\tif(end > 30000000) { end -= 30000000; }\r\n\t\t\r\n\t\tconst nodes = [start, end];\r\n\r\n\t\tconst cacheKey = nodes.join(',') + (limit ? '-' + limit : '');\r\n\t\tconst cachedPath = Guidance.kSpaceCache[cacheKey];\r\n\t\tif(cachedPath === undefined) {\r\n\t\t\treturn Guidance.kSpaceCache[cacheKey] = findPaths(map, start, end, limit);\r\n\t\t} else {\r\n\t\t\treturn cachedPath;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/** Find the systems directly connected to this one. System IDs are in normal (+ 30000000) domain. */\r\n\tGuidance.connections = function(map, start) {\r\n\t\tif(start > 30000000) { start -= 30000000; }\r\n\t\treturn Object.keys(map[start] || {})\r\n\t\t\t.map(k => (k * 1))\r\n\t\t\t.map(k => {\r\n\t\t\t\tconst r = { systemID: k + 30000000 };\r\n\t\t\t\tif(0 > adjustJumpCost(start, k, 1)) { r.closed = true; }\r\n\t\t\t\treturn r;\r\n\t\t\t});\r\n\t}\r\n\r\n\treturn Guidance;\r\n})();\r\n","/** Functions for rendering things relating to systems or parts of the chain */\r\nconst systemRendering = new function() { \r\n\t/** Render a path, as returned from guidance.findShortestPath */\r\n\tthis.renderPath = function(path) {\r\n\t\tif(path.length <= 1 || path.length > options.chain.routingLimit) { return '' + path.length - 1; }\r\n\t\telse {\r\n\t\t\tvar systemMarkup = path\r\n\t\t\t.slice(0, path.length - 1).reverse()\r\n\t\t\t.map(function(s) {\r\n\t\t\t\tconst systemID = 30000000 + 1 * s;\r\n\t\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\t\tconst securityClass = system.systemTypeClass;\r\n\t\t\t\treturn '<span class=\"' + securityClass + '\" data-tooltip=\"' + system.name + ' (' + system.security + ')\" onclick=\"tripwire.systemChange(' + systemID + ')\">' + system.pathSymbol + '</span>';\r\n\t\t\t});\r\n\t\t\tvar r = '<span class=\"path\">';\r\n\t\t\tfor(var i = 0; i < systemMarkup.length; i++) {\r\n\t\t\t\tif(i > 0 && 0 == i % 5) { r += '|'; }\r\n\t\t\t\t\r\n\t\t\t\tr += systemMarkup[i];\t\t\t\t \r\n\t\t\t}\r\n\t\t\treturn r + '</span>';\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.renderEffect = function(system, tag) {\r\n\t\treturn system.effectClass ? \"<\" + tag + \" class='whEffect' data-icon='\"+system.effectClass+\"' data-tooltip='\"+system.effect+\"'></\" + tag + \">\" : '';\r\n\t}\r\n\t\r\n\tthis.renderSystem = function(systemInfo, tag) {\r\n\t\ttag = tag || 'a';\r\n\t\tconst text = systemInfo.name || systemInfo.genericSystemType;\r\n\t\treturn '<' + tag + (tag === 'a' ? ' href=\".?system=' + systemInfo.name + '\"' : '') + '>' + text + '</' + tag + '> (' + this.renderEffect(systemInfo, 'span') + '<span class=\"' + systemInfo.systemTypeClass + '\">' + systemInfo.systemTypeName + '</span>)';\r\n\t}\r\n};","const ChainMapRendererBase = function(owner) {\r\n\t/** Is this renderer ready to accept draw calls? */\r\n\tthis.ready = function() { return !this.drawing; }\r\n\t\r\n\t/** Switch to this renderer. The renderer can be in a blank state; draw() will be called after */\r\n\tthis.switchTo = function() {\r\n\t\tif(!document.getElementById('map-container')) {\r\n\t\t\tconst newDiv = document.createElement('div');\r\n\t\t\tnewDiv.id = 'map-container';\r\n\t\t\tnewDiv.className = 'radial-map';\r\n\t\t\tdocument.getElementById('chainMap').appendChild(newDiv);\r\n\t\t}\r\n\t\tthis.container = document.getElementById('map-container');\r\n\t\tthis.container.style.display = '';\r\n\t}\r\n\t\r\n\t/** Switch away from this renderer. All node divs should be removed from the DOM */\r\n\tthis.switchFrom = function() {\r\n\t\tconst div = document.getElementById('map-container');\r\n\t\tif(div) { div.parentNode.removeChild(div); }\r\n\t\tthis.container = null;\r\n\t}\r\n\t\r\n\tthis.collapse = function(systemID, collapse) {\r\n\t\tif(collapse) { this.mapData.collapsed.push(systemID); }\r\n\t\telse {  this.mapData.collapsed = this.mapData.collapsed.filter(x => x != systemID); }\r\n\t\towner.updateCollapsed(this.mapData.collapsed);\r\n\t\tdrawInner(this.mapData.map, this.mapData.lines, this.mapData.collapsed);\r\n\t}\r\n\t\r\n\t/** Redraw the map, based on the given node set, line overrides and list of collapsed systems */\r\n\tthis.draw = function(map, lines, collapsed) {\r\n\t\tthis.drawing = true;\r\n\t\tthis.mapData = {map: map, lines: lines, collapsed: collapsed};\r\n\t\t\r\n\t\t// Clear the map for a new one\r\n\t\t//this.switchFrom(); this.switchTo();\r\n\r\n\t\ttry { drawInner(map, lines, collapsed); }\r\n\t\tfinally { this.drawing = false; }\r\n\t}\r\n\t\r\n\t/** Get the factor by which the 'arc' (or coverage if linear) for the current level reduces.\r\n\tE.g. for a circle, the 3rd ring is 3/4 the size of the 4th so arcFactor(3) should return 3/4.\r\n\tBy default, all levels are the same 'size' */\r\n\tthis.arcFactor = function(level) { return 1; }\r\n\r\n\tconst _this = this;\r\n\tconst drawInner = function(map, lines, collapsed) {\r\n\t\tconst maps = [];\r\n\t\tconst nodesById = {};\r\n\t\t\r\n\t\t// First pass: arrange nodes into rings\r\n\t\tfor(var ri = 0; ri < map.rows.length; ri++) {\r\n\t\t\tconst item = map.rows[ri];\r\n\t\t\tconst inNode = item.c[0], id = inNode.v, parent = item.c[1].v;\r\n\t\t\t\r\n\t\t\tconst mapNode = { id: id, children: [], systemID: inNode.systemID, minArc: 0 };\r\n\t\t\t\r\n\t\t\tif(parent == null) {\r\n\t\t\t\tconst newMap =  { circles: [ { arc: 0, nodes: [ mapNode ] } ] };\r\n\t\t\t\tmapNode.map = newMap;\r\n\t\t\t\tmapNode.circle = 0;\r\n\t\t\t\tmaps.push(newMap);\r\n\t\t\t} else {\r\n\t\t\t\tconst parentNode = nodesById[parent];\r\n\t\t\t\tif(!parentNode) { throw 'Parent id ' + parent + ' not on map yet'; }\r\n\t\t\t\tparentNode.children.push(mapNode);\r\n\t\t\t\tmapNode.parent = parentNode;\r\n\t\t\t\tmapNode.connection = lines.filter(function(l) { return l[0] == id; })[0] || [id, parent, [], '?'];\r\n\t\t\t\tmapNode.styles = ['connection'].concat(mapNode.connection[2]);\r\n\t\t\t\tmapNode.map = parentNode.map;\r\n\t\t\t\tmapNode.circle = parentNode.circle + 1;\r\n\t\t\t\tif(mapNode.map.circles.length <= mapNode.circle) {\r\n\t\t\t\t\tmapNode.map.circles.push({ arc: 0, nodes:[mapNode] });\r\n\t\t\t\t} else { mapNode.map.circles[mapNode.circle].nodes.push(mapNode); }\r\n\t\t\t}\r\n\t\t\tnodesById[id] = mapNode;\r\n\t\t\tmapNode.markup = inNode.f;\r\n\t\t}\r\n\r\n\t\t// Second pass - for each map, find the allocation of arc needed for each node\r\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\r\n\t\t\tconst map = maps[mi];\r\n\t\t\tfor(var ci = map.circles.length - 1; ci >= 1; ci--) {\t// don't need to calculate ring 0\r\n\t\t\t\tfor(var ni = 0; ni < map.circles[ci].nodes.length; ni++) {\r\n\t\t\t\t\tconst node = map.circles[ci].nodes[ni];\r\n\t\t\t\t\tnode.minArc *= _this.arcFactor(ci);\r\n\t\t\t\t\tif(node.minArc < 1 || collapsed.indexOf(node.systemID * 1) >= 0) { node.minArc = 1; }\r\n\t\t\t\t\tnode.parent.minArc += node.minArc;\r\n\t\t\t\t\tmap.circles[ci].arc += node.minArc;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Third pass - lay out each ring based on the arc values\r\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\r\n\t\t\tconst map = maps[mi];\r\n\t\t\tvar mapDiv = document.getElementById(\"map\" + mi);\r\n\t\t\tif(!mapDiv) {\r\n\t\t\t\tmapDiv = document.createElement('div');\r\n\t\t\t\tmapDiv.id = \"map\" + mi;\r\n\t\t\t\tmapDiv.className = \"map-chain-wrapper\";\r\n\t\t\t}\r\n\t\t\tmapDiv.innerHTML = '<div class=\"map-outer-container\"><div class=\"map-inner-container\"><canvas class=\"map-drawing\" id=\"map-canvas-' + mi + '\"/></div></div>';\r\n\t\t\tconst innerContainer = mapDiv.firstChild.firstChild;\r\n\t\t\tdocument.getElementById('map-container').appendChild(mapDiv);\r\n\r\n\t\t\tconst range = _this.initialRads(map.circles[0].nodes[0].minArc);\r\n\t\t\tmap.bounds = makeDivsForRing(innerContainer, 0, map.circles[0].nodes, -range, range, collapsed);\r\n\t\t\tmap.radRange = { min: -range, max: range };\r\n\t\t\tmap.domNode = mapDiv;\r\n\t\t\tmap.innerContainer = innerContainer;\r\n\t\t}\r\n\r\n\t\t// Fourth pass: update div and canvas bounds, and draw rings/links\r\n\t\tconst CANVAS_SCALE = 1;\r\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\r\n\t\t\tconst map = maps[mi];\r\n\t\t\t// Reset the width overrides so previous expansions aren't persisted if not needed any more\r\n\t\t\tmap.domNode.style.width = null;\r\n\t\t\tmap.domNode.style.height = null;\r\n\t\t\tconst finalPositions = {\r\n\t\t\t\tw: 200 + map.bounds.x[1] - map.bounds.x[0],\r\n\t\t\t\th: 100 + map.bounds.y[1] - map.bounds.y[0],\r\n\t\t\t\tcx: 100 - map.bounds.x[0],\r\n\t\t\t\tcy: 50 - map.bounds.y[0]\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Fill the space available, if we didn't already\r\n\t\t\tconst centringOptions = _this.centringOptions;\r\n\t\t\tif(centringOptions.x && maps.length == 1) {\t// only centre in X if it's the only map, otherwise let them flow\t\r\n\t\t\t\tconst parentWidth = -38 + _this.container.offsetWidth;\t// 20px for map margins, 18 for scrollbar\r\n\t\t\t\tif(finalPositions.w < parentWidth) {\r\n\t\t\t\t\tfinalPositions.cx += 0.5 * (parentWidth - finalPositions.w);\r\n\t\t\t\t\tfinalPositions.w = parentWidth;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t\tif(centringOptions.y) {\r\n\t\t\t\tconst parentHeight = document.getElementById('chainParent').offsetHeight;\r\n\t\t\t\tif(finalPositions.h < parentHeight) {\r\n\t\t\t\t\tfinalPositions.cy += 0.5 * (parentHeight - finalPositions.h);\r\n\t\t\t\t\tfinalPositions.h = parentHeight;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// If there's enough space to centre the top level node now, do it\r\n\t\t\tif(centringOptions.y && centringOptions.rootNode && finalPositions.h >= 2 * (map.bounds.y[1] > -map.bounds.y[0] ? map.bounds.y[1] : -map.bounds.y[0])) {\r\n\t\t\t\tfinalPositions.cy = finalPositions.h / 2;\r\n\t\t\t}\r\n\t\t\tif(centringOptions.x && centringOptions.rootNode && finalPositions.w >= 2 * (map.bounds.x[1] > -map.bounds.x[0] ? map.bounds.x[1] : -map.bounds.x[0])) {\r\n\t\t\t\tfinalPositions.cx = finalPositions.w / 2;\r\n\t\t\t}\t\t\t\r\n\t\t\tmap.domNode.style.width = finalPositions.w + 'px';\r\n\t\t\tmap.domNode.style.height = finalPositions.h + 'px';\r\n\t\t\tconst outerContainer = map.domNode.firstChild;\r\n\t\t\touterContainer.style.left = finalPositions.cx + 'px';\r\n\t\t\touterContainer.style.top = finalPositions.cy + 'px';\r\n\t\t\tconst canvas = outerContainer.getElementsByTagName('canvas')[0];\r\n\t\t\tcanvas.width = CANVAS_SCALE * finalPositions.w;\r\n\t\t\tcanvas.style.width = finalPositions.w + 'px';\r\n\t\t\tcanvas.height = CANVAS_SCALE * finalPositions.h;\r\n\t\t\tcanvas.style.height = finalPositions.h + 'px';\r\n\t\t\tcanvas.style.left = -finalPositions.cx + 'px';\r\n\t\t\tcanvas.style.top = -finalPositions.cy + 'px';\r\n\t\t\tconst ctx = canvas.getContext('2d');\r\n\t\t\tctx.scale(CANVAS_SCALE, CANVAS_SCALE);\r\n\t\t\tctx.translate(finalPositions.cx, finalPositions.cy);\r\n\t\t\t\r\n\t\t\tfor(var ci = map.bounds.maxCi; ci >= 1; ci--) {\t// don't need to draw ring 0\r\n\t\t\t\tif(options.chain.gridlines) {\r\n\t\t\t\t\t_this.drawGridlines(ctx, ci, map.radRange);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst lineWeightFactor = options.chain.lineWeight || 1.0;\r\n\t\t\tfor(var ci = map.bounds.maxCi; ci >= 1; ci--) {\r\n\t\t\t\tif(ci >= map.circles.length) { continue; }\r\n\t\t\t\t\r\n\t\t\t\tctx.save();\r\n\t\t\t\tif(options.chain.aura) { // draw aura first\r\n\t\t\t\t\tdrawConnections(ctx, map.circles[ci].nodes, function(node) {\r\n\t\t\t\t\t\tctx.save();\r\n\t\t\t\t\t\tctx.lineWidth = lineWeightFactor;\r\n\t\t\t\t\t\tconst auraColor = propertyFromCssClass(node.styles, 'color');\r\n\t\t\t\t\t\tctx.shadowBlur = 11 * lineWeightFactor;\r\n\t\t\t\t\t\tctx.shadowColor = auraColor;\r\n\t\t\t\t\t\tctx.strokeStyle = 'black';\r\n\t\t\t\t\t\tfor(let ai = 0; ai < 8; ai++)\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.restore();\t\t\t\t\t\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tdrawConnections(ctx, map.circles[ci].nodes, function(node) {\t\t\r\n\t\t\t\t\tctx.lineWidth = lineWeightFactor * parseInt(propertyFromCssClass(node.styles, 'border-width')) || 2;\r\n\t\t\t\t\tctx.strokeStyle = propertyFromCssClass(node.styles, 'border-top-color');\r\n\t\t\t\t\tctx.setLineDash ({ dashed: [5, 3] }[propertyFromCssClass(node.styles, 'border-top-style')] || []);\r\n\t\t\t\t\tctx.stroke();\r\n\t\t\t\t});\t\t\t\t\t\r\n\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\t\r\n\t\t}\r\n\t\t\r\n\t\t// Remove any maps which aren't in use any more\r\n\t\tfor(var mi = maps.length; ; mi++) {\r\n\t\t\tconst div = document.getElementById('map' + mi);\r\n\t\t\tif(div) { div.parentNode.removeChild(div); }\r\n\t\t\telse { break; }\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction drawConnections(ctx, nodes, drawFunction) {\r\n\t\tfor(var ni = 0; ni < nodes.length; ni++) {\r\n\t\t\tconst node = nodes[ni];\r\n\t\t\tif(!node.position) { continue; }\t// not drawn on map\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.moveTo(node.position.x, node.position.y);\r\n\t\t\t_this.drawConnection(ctx, node);\r\n\t\t\tdrawFunction(node);\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t/** The coordinate space for the full range. May be based on the total requested arc */\r\n\tthis.initialRads = function(minArc) { return Math.PI; }\r\n\t\r\n\t/** How many levels to skip to allow more space for the nodes. Only makes sense if each level is \"wider\" than the previous so it will have more space. */\r\n\tthis.skipLevels = function(ci, nodes, minRad, maxRad, parentCollapsed) { return 0; }\r\n\t\r\n\t/** Set the position of this node based on its level and radial position within the level\r\n\tA \"position\" property with x and y must be set. Other values used in drawConnection may also be set */\r\n\tthis.setPosition = function(node, ci, rad_centre) { throw 'must define setPosition'; }\r\n\t\r\n\t/** Draw the connection from this node to its parent. The current point will be the node's position. By default, draws a line */\r\n\tthis.drawConnection = function(ctx, node) {\r\n\t\tctx.lineTo(node.parent.position.x, node.parent.position.y);\t\t\t\r\n\t}\r\n\r\n\t/** Draw grid lines for this level */\r\n\tthis.drawGridlines = function(ctx, ci, radRange) { }\r\n\t\r\n\tthis.adjustAlignmentDelta = function(ci, rad_centre) { return 0; }\r\n\t\r\n\t/** Override to not centre the map and centre node */\r\n\tthis.centringOptions = { x: true, y: true, root_node: true };\r\n\t\r\n\t/** Add the nodes for this ring/level and all further rings to the container, and return the bounds of the space used by it\r\n\tCalled recursively for chain sub-sections\r\n\t@param ci The index of the current level\r\n\t@param nodes The node data (see chain-map) for nodes within this level\r\n\t@param minRad The minimum radial coordinate for this section of chain\r\n\t@param maxRad The maximum radial coordinate for this section of chain\r\n\t@param collapsed The list of systems which have been collapsed \r\n\t*/\r\n\tfunction makeDivsForRing(innerContainer, ci, nodes, minRad, maxRad, collapsed) {\r\n\t\tconst bounds = { x: [0, 0], y: [0, 0], maxCi: ci };\r\n\t\tif(!nodes.length) { return bounds; }\r\n\t\tconst parentCollapsed = collapsed.indexOf(1 * (nodes[0].parent || {}).systemID) >= 0;\r\n\t\tconst totalArc = parentCollapsed ? nodes.length : nodes.reduce(function(acc, x) { return acc + x.minArc; }, 0);\r\n\t\tconst rads_per_arc = (maxRad - minRad) / totalArc;\r\n\t\tvar rad_offset = minRad;\r\n\t\tfunction getNodeRadialPosition(node) {\r\n\t\t\tconst dr = (parentCollapsed ? 1 : node.minArc) * rads_per_arc,\r\n\t\t\t\trad_centre = rad_offset + (dr / 2);\r\n\t\t\treturn { dr: dr, rad_centre: rad_centre };\r\n\t\t}\r\n\t\tvar alignment_delta = _this.adjustAlignmentDelta(ci, getNodeRadialPosition(nodes[0]).rad_centre);\r\n\t\t\r\n\t\tci += _this.skipLevels(ci, nodes, minRad, maxRad, parentCollapsed);\r\n\r\n\t\t\r\n\t\tfor(var ni = 0; ni < nodes.length; ni++) {\r\n\t\t\tconst node = nodes[ni];\t\r\n\t\t\t\r\n\t\t\t// Make the node\r\n\t\t\tconst frag = document.createRange().createContextualFragment('<div class=\"node-wrapper\">' + node.markup + '</div>');\r\n\t\t\tnode.domNode = frag.firstChild;\r\n\t\t\tinnerContainer.appendChild(node.domNode);\r\n\t\t\tconst systemID = 1 * node.systemID;\r\n\t\t\t$(node.domNode).dblclick(() => _this.collapse(systemID, collapsed.indexOf(systemID) < 0));\r\n\t\t\t\r\n\t\t\t// Position the node\r\n\t\t\tconst nodeRadialPosition = getNodeRadialPosition(node);\r\n\t\t\t\r\n\t\t\t_this.setPosition(node, ci, nodeRadialPosition.rad_centre + alignment_delta);\r\n\t\t\t\r\n\t\t\tif(node.position.x < bounds.x[0]) { bounds.x[0] = node.position.x; }\r\n\t\t\tif(node.position.x > bounds.x[1]) { bounds.x[1] = node.position.x; }\r\n\t\t\tif(node.position.y < bounds.y[0]) { bounds.y[0] = node.position.y; }\r\n\t\t\tif(node.position.y > bounds.y[1]) { bounds.y[1] = node.position.y; }\r\n\t\t\t\r\n\t\t\tnode.domNode.style.left = node.position.x + 'px';\r\n\t\t\tnode.domNode.style.top = node.position.y + 'px';\r\n\t\t\t\r\n\t\t\tif(parentCollapsed) {\r\n\t\t\t\tnode.domNode.style.display = 'none';\r\n\t\t\t} else {\t\t\t\t\r\n\t\t\t\t// Do the segment of the next circle\r\n\t\t\t\tconst excess = (ci > 0 && nodeRadialPosition.dr > node.minArc * ci) ? nodeRadialPosition.dr - node.minArc * ci : 0;\r\n\t\t\t\tif(node.children.length) {\r\n\t\t\t\t\tconst nextBounds = makeDivsForRing(innerContainer, ci + 1, node.children, rad_offset + (0.5 * excess) + alignment_delta, rad_offset - (0.5 * excess) + alignment_delta + nodeRadialPosition.dr, collapsed);\r\n\t\t\t\t\tif(nextBounds.x[0] < bounds.x[0]) { bounds.x[0] = nextBounds.x[0]; }\r\n\t\t\t\t\tif(nextBounds.x[1] > bounds.x[1]) { bounds.x[1] = nextBounds.x[1]; }\r\n\t\t\t\t\tif(nextBounds.y[0] < bounds.y[0]) { bounds.y[0] = nextBounds.y[0]; }\r\n\t\t\t\t\tif(nextBounds.y[1] > bounds.y[1]) { bounds.y[1] = nextBounds.y[1]; }\r\n\t\t\t\t\tif(nextBounds.maxCi > bounds.maxCi) { bounds.maxCi = nextBounds.maxCi; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\trad_offset += nodeRadialPosition.dr;\r\n\t\t}\r\n\t\t\r\n\t\treturn bounds;\r\n\t}\r\n};\r\n\r\n/** https://stackoverflow.com/questions/40978050 */\r\nfunction propertyFromCssClass(className, property) {\r\n\tif(Array.isArray(className)) { className = className.join(' '); }\r\n\tvar elem = document.getElementById('temp-div-' + className);\r\n\tif(!elem) {\r\n\t  elem = document.createElement(\"div\");\r\n\t  elem.id = 'temp-div-' + className;\r\n\t  elem.style.cssText = \"position:fixed;left:-100px;top:-100px;width:1px;height:1px;\";\r\n\t  elem.className = className + ' temp';\r\n\t  document.body.appendChild(elem);  // required in some browsers\r\n\t  }\r\n  const prop = getComputedStyle(elem).getPropertyValue(property);\r\n  //document.body.removeChild(tmp);\r\n  return prop;\r\n}\t","const ChainMapRendererOrgchartSide = function(owner) {\r\n\tChainMapRendererBase.apply(this, arguments);\r\n\t\r\n\tconst GRID_SIZE = { x: 70, y: 45 };\r\n\t\r\n\tthis.initialRads = function(minArc) { return minArc * 0.5; }\r\n\tthis.centringOptions = { y: true };\r\n\t\r\n\tfunction project(rad, ci) { return {\r\n\t\tx: ((ci == 0 ? -0.3 : 0) + ci) * GRID_SIZE.x * options.chain.nodeSpacing.x,\t// root is larger so give some extra space\r\n\t\ty: rad * GRID_SIZE.y * options.chain.nodeSpacing.y\t\r\n\t}; }\r\n\t\r\n\tthis.setPosition = function(node, ci, rad_centre) {\r\n\t\tnode.position = project(rad_centre, ci);\r\n\t}\r\n\t\r\n\tthis.drawConnection = function(ctx, node) {\r\n\t\tconst ave_x = 0.5 * (node.position.x + node.parent.position.x);\r\n\t\tconst cp1 = { x: node.parent.position.x, y: node.position.y };\r\n\t\tconst cp2 = { x: node.parent.position.x, y: node.position.y };\r\n\t\t\r\n\t\tctx.bezierCurveTo(cp2.x, cp2.y, cp1.x, cp1.y, node.parent.position.x, node.parent.position.y);\r\n\t}\r\n\t\r\n\tthis.drawGridlines = function(ctx, ci, radRange) {\r\n\t\tctx.beginPath();\r\n\t\tconst start = project(radRange.min, ci), end = project(radRange.max, ci);\r\n\t\tctx.moveTo(start.x, start.y);\r\n\t\tctx.lineTo(end.x, end.y);\r\n\t\t\r\n\t\tctx.strokeStyle = propertyFromCssClass('grid-default', 'color');\r\n\t\tctx.stroke();\t\t\r\n\t\t\r\n\t\tctx.fillStyle = propertyFromCssClass('grid-default', 'color');\r\n\t\tctx.font = '10px Sans-serif';\r\n\t\tctx.fillText(ci, start.x + 5, start.y);\r\n\t}\t\t\r\n};\r\n\r\nChainMapRendererOrgchartSide.prototype = new ChainMapRendererBase();","const ChainMapRendererOrgchartTop = function(owner) {\r\n\tChainMapRendererBase.apply(this, arguments);\r\n\t\r\n\tconst GRID_SIZE = { x: 55, y: 45 };\r\n\t\r\n\tthis.initialRads = function(minArc) { return minArc * 0.5; }\r\n\tthis.centringOptions = { x: true };\r\n\t\r\n\tfunction project(rad, ci) { return {\r\n\t\tx: rad * GRID_SIZE.x * options.chain.nodeSpacing.x,\r\n\t\ty: ((ci == 0 ? -0.3 : 0) + ci) * GRID_SIZE.y * options.chain.nodeSpacing.y\t// root is larger so give some extra space\r\n\t}; }\r\n\t\r\n\tthis.setPosition = function(node, ci, rad_centre) {\r\n\t\tnode.position = project(rad_centre, ci);\r\n\t\tnode.rad_centre = rad_centre;\r\n\t}\r\n\t\r\n\tthis.drawConnection = function(ctx, node) {\r\n\t\tconst endpoint_y = node.parent.position.y; // + 10 * (3 - Math.abs(node.rad_centre - node.parent.rad_centre));\r\n\t\tconst ave_y = 0.5 * (node.position.y + endpoint_y);\r\n\t\tconst cp1 = { x: node.position.x, y: endpoint_y };\r\n\t\tconst cp2 = { x: node.position.x, y: endpoint_y };\r\n\t\t\r\n\t\tctx.bezierCurveTo(cp2.x, cp2.y, cp1.x, cp1.y, node.parent.position.x, endpoint_y);\r\n\t}\r\n\t\r\n\tthis.drawGridlines = function(ctx, ci, radRange) {\r\n\t\tctx.beginPath();\r\n\t\tconst start = project(radRange.min, ci), end = project(radRange.max, ci);\r\n\t\tctx.moveTo(start.x, start.y);\r\n\t\tctx.lineTo(end.x, end.y);\r\n\t\t\r\n\t\tctx.strokeStyle = propertyFromCssClass('grid-default', 'color');\r\n\t\tctx.stroke();\t\t\r\n\t\t\r\n\t\tctx.fillStyle = propertyFromCssClass('grid-default', 'color');\r\n\t\tctx.font = '10px Sans-serif';\r\n\t\tctx.fillText(ci, start.x, start.y + 12);\r\n\t}\t\t\r\n};\r\n\r\nChainMapRendererOrgchartTop.prototype = new ChainMapRendererBase();","const ChainMapRendererOrgchart = function(owner) {\r\n\tconst _this = this;\r\n\t\r\n\t/** Initialiser - callback from chart onload */\r\n\tthis.init = function() {\r\n\t\t_this.map = new google.visualization.OrgChart(document.getElementById(\"chainMap\"));\r\n\t\t_this.options = {allowHtml: true, allowCollapse: true, size: \"medium\", nodeClass: \"node\"};\r\n\r\n\t\tgoogle.visualization.events.addListener(_this.map, \"collapse\", _this.collapseHandler);\r\n\r\n\t\t_this.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), _this.options);\r\n\t}\r\n\t\r\n\t/** Is this renderer ready to accept draw calls? */\r\n\tthis.ready = function() { return !this.drawing && !!this.map; }\r\n\t\r\n\t/** Switch to this renderer. The renderer can be in a blank state; draw() will be called after */\r\n\tthis.switchTo = function() {\r\n\t\tdocument.getElementById('chainGrid').style.display = '';\r\n\t\tif(!_this.map) { google.charts.setOnLoadCallback(this.init); }\r\n\t}\r\n\t\r\n\t/** Switch away from this renderer. All node divs should be removed from the DOM */\r\n\tthis.switchFrom = function() {\r\n\t\tdocument.getElementById('chainGrid').style.display = 'none';\r\n\t\t_this.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), _this.options);\t\t\r\n\t}\r\n\t\r\n\t/** Redraw the map, based on the given node set, line overrides and list of collapsed systems */\r\n\tthis.draw = function(map, lines, collapsed) {\r\n\t\tthis.drawing = true;\r\n\t\tthis.map.draw(newView(map), this.options); \r\n\t\t\r\n\t\tfor (var x in collapsed) {\r\n\t\t\tconst s = collapsed[x];\r\n\t\t\tconst nodeId = $(\"#chainMap [data-nodeid='\"+s+\"']\").attr(\"id\");\r\n\t\t\tif (nodeId) {\r\n\t\t\t\tconst nodeVal = nodeId.split(\"node\")[1];\r\n\t\t\t\tthis.map.collapse(nodeVal - 1, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tupdateLines(map, lines);\r\n\t\tthis.drawing = false;\r\n\t};\r\n\t\r\n\tconst newView = function(json) {\r\n\t\tconst view = new google.visualization.DataView(new google.visualization.DataTable(json));\r\n\t\treturn view;\r\n\t};\r\n\t\r\n\tconst updateLines = function(map, lines) {\r\n\t\t_this.lastLineData = { map: map, lines: lines };\r\n\t\tfunction drawNodeLine(system, parent, mode, signatureID) {\r\n\t\t\t/*\tfunction for drawing colored lines  */\r\n\t\t\tif(typeof mode == 'string') { mode = [mode]; }\r\n\r\n\t\t\tfunction addModes(jquerySelector, prefixes) { return doModeClasses(jquerySelector, prefixes, function(s, c) { s.addClass(c); }); }\r\n\t\t\tfunction removeModes(jquerySelector, prefixes) { return doModeClasses(jquerySelector, prefixes, function(s, c) { s.removeClass(c); }); }\r\n\t\t\tfunction doModeClasses(jquerySelector, prefixes, classFunc) {\r\n\t\t\t\tprefixes = prefixes || [];\r\n\t\t\t\tprefixes.push('');\r\n\t\t\t\tprefixes.forEach(function(prefix) { \r\n\t\t\t\t\tmode.forEach( function(mode) { classFunc(jquerySelector, (prefix.length ? prefix + '-' : '') + mode); });\r\n\t\t\t\t});\r\n\t\t\t\treturn jquerySelector;\r\n\t\t\t}\r\n\r\n\t\t\t// Find node in chainmap\r\n\t\t\t//var $node = $(\"#chainMap [data-nodeid='\"+system+\"']\").parent();\r\n\t\t\tvar $node = $(\"#chainMap #node\"+system).parent();\r\n\r\n\t\t\tif ($node.length == 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Get node # in this line\r\n\t\t\tvar nodeIndex = Math.ceil(($node[0].cellIndex + 1) / 2 - 1);\r\n\r\n\t\t\t// applly to my top line\r\n\t\t\tvar $connector = addModes($($node.parent().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[nodeIndex]), [ 'left', 'right' ]);\r\n\r\n\t\t\t// Find parent node\r\n\t\t\t//var $parent = $(\"#chainMap [data-nodeid='\"+parent+\"']\").parent();\r\n\t\t\tvar $parent = $(\"#chainMap #node\"+parent).parent();\r\n\r\n\t\t\tif ($parent.length == 0 || $connector.length == 0)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t// Find the col of my top line\r\n\t\t\tvar nodeCol = 0, connectorCell = $connector[0].cellIndex;\r\n\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\r\n\t\t\t\tnodeCol += this.colSpan;\r\n\r\n\t\t\t\tif (index == connectorCell) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Get node # in this line\r\n\t\t\tvar parentIndex = Math.ceil(($parent[0].cellIndex + 1) / 2 - 1);\r\n\r\n\t\t\t// Compensate for non-parent nodes (slight performance hit ~10ms)\r\n\t\t\tvar newparentIndex = parentIndex;\r\n\t\t\tfor (var i = 0; i <= parentIndex; i++) {\r\n\t\t\t\tvar checkSystem = 0;//$node.parent().prev().prev().prev().find(\"td:has([data-nodeid]):eq(\"+i+\")\").find(\"[data-nodeid]\").data(\"nodeid\");\r\n\t\t\t\t$node.parent().prev().prev().prev().find(\"td > [data-nodeid]\").each(function(index) {\r\n\t\t\t\t\tif (index == i) {\r\n\t\t\t\t\t\tcheckSystem = $(this).attr(\"id\").replace(\"node\", \"\");//$(this).data(\"nodeid\");\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif ($.map(map.rows, function(node) { return node.c[1].v == checkSystem ? node : null; }).length <= 0) {\r\n\t\t\t\t\tnewparentIndex--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tparentIndex = newparentIndex;\r\n\r\n\t\t\t// Apply to parent bottom line\r\n\t\t\tvar $connecte = addModes($($node.parent().prev().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[parentIndex]), [ 'left', 'right'] );\r\n\r\n\t\t\t// the beans\r\n\t\t\tvar col = 0, parent = false, me = false;\r\n\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index, value) {\r\n\t\t\t\tcol += this.colSpan;\r\n\r\n\t\t\t\tif (me && parent) {\r\n\t\t\t\t\t// All done - get outta here\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else if (typeof($connecte[0]) != \"undefined\" && $connecte[0].cellIndex == index) {\r\n\t\t\t\t\tparent = true;\r\n\r\n\t\t\t\t\taddModes($(this), ['left']);\r\n\r\n\t\t\t\t\t// remove bottom border that points to the right\r\n\t\t\t\t\tif (!me && col != nodeCol) {\r\n\t\t\t\t\t\taddModes($(this), ['bottom']);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// parent and node are same - we are done\r\n\t\t\t\t\tif (nodeCol == col) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (col == nodeCol) {\r\n\t\t\t\t\tme = true;\r\n\r\n\t\t\t\t\taddModes($(this), [ 'bottom' ]);\r\n\t\t\t\t} else if (me || parent) {\r\n\t\t\t\t\tvar tempCol = 0, breaker = false, skip = false;\r\n\r\n\t\t\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\r\n\t\t\t\t\t\ttempCol += this.colSpan;\r\n\r\n\t\t\t\t\t\tif (tempCol == col && ($(this).hasClass(\"google-visualization-orgchart-lineleft\") || $(this).hasClass(\"google-visualization-orgchart-lineright\"))) {\r\n\t\t\t\t\t\t\tif (parent == false) {\r\n\t\t\t\t\t\t\t\t// Stop looking cuz there is another node between us and parent\r\n\t\t\t\t\t\t\t\tbreaker = true;\r\n\t\t\t\t\t\t\t\tremoveModes($connecte, [ 'left', 'right' ]);\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t} else if (parent == true) {\r\n\t\t\t\t\t\t\t\t// Lets make sure there isnt a node between the parent and me\r\n\t\t\t\t\t\t\t\tremoveModes($connecte, [ 'left', 'right' ]);\r\n\r\n\t\t\t\t\t\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index) {\r\n\t\t\t\t\t\t\t\t\tif (index >= $connecte[0].cellIndex) {\r\n\t\t\t\t\t\t\t\t\t\t// there is a node after parent but before me\r\n\t\t\t\t\t\t\t\t\t\tremoveModes($(this), [ 'bottom' ]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tskip = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (breaker) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!skip) {\r\n\t\t\t\t\t\taddModes($(this), ['bottom'] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (var x in lines) {\r\n\t\t\tdrawNodeLine(lines[x][0], lines[x][1], lines[x][2].concat(['connection']), lines[x][3]);\r\n\t\t}\r\n\t};\r\n\r\n\tthis.collapseHandler = function() {\t\t\r\n\t\tif(_this.drawing) { return; }\r\n\t\t\r\n\t\tconst collapsed = _this.map.getCollapsedNodes();\r\n\t\tconst collapsedSystems = [];\r\n\t\tfor (x in collapsed) {\r\n\t\t\tvar systemID = $(\"#chainMap #node\"+(collapsed[x] +1)).data(\"nodeid\");\r\n\t\t\tcollapsedSystems.push(systemID);\r\n\t\t}\r\n\t\towner.updateCollapsed(collapsedSystems);\r\n\t\t\r\n\t\tif(_this.lastLineData) { updateLines(_this.lastLineData.map, _this.lastLineData.lines); }\r\n\t}\r\n\r\n\r\n};","const ChainMapRendererRadial = function(owner) {\r\n\tChainMapRendererBase.apply(this, arguments);\r\n\t\r\n\tconst CIRCLE_SIZE = { x: 70, y: 60, first_ring_delta: 0.3,\r\n\t\tringX: function(ci) { return ci == 0 ? 0 : (ci + this.first_ring_delta) * this.x * options.chain.nodeSpacing.x},\r\n\t\tringY: function(ci) { return ci == 0 ? 0 : (ci + this.first_ring_delta) * this.y * options.chain.nodeSpacing.y},\r\n\t };\r\n\t\r\n\tthis.arcFactor = function(ci) { return ci / (ci + 1.0); }\r\n\t\r\n\tthis.skipLevels = function(ci, nodes, minRad, maxRad, parentCollapsed) { \r\n\t\tconst max_nodes_per_rad = 1.4;\r\n\t\tlet skipped = 0;\r\n\t\tif(ci > 0 && !parentCollapsed) {\r\n\t\t\twhile(nodes.length > max_nodes_per_rad * ci * (maxRad - minRad) && ++skipped < 1) { }\r\n\t\t}\r\n\t\treturn skipped; \r\n\t}\r\n\t\r\n\tthis.setPosition = function(node, ci, rad_centre) {\r\n\t\tnode.radPosition = { r: ci, theta: rad_centre };\r\n\t\tnode.position = radToCartesian(node.radPosition);\t\t\r\n\t}\r\n\t\r\n\tthis.drawConnection = function(ctx, node) {\r\n\t\tconst cp1 = radToCartesian({ r: node.radPosition.r - 0.5, theta: (node.radPosition.theta + 2 * node.parent.radPosition.theta) / 3.0 });\r\n\t\tconst cp2 = radToCartesian({ r: node.radPosition.r - 0.5, theta: (2 * node.radPosition.theta + node.parent.radPosition.theta) / 3.0 });\r\n\t\t\r\n\t\tif(node.circle > 1) {\t\t\t\t\r\n\t\t\tctx.bezierCurveTo(cp2.x, cp2.y, cp1.x, cp1.y, node.parent.position.x, node.parent.position.y);\r\n\t\t} else {\r\n\t\t\tctx.lineTo(node.parent.position.x, node.parent.position.y);\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.adjustAlignmentDelta = function(ci, rad_centre) {\r\n\t\treturn ci == 1 ? -rad_centre\t// First node on first ring should be axis aligned\r\n\t\t: 0;\r\n\t}\r\n\t\r\n\tthis.drawGridlines = function(ctx, ci) {\r\n\t\tctx.beginPath();\r\n\t\tif(ctx.ellipse) {\r\n\t\t\tctx.lineWidth = 0.5;\r\n\t\t\tctx.setLineDash([]);\r\n\t\t\tctx.ellipse(0, 0, CIRCLE_SIZE.ringX(ci), CIRCLE_SIZE.ringY(ci), 0, 0, Math.PI * 2);\r\n\t\t}\r\n\t\tctx.strokeStyle = propertyFromCssClass('grid-default', 'color');\r\n\t\tctx.stroke();\t\t\r\n\t}\t\t\r\n\t\r\n\tfunction radToCartesian(rad) {\r\n\t\treturn { \r\n\t\t\tx: CIRCLE_SIZE.ringX(rad.r) * Math.sin(rad.theta), \r\n\t\t\ty: CIRCLE_SIZE.ringY(rad.r) * Math.cos(rad.theta)\r\n\t\t};\r\n\r\n\t}\r\n};\r\n\r\nChainMapRendererRadial.prototype = new ChainMapRendererBase();","var chain = new function() {\r\n\tvar chain = this;\r\n\tthis.map, this.view, this.drawing, this.data = {};\r\n\t\r\n\t// Third party suppliers should have:\r\n\t//  findLinks(systemId, ids) - Find links from the given system coming from the third party. ids contain a parent and a child ID; the child ID should be incremented for every new connection\r\n\t\r\n\tthirdPartySuppliers = [ eveScout ];\r\n\r\n\t// Renderer should have:\r\n\t//  ready() - Whether the renderer is initialised and can accept draw calls\r\n\t// switchTo() - Make this renderer active. The renderer can be in a blank state; draw() will be called after\r\n\t// switchFrom() - Switch away from this renderer. All node divs should be removed from the DOM, other items can be removed or made invisible\r\n\t// draw(map, lines, collapsedSystems) - Redraw the map, based on the given node set, line overrides and list of collapsed systems \r\n\t// collapse(systemID, toggle) - marks the system as collapsed/not collapsed\r\n\t// If the renderer allows collapsing of nodes then it will call updateCollapsed on the owner (the chain) with a list of collapsed systems in the current tab\r\n\t\r\n\tconst renderers = { \r\n\t\torgChart: new ChainMapRendererOrgchart(this),\r\n\t\torgChartTop: new ChainMapRendererOrgchartTop(this),\r\n\t\torgChartSide: new ChainMapRendererOrgchartSide(this),\r\n\t\tradial: new ChainMapRendererRadial(this)\r\n\t};\r\n\t\r\n\tthis.renderer = renderers[options.chain.renderer];\r\n\tthis.renderer.switchTo();\r\n\t\r\n\tthis.useRenderer = function(name) {\r\n\t\tif(!renderers[name]) { throw 'Unknown renderer ' + name; }\r\n\t\tif(chain.renderer != renderers[name]) {\r\n\t\t\tchain.renderer.switchFrom();\r\n\t\t\tchain.renderer = renderers[name];\r\n\t\t\tchain.renderer.switchTo();\r\n\t\t\tchain.redraw();\r\n\t\t}\r\n\t}\r\n\r\n\tthis.activity = function(data) {\r\n\t\t/*\tfunction for adding recent activity to chain map nodes\t*/\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.activity;\r\n\r\n\t\t// Hide all activity colored dots instead of checking each one\r\n\t\tvar elements = document.querySelectorAll(\"#chainMap .nodeActivity span\");\r\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\r\n\t\t   elements[i].className = elements[i].className + \" invisible\";\r\n\t\t}\r\n\r\n\t\t// Loop through passed data and show dots by system\r\n\t\tvar elements = document.querySelectorAll(\"#chainMap [data-nodeid]\");\r\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\r\n\t\t   var systemID = elements[i].getAttribute(\"data-nodeid\");\r\n\t\t   if (data[systemID]) {\r\n\t\t\t   var shipJumps = data[systemID].shipJumps;\r\n\t\t\t   var podKills = data[systemID].podKills;\r\n\t\t\t   var shipKills = data[systemID].shipKills;\r\n\t\t\t   var npcKills = data[systemID].npcKills;\r\n\t\t\t   var node = elements[i].getElementsByClassName(\"nodeActivity\")[0];\r\n\r\n\t\t\t   if (shipJumps > 0) {\r\n\t\t\t\t   var jumps = node.getElementsByClassName(\"jumps\")[0];\r\n\t\t\t\t   jumps.className = jumps.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   jumps.setAttribute(\"data-tooltip\", shipJumps + \" Jumps\");\r\n\t\t\t   }\r\n\r\n\t\t\t   if (podKills > 0) {\r\n\t\t\t\t   var pods = node.getElementsByClassName(\"pods\")[0];\r\n\t\t\t\t   pods.className = pods.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   pods.setAttribute(\"data-tooltip\", podKills + \" Pod Kills\");\r\n\t\t\t   }\r\n\r\n\t\t\t   if (shipKills > 0) {\r\n\t\t\t\t   var ships = node.getElementsByClassName(\"ships\")[0];\r\n\t\t\t\t   ships.className = ships.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   ships.setAttribute(\"data-tooltip\", shipKills + \" Ship Kills\");\r\n\t\t\t   }\r\n\r\n\t\t\t   if (npcKills > 0) {\r\n\t\t\t\t   var npcs = node.getElementsByClassName(\"npcs\")[0];\r\n\t\t\t\t   npcs.className = npcs.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   npcs.setAttribute(\"data-tooltip\", npcKills + \" NPC Kills\");\r\n\t\t\t   }\r\n\t\t   }\r\n\t\t}\r\n\r\n\t\tif (SystemActivityToolTips.attachedElements && SystemActivityToolTips.attachedElements.length > 0) {\r\n\t\t\tSystemActivityToolTips.detach($(\"#chainMap .whEffect\"));\r\n\t\t}\r\n\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeActivity > span[data-tooltip]:not(.invisible)\"));\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.occupied = function(data) {\r\n\t\t/*\tfunction for showing occupied icon  */\r\n\r\n\t\t// Hide all icons instead of checking each one\r\n\t\t$(\"#chainMap [data-icon='user'], #chainMap [data-icon='user'] + .badge\").addClass(\"invisible\");\r\n\r\n\t\t// Loop through passed data and show icons\r\n\t\tfor (var x in data) {\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user']\").removeClass(\"invisible\");\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user'] + .badge\").removeClass(\"invisible\").html(data[x].count);\r\n\t\t}\r\n\r\n\t\tOccupiedToolTips.attach($(\"#chainMap [data-icon='user']:not(.invisible)\"));\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.flares = function(data) {\r\n\t\t/*\tfunction for coloring chain map nodes via flares  */\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.flares;\r\n\r\n\t\t// Remove all current node coloring instead of checking each one\r\n\t\t$(\"#chainMap div.node\").removeClass(\"redNode yellowNode greenNode\");\r\n\r\n\t\t// Remove all coloring from chain grid\r\n\t\t$(\"#chainGrid tr\").removeClass(\"red yellow green\");\r\n\r\n\t\t// Loop through passed data and add classes by system\r\n\t\tif (data) {\r\n\t\t\tfor (var x in data.flares) {\r\n\t\t\t\tvar systemID = data.flares[x].systemID;\r\n\t\t\t\tvar flare = data.flares[x].flare;\r\n\r\n\t\t\t\tvar row = ($(\"#chainMap [data-nodeid=\"+systemID+\"]\").addClass(flare+\"Node\").parent().index() - 1) / 3 * 2;\r\n\r\n\t\t\t\tif (row > 0) {\r\n\t\t\t\t\t$(\"#chainGrid tr:eq(\"+row+\")\").addClass(flare).next().addClass(flare);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.grid = function() {\r\n\t\t/*  function for showing/hiding grid lines  */\r\n\t\t// This is an optional feature\r\n\t\tif (options.chain.gridlines == false) {\r\n\t\t\t$(\"#chainGrid tr\").addClass(\"hidden\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t$(\"#chainGrid tr\").removeClass(\"hidden\");\r\n\t\t//$(\"#chainGrid\").css(\"width\", \"100%\");\r\n\r\n\t\t// Calculate how many rows have systems, max 0 hack to prevent negative numbers, and rows above this number get hidden\r\n\t\tvar rows = Math.max(0, $(\".google-visualization-orgchart-table tr:has(.node)\").length * 2 - 1);\r\n\t\t$(\"#chainGrid tr:gt(\"+rows+\")\").addClass(\"hidden\");\r\n\t}\r\n\r\n\tthis.nodes = function(map) {\r\n\t\tvar chain = {cols: [{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}], rows: []};\r\n\t\tvar frigTypes = [\"Q003\", \"E004\", \"L005\", \"Z006\", \"M001\", \"C008\", \"G008\", \"A009\", \"SML\" ];\r\n\t\tvar connections = [];\r\n\t\tvar chainMap = this;\r\n\r\n\t\tfunction formatStatics(statics) {\r\n\t\t\tif(!statics) { return ''; }\r\n\t\t\telse if(statics.length > 4) { return '<span class=\"multi-static\">+</span>'; }\r\n\t\t\t\r\n\t\t\tconst shortCodeMap = { 'High-Sec': 'H', 'Low-Sec': 'L', 'Null-Sec': 'N', 'Triglavian':'▼',\r\n\t\t\t\t'Class-1': '1', 'Class-2': '2', 'Class-3': '3', 'Class-4': '4', 'Class-5' : 5, 'Class-6': 6\r\n\t\t\t};\r\n\t\t\tconst classMap = { H: 'hisec', L: 'lowsec', N: 'nullsec', '▼': 'triglavian' };\r\n\t\t\treturn statics.map(function(s) {\r\n\t\t\t\tconst text = shortCodeMap[appData.wormholes[s].leadsTo];\r\n\t\t\t\tconst className = classMap[text] || 'class-' +  text;\r\n\t\t\t\tconst tip = appData.wormholes[s].leadsTo + ' via ' + s;\r\n\t\t\t\treturn '<span class=\"' + className + '\" data-tooltip=\"' + tip + '\">' + text + '</span>';\r\n\t\t\t}).join('');\r\n\t\t}\r\n\r\n\t\tfunction topLevel(systemID, id) {\r\n\t\t\tif (!systemID || !tripwire.systems[systemID])\r\n\t\t\t\treturn false;\r\n\t\t\tconst tab = options.chain.tabs[options.chain.active];\r\n\t\t\tconst tabName = tab && tab.systemID != 0 && 0 > tab.systemID.indexOf(',') ? options.chain.tabs[options.chain.active].name : undefined;\r\n\t\t\treturn makeSystemNode(systemID, id, null, null, tabName, '&nbsp;', ['top-level']);\r\n\t\t}\r\n\r\n\t\tfunction makeSystemNode(systemID, id, whId, inSigId, systemName, nodeTypeMarkup, additionalClasses) {\r\n\t\t\t// System type switch\r\n\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\tvar systemType = \"<span class='\" + system.systemTypeClass + \"'>\" + system.systemTypeName + system.systemTypeModifiers.join('') + \"</span>\";\r\n\t\t\t\r\n\t\t\tsystemName = _.escape(systemName);\r\n\t\t\tconst systemNameText = \r\n\t\t\t\toptions.chain.sigNameLocation == 'name' ? (systemName ? systemName : system.name ? system.name : '&nbsp;') :\r\n\t\t\t\toptions.chain.sigNameLocation == 'name_prefix' ?\r\n\t\t\t\t\t(systemName ? systemName + (system.name ? ' - ' + system.name : '') : (system.name ? system.name : '&nbsp;')) :\r\n\t\t\t\t(system.name ? system.name : '&nbsp;');\t\r\n\r\n\t\t\tvar node = {v: id, systemID: systemID };\r\n\t\t\tvar chainNode = \"<div id='node\"+id+\"' data-nodeid='\"+systemID+\"'\"\r\n\t\t\t\t+(whId ? \" data-sigid='\"+whId+\"'\" : '')\r\n\t\t\t\t+(inSigId ? \" data-inSigid='\"+inSigId+\"'\" : '')\r\n\t\t\t\t+\" class='node \" + ((additionalClasses || []).join(' ')) + \"'>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\r\n\t\t\t\t\t\t\t+ systemRendering.renderEffect(system, 'i')\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge invisible'></span>\"\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+systemType+\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\r\n\t\t\t\t\t\t\t+\t\t(system.name ? \"<a href='.?system=\"+system.name+\"'>\"+systemNameText+\"</a>\" : systemNameText)\r\n\t\t\t\t\t\t\t+\t\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeType'>\" + nodeTypeMarkup + \"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='statics'>\"\r\n\t\t\t\t\t\t\t+ formatStatics(system.name ? system.statics : [])\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\"</div>\";\r\n\r\n\t\t\tnode.f = chainNode;\r\n\r\n\t\t\treturn node;\r\n\t\t}\r\n\t\t\r\n\t\tfunction makeCalcChildNode(childID, node, targetSystem) {\r\n\t\t\tvar path = guidance.findShortestPath(tripwire.map.shortest, targetSystem - 30000000, node.child.systemID - 30000000);\r\n\t\t\tif(!path) { return null; }\r\n\t\t\t\r\n\t\t\tvar calcNode = { calculated: true};\r\n\t\t\tcalcNode.life = \"Gate\";\r\n\t\t\tcalcNode.parent = {};\r\n\t\t\tcalcNode.parent.id = node.child.id;\r\n\t\t\tcalcNode.parent.systemID = node.child.systemID;\r\n\t\t\tcalcNode.parent.name = node.child.name;\r\n\t\t\tcalcNode.parent.type = node.child.type;\r\n\t\t\tcalcNode.parent.nth = node.child.nth;\r\n\r\n\t\t\tcalcNode.child = {};\r\n\t\t\tcalcNode.child.id = ++childID;\r\n\t\t\tcalcNode.child.systemID = targetSystem;\r\n\t\t\tcalcNode.child.name = tripwire.systems[targetSystem].name;\r\n\t\t\tcalcNode.child.path = path;\r\n\t\t\tcalcNode.child.jumps = path.length - 1;\r\n\t\t\tcalcNode.child.nth = null;\t\t\t\r\n\t\t\t\r\n\t\t\treturn { childID, calcNode };\r\n\t\t}\r\n\r\n\t\tfunction findLinks(system) {\r\n\t\t\tif (system[0] <= 0) return false;\r\n\r\n\t\t\tvar parentID = parseInt(system[1]), childID = chainList.length;\r\n\t\t\tconst connectedTo = [];\t// Local cache, in addition to usedLinks, for extra link sources\r\n\r\n\t\t\t/** Add the 'current' and 'favourite' calculated nodes if appropriate */\r\n\t\t\tconst addCalcChildNodes = function(node) {\r\n\t\t\t\tif ($(\"#show-viewing\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[viewingSystemID].class && !tripwire.systems[node.child.systemID].class && viewingSystemID != node.child.systemID ) {\r\n\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, viewingSystemID);\r\n\t\t\t\t\tif(calcNode) {\r\n\t\t\t\t\t\tchildID = calcNode.childID;\r\n\r\n\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\r\n\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($(\"#show-favorite\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[node.child.systemID].class) {\r\n\t\t\t\t\tfor (var x in options.favorites) {\r\n\t\t\t\t\t\tif (tripwire.systems[options.favorites[x]].regionID >= 11000000 || tripwire.systems[node.child.systemID].regionID >= 11000000 || options.favorites[x] == node.child.systemID)\r\n\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, options.favorites[x]);\r\n\t\t\t\t\t\tif(calcNode) {\r\n\t\t\t\t\t\t\tchildID = calcNode.childID;\r\n\r\n\t\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\r\n\t\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tfor (var x in chainData) {\r\n\t\t\t\tvar wormhole = chainData[x];\t\t\t\t\r\n\t\t\t\tif ($.inArray(wormhole.id, usedLinks) == -1) {\r\n\t\t\t\t\tvar sig1, sig2, sig1Type, sig2Type,\r\n\t\t\t\t\t\tparent, child, parentType, childType;\r\n\t\t\t\t\tif (wormhole.parent == \"secondary\") {\r\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.secondaryID];\r\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.secondaryID];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsig1Type = wormhole.type; sig2Type = 'K162';\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (sig1 && sig1.systemID == system[0]) {\r\n\t\t\t\t\t\tparent = sig1; child = sig2;\r\n\t\t\t\t\t\tparentType = sig2Type; childType = sig1Type;\r\n\t\t\t\t\t} else if(sig2 && sig2.systemID == system[0]) {\r\n\t\t\t\t\t\tparent = sig2; child = sig1;\r\n\t\t\t\t\t\tchildType = sig2Type; parentType = sig1Type;\r\n\t\t\t\t\t} else { continue; }\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar node = {};\r\n\t\t\t\t\tnode.id = wormhole.id;\r\n\t\t\t\t\tnode.life = wormhole.life;\r\n\t\t\t\t\tnode.mass = wormhole.mass;\r\n\t\t\t\t\tnode.time = parent.modifiedTime;\r\n\r\n\t\t\t\t\tnode.parent = {};\r\n\t\t\t\t\tnode.parent.id = parentID;\r\n\t\t\t\t\tnode.parent.systemID = tripwire.systems[parent.systemID] ? parent.systemID : parent.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\r\n\t\t\t\t\tnode.parent.name = child.name;\r\n\t\t\t\t\tnode.parent.type = parentType;\r\n\t\t\t\t\tnode.parent.nth = null;\r\n\t\t\t\t\tnode.parent.signatureID = child.signatureID;\r\n\t\t\t\t\tnode.parent.sigIndex = child.id;\r\n\r\n\t\t\t\t\tnode.child = {};\r\n\t\t\t\t\tnode.child.id = ++childID;\r\n\t\t\t\t\tnode.child.systemID = tripwire.systems[child.systemID] ? child.systemID : child.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\r\n\t\t\t\t\tnode.child.name = parent.name;\r\n\t\t\t\t\tnode.child.type = childType;\r\n\t\t\t\t\tnode.child.nth = null;\r\n\t\t\t\t\tnode.child.signatureID = parent.signatureID;\r\n\t\t\t\t\tnode.child.sigIndex = parent.id;\r\n\r\n\t\t\t\t\tchainLinks.push(node);\r\n\t\t\t\t\tchainList.push([node.child.systemID, node.child.id, system[2]]);\r\n\t\t\t\t\tusedLinks.push(node.id);\r\n\t\t\t\t\tif(tripwire.systems[child.systemID]) { connectedTo.push(1 * child.systemID); }\t// cast to number - sigs have the system as a string\r\n\t\t\t\t\t// usedLinks[system[2]].push(node.id);\r\n\t\t\t\t\t\r\n\t\t\t\t\taddCalcChildNodes(node);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthirdPartySuppliers.forEach(function(supplier) {\t\t\t\t\r\n\t\t\t\tconst ids = { parentID: parentID, nextChildID: ++childID };\r\n\t\t\t\tconst supplierNodes = supplier.findLinks(1 * system[0], ids);\r\n\t\t\t\tif(!supplierNodes) { return; }\r\n\t\t\t\tchildID = ids.nextChildID - 1;\r\n\r\n\t\t\t\tfor(var ti = 0; ti < supplierNodes.length; ti++) {\r\n\t\t\t\t\tvar supplierNode = supplierNodes[ti];\r\n\t\t\t\t\tif(0 > usedLinks.indexOf(supplierNode.id)) {\r\n\t\t\t\t\t\tif(0 > connectedTo.indexOf(supplierNode.child.systemID)) { // not in our map already\r\n\t\t\t\t\t\t\tsupplierNode.thirdParty = supplier.nodeNameSuffix;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tchainLinks.push(supplierNode);\r\n\t\t\t\t\t\t\tchainList.push([supplierNode.child.systemID, supplierNode.child.id, system[2]]);\r\n\t\t\t\t\t\t\tconnectedTo.push(supplierNode.child.systemID);\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\taddCalcChildNodes(supplierNode);\t\t\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Always want to do this, even if we didn't add it, because in that case the link is overridden by one on this mask, so it is 'used' even if not made visible\r\n\t\t\t\t\t\tusedLinks.push(supplierNode.id);\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tif ($(\"#chainTabs .current\").length > 0) {\r\n\t\t\tvar systems = $(\"#chainTabs .current .name\").data(\"tab\").toString().split(\",\");\r\n\t\t\tvar chainList = [];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tif (systems == 0) {\r\n                                let i = 0;\r\n                                Object.keys(map).slice()/*.reverse()*/.forEach(x => {\r\n\t\t\t\t        const parent = tripwire.client.signatures[map[x].initialID];\r\n\t\t\t\t        const child = tripwire.client.signatures[map[x].secondaryID];\r\n                                        if (parent && tripwire.systems[parent.systemID] && typeof(tripwire.systems[parent.systemID].class) == \"undefined\") {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t// usedLinks[parent.systemID] = [];\r\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(parent.systemID, i), {v: null}]});\r\n\t\t\t\t\t\tchainList.push([parent.systemID, i, parent.systemID]);\r\n                                        } else if (child && tripwire.systems[child.systemID] && typeof(tripwire.systems[child.systemID].class) == \"undefined\") {\r\n\t\t\t\t  \t        i++;\r\n\t\t\t\t  \t\t// usedLinks[child.systemID] = [];\r\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(child.systemID, i), {v: null}]});\r\n\t\t\t\t\t\tchainList.push([child.systemID, i, child.systemID]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tfor (var x in systems) {\r\n\t\t\t\t\t// usedLinks[systems[x]] = [];\r\n\t\t\t\t\tchain.rows.push({c: [topLevel(systems[x], parseInt(x) + 1), {v: null}]});\r\n\t\t\t\t\tchainList.push([systems[x], parseInt(x) + 1, systems[x]]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; i++) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t$(\"#chainError\").hide();\r\n\r\n\t\t\tvar row = {c: []};\r\n\t\t\tvar systemID = viewingSystemID;\r\n\r\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\r\n\r\n\t\t\tchain.rows.push(row);\r\n\r\n\t\t\tvar chainList = [[systemID, 1]];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst systemsInChainMap = {};\r\n\t\t\r\n\t\tfor (var x in chainLinks) {\r\n\t\t\tvar node = chainLinks[x];\r\n\t\t\tvar row = {c: []};\r\n\t\t\t\r\n\t\t\tconst sigText = options.chain[\"node-reference\"] == \"id\" ? (node.child.signatureID ? node.child.signatureID.substring(0, 3) : \"???\") :\r\n\t\t\t\t\t(node.child.type || \"(?)\");\r\n\t\t\tconst nodeTypeMarkup = node.child.path ? \r\n\t\t\t\tsystemRendering.renderPath(node.child.path) :\r\n\t\t\t\t(node.child.sigIndex ? \"<a href='#' onclick='sigDialog.openSignatureDialog({data: { signature: \" + node.child.sigIndex + \", mode: \\\"update\\\" }}); return false;'>\" : '') + _.escape(\r\n\t\t\t\t\tnode.child.name && options.chain.sigNameLocation == 'ref' ? node.child.name :\r\n\t\t\t\t\tnode.child.name && options.chain.sigNameLocation == 'ref_prefix' ? node.child.name + ' - ' + sigText :\r\n\t\t\t\t\tsigText\r\n\t\t\t\t) + (node.child.sigIndex ? '</a>' : '');\r\n\t\t\tconst additionalClasses = node.calculated ? ['calc'] : systemsInChainMap[node.child.systemID] ? [ 'loop' ] : [];\r\n\t\t\tif(node.thirdParty) { additionalClasses.push('third-party', 'third-party-' + node.thirdParty); }\r\n\r\n\t\t\t// Connection modifiers\r\n\t\t\tvar modifiers = [];\t\t\t\r\n\t\t\tif (node.life == \"critical\") { modifiers.push('eol'); }\r\n\t\t\tif (node.mass == \"critical\") { modifiers.push('critical'); }\r\n\t\t\telse if (node.mass == \"destab\") { modifiers.push('destab'); }\r\n\t\t\t\r\n\t\t\tconst connectionWormhole = wormholeAnalysis.wormholeFromTypePair(node.parent.type, node.child.type) || \r\n\t\t\t\twormholeAnalysis.likelyWormhole(node.parent.systemID, node.child.systemID);\r\n\t\t\tif(connectionWormhole.jump) { \r\n\t\t\t\tmodifiers.push('jm-' + (connectionWormhole.jump / 1e6) + 'kt'); \r\n\t\t\t\tif(connectionWormhole.jump == 5000000) { modifiers.push('frig'); }\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst parentModifiers = (systemsInChainMap[node.parent.systemID] || { chainModifiers:[]}).chainModifiers;\r\n\t\t\trow.chainModifiers = modifiers.concat(parentModifiers.filter(function(p) { return modifiers.indexOf(p) < 0; }));\r\n\t\t\t\r\n\t\t\trow.chainModifiers.forEach(function(cm) { modifiers.push(cm + '-chain')});\r\n\t\t\t\r\n\t\t\t// Update result set (rows/connections)\r\n\t\t\tconst child = makeSystemNode(node.child.systemID, node.child.id, node.id, node.child.sigIndex, node.child.name, nodeTypeMarkup, additionalClasses.concat(modifiers));\r\n\r\n\t\t\tvar parent = {v: node.parent.id};\r\n\r\n\t\t\trow.c.push(child, parent);\r\n\t\t\tchain.rows.push(row);\r\n\t\t\tconnections.push(Array(child.v, parent.v, modifiers, node.id));\r\n\t\t\t\r\n\t\t\tconst parentPathHome = (systemsInChainMap[node.parent.systemID] || { pathHome:[]}).pathHome;\r\n\t\t\trow.pathHome = parentPathHome.concat(node.child);\r\n\t\t\t\r\n\t\t\tif(!node.calculated) { \r\n\t\t\t\tsystemsInChainMap[node.child.systemID] = row; // store for loops/chain modifiers\r\n\t\t\t}\t\r\n\t\t}\r\n\r\n\t\t// Apply critical/destab line colors\r\n\t\tconnections.reverse(); // so we apply to outer systems first\r\n\r\n\t\tconst exits = Object.keys(systemsInChainMap).filter(function(x) { return x < 31000000; });\r\n\t\treturn {map: chain, lines: connections, systemsInChainMap: systemsInChainMap, exits: exits};\r\n\t}\r\n\r\n\r\n\tthis.setActiveTab = function(newIndex) {\r\n\t\t$(\"#chainTabs .tab\").removeClass(\"current\");\r\n\t\toptions.chain.active = newIndex;\r\n\t\tif(newIndex != null) {\r\n\t\t\t$(\"#chainTabs .tab\").eq(newIndex).addClass('current');\r\n\t\t}\r\n\t\t\r\n\t\toptions.save();\r\n\t\tchain.redraw();\r\n\t\ttripwire.parse(tripwire.client, \"refresh\");\r\n\t}\r\n\r\n\tthis.redraw = function() {\r\n\t\tthis.useRenderer(options.chain.renderer);\r\n\t\t\r\n\t\tvar data = $.extend(true, {}, this.data);\r\n\t\tdata.map = $.extend(true, {}, data.rawMap);\r\n\r\n\t\tthis.draw(data);\r\n\t}\r\n\t\r\n\tvar drawRetryTimer = null;\r\n\r\n\tthis.draw = function(data) {\r\n\t\tvar data = typeof(data) !== \"undefined\" ? data : {};\r\n\t\tclearTimeout(drawRetryTimer);\r\n\r\n\t\t// We need to make sure Google chart is ready and we have signature data for this system before we begin, otherwise delay\r\n\t\tif (!this.renderer.ready() || (Object.keys(data.map||{}).length && !tripwire.client.signatures)) {\r\n\t\t\tdrawRetryTimer = setTimeout(function() { chain.draw(data) }, 100);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (data.map) {\r\n\t\t\tthis.drawing = true;\r\n\r\n\t\t\tthis.data.rawMap = $.extend(true, {}, data.map);\r\n\r\n\t\t\t// if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout == false)) {\r\n\t\t\t// \tif (options.masks.active != \"273.0\") {\r\n\t\t\t// \t\tfor (var i in data.map) {\r\n\t\t\t// \t\t\tif (data.map[i].mask == \"273.0\") {\r\n\t\t\t// \t\t\t\tdelete data.map[i];\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\r\n\t\t\t// Sort so we keep the chain map order the same\r\n\t\t\tObject.sort(data.map, \"id\");\r\n\r\n\t\t\t$.extend(data, this.nodes(data.map)); // 250ms -> <100ms\r\n\t\t\t$.extend(this.data, data);\r\n\t\t\t\r\n\t\t\tconst collapsedSystems = options.chain.tabs[options.chain.active] ? (options.chain.tabs[options.chain.active].collapsed || []) : [];\r\n\r\n\t\t\tthis.renderer.draw(data.map, data.lines, collapsedSystems); // 150ms\r\n\t\t\t//this.map.draw(this.newView(data.map), this.options); // 150ms\r\n\r\n//\t\t\tthis.renderer.lines(data); // 300ms\r\n\t\t\tthis.grid(); // 4ms\r\n\r\n\t\t\t// Apply current system style\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\"); // 0.1ms\r\n\r\n\t\t\t// Remove old system effect tooltips and add current ones\r\n\t\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\r\n\t\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\r\n\t\t\t}\r\n\t\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\")); // 0.30ms\r\n\t\t\tWormholeRouteToolTips.attach($(\"#chainMap .path span[data-tooltip]\"));\r\n\t\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeClass span[data-tooltip]\"));\r\n\t\t\t\r\n\t\t\tthis.drawing = false;\r\n\t\t\t\r\n\t\t\tsystemPanel.update();\r\n\t\t}\r\n\r\n\t\t// Gather latest system activity\r\n\t\tif (!this.data.activity || new Date() > this.data.activity.expires) {\r\n\t\t\tdata.activity = {};\r\n\t\t\ttripwire.esi.universeJumps()\r\n\t\t\t\t.done(function(results, status, request) {\r\n\t\t\t\t\tdata.activity.expires = new Date(request.getResponseHeader(\"expires\"));\r\n\t\t\t\t\t$.each(results, function(x) {\r\n\t\t\t\t\t\tdata.activity[results[x].system_id] = {\r\n\t\t\t\t\t\t\tsystemID: results[x].system_id,\r\n\t\t\t\t\t\t\tshipJumps: results[x].ship_jumps\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.then(function() {\r\n\t\t\t\t\t return tripwire.esi.universeKills()\r\n\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t$.each(results, function(x) {\r\n\t\t\t\t\t\t\t\tif (data.activity[results[x].system_id]) {\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].podKills = results[x].pod_kills;\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].shipKills = results[x].ship_kills;\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].npcKills = results[x].npc_kills;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id] = {\r\n\t\t\t\t\t\t\t\t\t\tsystemID: results[x].system_id,\r\n\t\t\t\t\t\t\t\t\t\tpodKills: results[x].pod_kills,\r\n\t\t\t\t\t\t\t\t\t\tshipKills: results[x].ship_kills,\r\n\t\t\t\t\t\t\t\t\t\tnpcKills: results[x].npc_kills,\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.then(function() {\r\n\t\t\t\t\tchain.data.activity = chain.activity(data.activity);\r\n\t\t\t\t});\r\n\t\t} else if (data.map) {\r\n\t\t\tchain.activity(this.data.activity);\r\n\t\t}\r\n\r\n\t\tif (data.occupied) { // 3ms\r\n\t\t\tthis.data.occupied = this.occupied(data.occupied);\r\n\t\t}\r\n\r\n\t\tif (data.flares) { // 20ms\r\n\t\t\tthis.data.flares = this.flares(data.flares);\r\n\t\t}\r\n\t}\r\n\r\n\tthis.updateCollapsed = function(collapsedSystems) {\r\n\t\tif (options.chain.tabs[options.chain.active]) {\r\n\t\t\toptions.chain.tabs[options.chain.active].collapsed = collapsedSystems;\r\n\t\t}\r\n\t\t\r\n\t\t// Apply current system style\r\n\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\");\r\n\r\n\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\r\n\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\r\n\t\t}\r\n\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\"));\r\n\r\n\t\tchain.activity(chain.data.activity);\r\n\r\n\t\tchain.occupied(chain.data.occupied);\r\n\r\n\t\tchain.flares(chain.data.flares);\r\n\r\n\t\tchain.grid();\r\n\r\n\t\toptions.save();\r\n\t}\r\n\r\n}\r\n","var guidance_profiles = {\r\n\tblueLootSystems: [17,40,41,55,72,53,74,160,162,163,196,197,164,181,187,133,159,903,905,1002,1013,1021,1026,1032,1038,1045,1290,1359,1390,1361,1397,1395,1391,1676,1679,1677,1840,1842,1847,1848,1852,1854,1855,1858,1866,1868,1873,1874,1881,1883,1894,1896,1897,1901,1902,1907,1914,1918,1922,1931,1932,1938,1946,1951,1952,1958,1959,1961,1939,1978,2415,2418,2414,2558,2559,2560,2568,2569,2571,2572,2769,2815,2816,2771,2800,2975,2977,2980,2988,2993,2992,3017,3018,3024,3030,3048,3055,3025,3029,3053,3271,3275,3279,3280,3281,3283,3284,3287,3305,3307,3312,3317,3318,3321,3322,3324,3329,3333,3335,3338,3339,3342,3344,3361,3363,2058,2065,2067,3394,3404,3412,3447,3449,3467,3469,3389,3402,3413,3409,2059,2190,2252,3553,3554,3555,3556,2191,2193,2187,4077,4078,4079,4084,4111,4112,4114,4083,4239,4240,4241,4288,4291,4296,4621,4623,5010,5011,5020,5009,5018,5017,5030,5031,5034,5035,5039,5040,5043,5052,5054,5276,5275],\r\n\tchainExits: []\r\n}","const systemPanel = new function() {\r\n\tthis.update = function() {\r\n\t\t// Update dependent controls: Path to chain/home\r\n\t\tconst exits = chain.data.exits;\r\n\t\tvar html = [\r\n\t\t\trenderRoute((exits || []).map(function(x) { return x  - 30000000; }), true, 'chain', 'To chain'), \r\n\t\t\trenderRoute(guidance_profiles.blueLootSystems, false, 'blue-loot', 'Blue loot buyer')\r\n\t\t].filter(function(x) { return x; }).join('');\r\n\t\t$(\"#infoExtra\").html(html);\r\n\t\tTooltips.attach($(\"#infoExtra [data-tooltip]\"));\r\n\t};\r\n\t\r\n\tfunction renderRoute(targets, addPathHome, cssClass, categoryText) {\r\n\t\tconst path = targets ? guidance.findShortestPath(tripwire.map.shortest, viewingSystemID - 30000000, targets) : null;\r\n\t\tif(path) {\r\n\t\t\tconst inChain = path.length <= 1;\r\n\t\t\tconst exitSystem = path[path.length - 1] + 30000000;\r\n\t\t\tconst prefixText = inChain ? 'In chain: ' : (path.length - 1) + 'j from ' ;\r\n\t\t\tconst pathHomeText = addPathHome ? chain.data.systemsInChainMap[exitSystem].pathHome.slice().reverse()\r\n\t\t\t\t.map(function(n) { return '<a href=\".?system=' + tripwire.systems[n.systemID].name + '\">' + (n.name || tripwire.systems[n.systemID].name || '???') + '</a>'; })\r\n\t\t\t\t.join(' &gt; ') : '<a href=\".?system=' + tripwire.systems[exitSystem].name + '\">' + tripwire.systems[exitSystem].name + '</a>';\r\n\t\t\t\tconst pathToChainText = inChain ? '' : '<br/>' + systemRendering.renderPath(path.slice().reverse());\r\n\t\t\t\treturn '<div class=\"' + cssClass + '\">' + categoryText + ': ' + prefixText + pathHomeText + pathToChainText + '</div>';\r\n\t\t} else { return null; }\r\n\t}\r\n\r\n}();","tripwire.active = function(data) {\n    var editSigs = [];\n    var editComments = [];\n\n    for (var x in data) {\n        var activity = JSON.parse(data[x].activity);\n        editSigs.push(parseInt(activity.editSig));\n        editComments.push(parseInt(activity.editComment));\n\n        if (activity.editSig) {\n            $(\"#sigTable tr[data-id='\"+activity.editSig+\"']\")\n                //.attr('data-tooltip', sig.editing)\n                //.attr(\"title\", sig.editing)\n                .addClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#001b47\"}, 1000); //35240A - Yellow\n        }\n\n        if (activity.editComment && $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"'] .cke\").length > 0) {\n            $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"']\")\n                .addClass(\"editing\")\n                .find(\".commentStatus\").html(data[x].characterName + \" is editing\").fadeIn();\n        }\n    }\n\n    $(\"#sigTable tr.editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editSigs) == -1) {\n            $(\"#sigTable tr[data-id='\"+$(this).data(\"id\")+\"']\")\n                //.attr('data-tooltip', '')\n                //.removeAttr(\"title\")\n                .removeClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\n        }\n    });\n\n    $(\"#commentWrapper .editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editComments) == -1) {\n            $(\"#commentWrapper .editing[data-id='\"+$(this).data(\"id\")+\"']\")\n                .removeClass(\"editing\")\n                .find(\".commentStatus\").fadeOut(function() {$(this).html(\"\")});\n        }\n    });\n}\n","// Hanldes adding to Signatures section\r\n// ToDo: Use native JS\r\ntripwire.makeSigInfo = function(sig, wormhole) {\r\n\twormhole = wormhole ||\t// allow to be passed in to save this lookup\r\n\t\tObject.values(tripwire.client.wormholes).find(function (wh) { return wh.initialID == sig.id || wh.secondaryID == sig.id});\r\n\tif (!wormhole) return false;\r\n\tvar otherSignature = sig.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\tif (!otherSignature) return false;\r\n\r\n\tlet leadsTo;\r\n\tif (sig.name) {\r\n\t  leadsTo = tripwire.systems[otherSignature.systemID] ?\r\n\t\t\"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+_.escape(sig.name)+\"</a> &ndash; \" + systemRendering.renderSystem(systemAnalysis.analyse(otherSignature.systemID), 'a') : \r\n\t\t_.escape(sig.name);\r\n\t} else if (appData.genericSystemTypes[otherSignature.systemID]) {\r\n\t\tleadsTo = appData.genericSystemTypes[otherSignature.systemID];\r\n\t} else if (tripwire.systems[otherSignature.systemID]) {\r\n\t\tleadsTo = systemRendering.renderSystem(systemAnalysis.analyse(otherSignature.systemID), 'a');\r\n\t} else {\r\n\t\tleadsTo = \"\";\r\n\t}\r\n\r\n\tconst wormholeTypeText = wormhole.type || \"???\";\r\n\treturn {\r\n\t\tid: sig.id,\r\n\t\tleadsTo: leadsTo,\r\n\t\twormhole: wormhole,\r\n\t\tformattedType: (wormhole[wormhole.parent+\"ID\"] == sig.id ? wormholeTypeText : (wormhole.parent ? \"[\" + wormholeTypeText + \"]\" : \"\")),\r\n\t\tlifeText: { critical: 'EOL', stable: 'Stable' }[wormhole.life] || wormhole.life,\r\n\t}\r\n}\r\n\r\ntripwire.addSig = function(add, option, disabled) {\r\n    var option = option || {};\r\n    var animate = typeof(option.animate) !== 'undefined' ? option.animate : true;\r\n    var disabled = disabled || false;\r\n    var wormhole = {};\r\n\r\n\tconst returnLinkText = add.signatureID ? '<a class=\"return-link\" href=\"#\" onclick=\"tripwire.setReturnSig(event, ' + add.id + ')\">&gt;&gt; Set ' + \r\n\t\t\t\tadd.signatureID.substring(0, 3).toUpperCase() + '-' + add.signatureID.substring(3) +\r\n\t\t\t\t' as return</a>'\r\n\t\t\t\t: '';\r\n\r\n    if (add.type == \"wormhole\") {\r\n\t\tconst sigInfo = tripwire.makeSigInfo(add);\r\n\t\tif(!sigInfo) return false;\r\n\t\t\r\n\t\twormhole = sigInfo.wormhole;\r\n\t\t\r\n\t\tconst leadsToText = sigInfo.leadsTo ? sigInfo.leadsTo : \r\n\t\t\tadd.signatureID && add.signatureID.length && add.signatureID[0] != '?' ? returnLinkText\r\n\t\t\t: '';\t\r\n\r\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(add.signatureID)+\"</td>\"\r\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+sigInfo.formattedType+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+leadsToText+\"</td>\"\r\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+sigInfo.lifeText+\"</td>\"\r\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    } else {\r\n\t\tconst leadsToText = add.type === 'unknown' ? returnLinkText : \r\n\t\t\t(add.name ? linkSig(add.name) : '');\r\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(add.signatureID)+\"</td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+add.type+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+leadsToText+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    }\r\n\r\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\r\n\r\n    $(\"#sigTable\").append(tr);\r\n\r\n    // Add counter\r\n    if (wormhole.life == \"critical\") {\r\n        $(tr).find('span[data-age]').countdown({until: moment.utc(add.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\r\n            // .countdown('pause')\r\n            .addClass('critical')\r\n            // .countdown('resume');\r\n    } else {\r\n        $(tr).find('span[data-age]').countdown({since: moment.utc(add.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\r\n    }\r\n\r\n    if (animate) {\r\n        $(tr)\r\n            .find('td')\r\n            .wrapInner('<div class=\"hidden\" />')\r\n            .parent()\r\n            .find('td > div')\r\n            .slideDown(700, function(){\r\n                $set = $(this);\r\n                $set.replaceWith($set.contents());\r\n            });\r\n\r\n        $(tr).find(\"td\").animate({backgroundColor: \"#004D16\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\r\n    }\r\n}\r\n\r\ntripwire.setReturnSig = function(event, sigToRemoveId) {\r\n\tevent.preventDefault();\r\n\tconst sigToUpdate = tripwire.signatures.returnSig;\r\n\tconst sigToRemove = tripwire.client.signatures[sigToRemoveId];\r\n\t\r\n\tif(!(sigToUpdate && sigToRemove)) { return; }\r\n\t\r\n\tsigDialog.overwriteSignature(sigToRemoveId, function(data) {\r\n\t\tsigToUpdate.signatureID = sigToRemove.signatureID;\r\n\t\t// we need the wormhole part to make refresh.php not think the sig isn't a wormhole any more\r\n\t\tconst payload = {\"signatures\": {\"update\": [ { wormhole: 'dummy', signatures: [ sigToUpdate ] } ] }};\r\n\t\ttripwire.refresh('refresh', payload);\r\n\t});\r\n}","// Handles API updates\ntripwire.API = function() {\n    this.indicator;\n    this.APIrefresh;\n\n    this.API.expire = function() {\n        var options = {since: tripwire.API.APIrefresh, until: null, format: \"MS\", layout: \"-{mnn}{sep}{snn}\"};\n        $(\"#APItimer\").countdown(\"option\", options);\n    }\n\n    this.API.refresh = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: false,\n            dataType: \"JSON\",\n            data: \"indicator=\"+tripwire.API.indicator\n        }).done(function(data) {\n            if (data && data.APIrefresh) {\n                tripwire.API.indicator = data.indicator;\n                tripwire.API.APIrefresh = new Date(data.APIrefresh);\n                activity.refresh(); //Refresh graph\n\n                var options = {until: tripwire.API.APIrefresh, since: null, layout: \"{mnn}{sep}{snn}\"};\n                $(\"#APItimer\").countdown(\"option\", options);\n                setTimeout(\"tripwire.API.refresh();\", $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30);\n            } else if ($(\"#APItimer\").countdown(\"option\", \"layout\") !== \"-{mnn}{sep}{snn}\" && $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) > 120) {\n                setTimeout(\"tripwire.API.refresh();\", ($.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30) * 1000);\n            } else {\n                setTimeout(\"tripwire.API.refresh();\", 15000);\n            }\n        });\n    }\n\n    this.API.init = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: true,\n            dataType: \"JSON\",\n            data: \"init=true\"\n        }).done(function(data) {\n            tripwire.API.indicator = data.indicator;\n            tripwire.API.APIrefresh = new Date(data.APIrefresh);\n\n            $(\"#APItimer\").countdown({until: tripwire.API.APIrefresh, onExpiry: tripwire.API.expire, alwaysExpire: true, compact: true, format: \"MS\", serverSync: tripwire.serverTime.getTime, onTick: function(t) { $(\"#APIclock\").val(t[5] + 1).trigger(\"change\"); }})\n            var timer = $(\"#APItimer\").countdown(\"option\", \"layout\") === \"-{mnn}{sep}{snn}\" ? 15 : $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30;\n            setTimeout(\"tripwire.API.refresh();\", timer * 1000);\n        });\n    }\n\n    this.API.init();\n}\n// tripwire.API();\n","const automapState = {\r\n\tpendingDecision: false\r\n};\r\n\r\ntripwire.autoMapper = function(from, to) {\r\n\tconsole.log('Automapper: Jump from ' + from + ' to ' + to);\r\n\t\r\n    var pods = [33328, 670];\r\n    var undo = [];\r\n\r\n    // Make sure the automapper is turned on & not disabled\r\n    if (!$(\"#toggle-automapper\").hasClass(\"active\") || $(\"#toggle-automapper\").hasClass(\"disabled\"))\r\n        return false;\r\n\r\n\t// Not waiting on a decision for the previous jump\r\n\tif(automapState.pendingDecision) {\r\n\t\tconsole.info('Not automapping because there is an automap dialog up');\r\n\t\treturn false;\r\n\t}\r\n\r\n    // Make sure from and to are valid systems\r\n    if (!tripwire.systems[from] || !tripwire.systems[to])\r\n        return false;\r\n\r\n    // Make sure from and to are not the same system\r\n    if (from == to)\r\n        return false;\r\n\t\r\n\t// Not into a special region e.g. abyssal space\r\n\tif(tripwire.systems[from].regionID > 12000000 || tripwire.systems[to].regionID > 12000000) {\r\n\t\tconsole.info('Not automapping into abyssal or other special space');\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t// Not into a special system\r\n\tconst noMapSystems = [30000142, 30002187];\t// Jita/Amarr\r\n\tif(noMapSystems.indexOf(from) >= 0 || noMapSystems.indexOf(to) >= 0) {\t\r\n\t\tconsole.info('Not automapping into likely pod-out destination');\r\n\t\treturn false;\r\n\t}\r\n\r\n    // Is pilot in a station?\r\n    if (tripwire.client.EVE && tripwire.client.EVE.stationID) {\r\n\t\tconsole.log('Automapper: Not recording because you are in a station');\r\n        return false;\r\n\t}\r\n\t\r\n    // Is pilot in a pod?\r\n    if (tripwire.client.EVE && tripwire.client.EVE.shipTypeID && $.inArray(parseInt(tripwire.client.EVE.shipTypeID), pods) >= 0) {\r\n    \tconsole.log('Automapper: Not recording because you are in a pod');\r\n\t\treturn false;\r\n\t}\r\n\t\r\n    // Is this a gate?\r\n    if (typeof(tripwire.map.shortest[from - 30000000]) != \"undefined\" && typeof(tripwire.map.shortest[from - 30000000][to - 30000000]) != \"undefined\") {\r\n\t\tconsole.log('Automapper: Not recording because this jump is a stargate');\r\n        return false;\r\n\t}\r\n\r\n     // Is this an existing connection?\r\n     if ($.map(tripwire.client.wormholes,\r\n               function(wormhole) {\r\n                 const initial = tripwire.client.signatures[wormhole.initialID];\r\n                 const secondary = tripwire.client.signatures[wormhole.secondaryID];\r\n                 return initial && secondary &&\r\n                   ((initial.systemID == from && secondary.systemID == to) ||\r\n                    (initial.systemID == to && secondary.systemID == from))  ? wormhole : null;\r\n               }).length > 0) {\r\n\t\tconsole.log('Automapper: Not recording because the connection exists');\r\n       return false;\r\n     }\r\n\t \r\n\t // Are both systems already in chain? Loops do happen but it's much more likely ESI missed a jump\r\n\t function inChain(systemID) { return chain.data.map.rows.filter(r => r.c[0].systemID == systemID).length > 0; }\r\n\tif(inChain(from) && inChain(to)) {\r\n\t\tconsole.info('Not automapping because both systems are already in chain');\r\n\t\treturn false;\r\n\t}\t \r\n\r\n    var payload = {\"signatures\": {\"add\": [], \"update\": []}, \"automap\": { \"character\": tripwire.client.EVE.characterID } };\r\n\r\n    var wormholes = wormholesForJump(from, to, tripwire.client.wormholes, tripwire.client.signatures);\r\n\t\r\n    if (wormholes.length) {\r\n        if (wormholes.length > 1) {\r\n\t\t\tconsole.log('Automapper: Multiple sigs matched, asking which one to update');\r\n            $(\"#dialog-select-signature\").dialog({\r\n                autoOpen: true,\r\n                title: \"Which Signature?\",\r\n                width: 390,\r\n                buttons: {\r\n                    Cancel: function() {\r\n                        $(this).dialog(\"close\");\r\n                    },\r\n                    Ok: function() {\r\n                        var i = $(\"#dialog-select-signature [name=sig]:checked\").val();\r\n                        var wormhole = wormholes[i];\r\n                        var signature = tripwire.client.signatures[wormhole.initialID];\r\n                        var signature2 = tripwire.client.signatures[wormhole.secondaryID];\r\n\r\n                        payload.signatures.update.push({\r\n                            \"wormhole\": {\r\n                                \"id\": wormhole.id\r\n                            },\r\n                            \"signatures\": [\r\n                                {\r\n                                    \"id\": signature.id\r\n                                },\r\n                                {\r\n                                    \"id\": signature2.id,\r\n                                    \"systemID\": to\r\n                                }\r\n                            ]\r\n                        });\r\n\r\n                        var success = function(data) {\r\n                            if (data.resultSet && data.resultSet[0].result == true) {\r\n                                undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\r\n                                $(\"#dialog-select-signature\").dialog(\"close\");\r\n                            }\r\n                        }\r\n\r\n                        tripwire.refresh('refresh', payload, success);\r\n                    }\r\n                },\r\n                open: function() {\r\n\t\t\t\t\tautomapState.pendingDecision = true;\r\n                    $(\"#dialog-select-signature .optionsTable tbody\").empty();\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction formatSystem(systemID) {\r\n\t\t\t\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\t\t\t\treturn systemRendering.renderSystem(system);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tdocument.getElementById('select-sig-from').innerHTML = formatSystem(from);\r\n\t\t\t\t\tdocument.getElementById('select-sig-to').innerHTML = formatSystem(to);\r\n\r\n                    $.each(wormholes, function(i) {\r\n                        const signature = tripwire.client.signatures[wormholes[i].initialID];\r\n\t\t\t\t\t\tconst sigInfo = tripwire.makeSigInfo(signature, wormholes[i]);\r\n\t\t\t\t\t\t\r\n                        const tr = \"<tr>\"\r\n                          + \"<td><input type='radio' name='sig' value='\"+i+\"' id='sig\"+i+\"' /></td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign'>\" + formatSignatureID(signature.signatureID) + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign'>\" + sigInfo.formattedType + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign'>\" + sigInfo.leadsTo + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign \" + wormholes[i].life + \"'>\" + sigInfo.lifeText + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign \" + wormholes[i].mass + \"'>\" + wormholes[i].mass + \"</td>\"\r\n                          + \"</tr>\";\r\n\t\t\t\t\t\t  \r\n\t\t\t\t\t\tconst trElem = $(tr);\r\n                        $(trElem).find('td').wrapInner(\"<label for='sig\"+i+\"' />\");\r\n                        $(\"#dialog-select-signature .optionsTable tbody\").append(trElem);\r\n                    });\r\n                }, close: function() {\r\n\t\t\t\t\tautomapState.pendingDecision = false;\r\n\t\t\t\t}\r\n            });\r\n        } else {\r\n            var wormhole = wormholes[0];\r\n            var signature = tripwire.client.signatures[wormhole.initialID];\r\n            var signature2 = tripwire.client.signatures[wormhole.secondaryID];\r\n\t\t\tconsole.log('Automapper: Single signature: w=' + JSON.stringify(wormhole) + ' s1=' + signature.id + '/' + signature.signatureID + ' s2=' + signature2.id + '/' + signature2.signatureID );\r\n\r\n            payload.signatures.update.push({\r\n                \"wormhole\": {\r\n                    \"id\": wormhole.id\r\n                },\r\n                \"signatures\": [\r\n                    {\r\n                        \"id\": signature.id\r\n                    },\r\n                    {\r\n                        \"id\": signature2.id,\r\n                        \"systemID\": to\r\n                    }\r\n                ]\r\n            });\r\n            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\r\n        }\r\n    } else {\r\n        // Nothing matches, create a new wormhole\r\n\t\tconsole.log('Automapper: No signatures match, creating a new unknown hole');\r\n        payload.signatures.add.push({\r\n            \"wormhole\": {\r\n                \"type\": null,\r\n                \"parent\": \"initial\",\r\n                \"life\": \"stable\",\r\n                \"mass\": \"stable\"\r\n            },\r\n            \"signatures\": [\r\n                {\r\n                    \"systemID\": from,\r\n                    \"type\": \"wormhole\"\r\n                },\r\n                {\r\n                    \"systemID\": to,\r\n                    \"type\": \"wormhole\"\r\n                }\r\n            ]\r\n        });\r\n    }\r\n\r\n    if (payload.signatures.add.length || payload.signatures.update.length) {\r\n        var success = function(data) {\r\n            if (data.resultSet && data.resultSet[0].result == true) {\r\n                $(\"#undo\").removeClass(\"disabled\");\r\n\r\n                if (data.results) {\r\n                    if (viewingSystemID in tripwire.signatures.undo) {\r\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\r\n                    } else {\r\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\r\n                    }\r\n                }\r\n\r\n                if (undo.length) {\r\n                    if (viewingSystemID in tripwire.signatures.undo) {\r\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\r\n                    } else {\r\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\r\n                    }\r\n                }\r\n\r\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n            }\r\n        }\r\n\r\n        tripwire.refresh('refresh', payload, success);\r\n    }\r\n}\r\n\r\nfunction wormholesForJump(from, to, wormholes, signatures) {\r\n\tconst toSystem = systemAnalysis.analyse(to);\r\n    const toType = toSystem.genericSystemType[0];\r\n\tconst toClass = (toSystem.class || [])[0];\r\n\treturn Object.values(wormholes).filter(function(wormhole) {\r\n        if ( ( signatures[wormhole.initialID] !== undefined ) && ( signatures[wormhole.secondaryID] !== undefined ) ) {\r\n            // Find wormholes that have no set Leads To system, and their initial system is from the wormhole we just jumped from\r\n            if (signatures[wormhole.initialID].systemID == from && !appData.systems[signatures[wormhole.secondaryID].systemID]) {\r\n\t\t\t\tconst holeTargetTypeName = appData.genericSystemTypes[signatures[wormhole.secondaryID].systemID];\r\n\t\t\t\tconst holeClasses = systemAnalysis.classForTypeName(holeTargetTypeName);\r\n\t\t\t\tif(holeTargetTypeName === toType) {\r\n\t\t\t\t\t// Find wormholes where Leads To is the type we jumped into\r\n\t\t\t\t\treturn true;\r\n                } else if (holeClasses && 0 <= holeClasses.indexOf(toClass)) {\r\n                    // Find wormholes that Leads To is generically set to the class we just jumped into\r\n                    return true;\r\n                } else if (wormhole.type && appData.wormholes[wormhole.type] && appData.wormholes[wormhole.type].leadsTo == toType) {\r\n                    // Find wormholes that Type is known to lead to the class we just jumped into\r\n                    return true;\r\n                } else if (signatures[wormhole.secondaryID].systemID === null && (!wormhole.type || !appData.wormholes[wormhole.type])) {\r\n                    // Find wormholes that don't have a Type or any kind of Leads To entered\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\t","$(\"body\").on(\"dblclick\", \".comment\", function(e) {\r\n\te.preventDefault();\r\n\tdocument.getSelection().removeAllRanges();\r\n\t$(this).find(\".commentEdit\").click();\r\n})\r\n\r\n$(\"body\").on(\"click\", \".commentEdit\", function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Prevent multiple editors\r\n\tif ($(\".cke\").length) return false;\r\n\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\t$comment.find(\".commentToolbar\").hide();\r\n\r\n\tCKEDITOR.replace($comment.find(\".commentBody\").attr(\"id\"), CKConfig).on(\"instanceReady\", function() {\r\n\t\t$comment.find(\".commentStatus\").html(\"\");\r\n\t\t$comment.find(\".commentFooter\").show();\r\n\t\t$comment.find(\".commentFooter .commentControls\").show();\r\n\t});\r\n\r\n\ttripwire.activity.editComment = $comment.data(\"id\");\r\n\ttripwire.refresh('refresh');\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentSave, .commentCancel\", function(e) {\r\n\te.preventDefault();\r\n\tvar $this = $(this);\r\n\tif ($this.attr(\"disabled\")) return false;\r\n\r\n\tvar $comment = $this.closest(\".comment\");\r\n\t$this.attr(\"disabled\", \"true\");\r\n\r\n\tif ($this.hasClass(\"commentSave\")) {\r\n\t\tvar data = {\"mode\": \"save\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? 0 : viewingSystemID, \"comment\": CKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].getData()};\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: \"comments.php\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: data,\r\n\t\t\tdataType: \"JSON\"\r\n\t\t}).done(function(data) {\r\n\t\t\tif (data && data.result == true) {\r\n\t\t\t\t$comment.find(\".commentModified\").html(\"Edited by \" + data.comment.modifiedByName + \" at \" + data.comment.modifiedDate);\r\n\t\t\t\t$comment.find(\".commentCreated\").html(\"Posted by \" + data.comment.createdByName + \" at \" + data.comment.createdDate);\r\n\t\t\t\tTooltips.attach($comment.find(\"[data-tooltip]\"));\r\n\r\n\t\t\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(false);\r\n\t\t\t\t$comment.attr(\"data-id\", data.comment.id);\r\n\t\t\t\t$comment.find(\".commentToolbar\").show();\r\n\t\t\t\t$comment.find(\".commentFooter\").hide();\r\n\t\t\t\t$this.removeAttr(\"disabled\");\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(true);\r\n\r\n\t\tif (!$comment.attr(\"data-id\")) {\r\n\t\t\t$comment.remove();\r\n\t\t} else {\r\n\t\t\t$comment.find(\".commentToolbar\").show();\r\n\t\t\t$comment.find(\".commentFooter\").hide();\r\n\t\t\t$this.removeAttr(\"disabled\");\r\n\t\t}\r\n\t}\r\n\r\n\t$comment.find(\".commentStatus\").html(\"\");\r\n\r\n\tdelete tripwire.activity.editComment;\r\n\ttripwire.refresh('refresh');\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentDelete\", function(e) {\r\n\te.preventDefault();\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-deleteComment\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#notesWidget\")},\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tDelete: function() {\r\n\t\t\t\t\t// Prevent duplicate submitting\r\n\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"disable\");\r\n\r\n\t\t\t\t\tvar $comment = $(this).data(\"comment\");\r\n\t\t\t\t\tvar data = {\"mode\": \"delete\", \"commentID\": $comment.data(\"id\")};\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"comments.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: data,\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).done(function(data) {\r\n\t\t\t\t\t\tif (data && data.result == true) {\r\n\t\t\t\t\t\t\t$(\"#dialog-deleteComment\").dialog(\"close\");\r\n\t\t\t\t\t\t\t$comment.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"enable\");\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-deleteComment\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog(\"open\");\r\n\t}\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#add-comment\", function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Prevent multiple editors\r\n\tif ($(\".cke\").length) return false;\r\n\r\n\tvar $comment = $(\".comment:last\").clone();\r\n\tvar commentID = $(\".comment:visible:last .commentBody\").attr(\"id\") ? $(\".comment:visible:last .commentBody\").attr(\"id\").replace(\"comment\", \"\") + 1 : 0;\r\n\t$(\".comment:last\").before($comment);\r\n\r\n\t$comment.find(\".commentBody\").attr(\"id\", \"comment\" + commentID);\r\n\t$comment.removeClass(\"hidden\").find(\".commentEdit\").click();\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentSticky\", function(e) {\r\n\te.preventDefault();\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\tvar data = {\"mode\": \"sticky\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? viewingSystemID : 0};\r\n\r\n\t$.ajax({\r\n\t\turl: \"comments.php\",\r\n\t\ttype: \"POST\",\r\n\t\tdata: data,\r\n\t\tdataType: \"JSON\"\r\n\t}).done(function(data) {\r\n\t\tif (data && data.result == true) {\r\n\t\t\t$comment.find(\".commentSticky\").hasClass(\"active\") ? $comment.find(\".commentSticky\").removeClass(\"active\") : $comment.find(\".commentSticky\").addClass(\"active\");\r\n\t\t}\r\n\t});\r\n});\r\n\r\nfunction commentSortHandler(sortOrder) {\r\n\tconst sortElem = document.getElementById('comment-sort');\r\n\tconst containerElem = document.getElementById('comment-container');\r\n\tsortOrder = sortOrder || sortElem.nextSort || tripwire.cookies.getCookie('commentSort') || 'asc';\r\n\t\r\n\tswitch(sortOrder) {\r\n\t\tcase 'asc':\r\n\t\t\tsortElem.nextSort = 'desc';\r\n\t\t\tsortElem.setAttribute('data-icon', 'sort-asc');\r\n\t\t\tcontainerElem.style.flexDirection = 'column';\r\n\t\t\tbreak;\r\n\t\tcase 'desc':\r\n\t\t\tsortElem.nextSort = 'asc';\r\n\t\t\tsortElem.setAttribute('data-icon', 'sort-desc');\r\n\t\t\tcontainerElem.style.flexDirection = 'column-reverse';\r\n\t\t\tbreak;\r\n\t\tdefault: throw 'sort order somehow wrong';\r\n\t}\r\n\t\r\n\ttripwire.cookies.setCookie('commentSort', sortOrder, 3650);\r\n}\r\n\r\n$(\"body\").on(\"click\", \"#comment-sort\", function(e) {\r\n\tcommentSortHandler(undefined);\r\n});\r\n\r\ncommentSortHandler();","// Handles removing from Signatures section\ntripwire.deleteSig = function(key) {\n    var tr = $(\"#sigTable tr[data-id='\"+key+\"']\");\n\n    //Append empty space to prevent non-coloring\n    $(tr).find('td:empty, a:empty').append(\"&nbsp;\");\n\n    $(tr)\n        .find('td')\n        .wrapInner('<div />')\n        .parent()\n        .find('td > div').animate({backgroundColor: \"#4D0000\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000)\n        .slideUp(700, function(){\n            // Remove countdown reference\n            $(tr).find('span[data-age]').countdown(\"destroy\");\n\n            $(this).parent().parent().remove();\n            $(\"#sigTable\").trigger(\"update\");\n        });\n}\n","// Handles changing Signatures section\r\n// ToDo: Use native JS\r\ntripwire.editSig = function(edit, disabled) {\r\n    var disabled = disabled || false;\r\n    var wormhole = {};\r\n\r\n    if (edit.type == \"wormhole\") {\r\n\t\tconst sigInfo = tripwire.makeSigInfo(edit);\t// see addSignature.js\r\n\t\tif(!sigInfo) return false;\r\n\t\t\r\n\t\twormhole = sigInfo.wormhole;\r\n\r\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(edit.signatureID)+\"</td>\"\r\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+sigInfo.formattedType+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+(sigInfo.leadsTo || \"\")+\"</td>\"\r\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+sigInfo.lifeText+\"</td>\"\r\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    } else {\r\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(edit.signatureID)+\"</td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+edit.type+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+(edit.name?linkSig(edit.name):'')+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    }\r\n\r\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\r\n\r\n    // Destroy the pervious countdown to prevent errors on a non-existant DOM element\r\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").find('span[data-age]').countdown(\"destroy\");\r\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").replaceWith(tr);\r\n\r\n    $(\"#sigTable\").trigger(\"update\");\r\n    // Update counter\r\n    if (wormhole.life == \"critical\") {\r\n        $(tr).find('span[data-age]').countdown({until: moment.utc(edit.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\r\n            .addClass('critical');\r\n    } else {\r\n        $(tr).find('span[data-age]').countdown({since: moment.utc(edit.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\r\n    }\r\n\r\n    $(tr).effect(\"pulsate\");\r\n}\r\n","tripwire.esi = function() {\r\n    var baseUrl = \"https://esi.evetech.net\";\r\n    var userAgent = \"Tripwire Client \" + tripwire.version + \" (\" + window.location.hostname + \") - \" + window.navigator.userAgent;\r\n    var locationTimer, shipTimer, onlineTimer;\r\n    this.esi.connection = true;\r\n    this.esi.characters = {};\r\n    this.esi.oauth = { subject: \"\", accessToken: \"\"};\r\n\r\n    var scopeError = function(characterID) {\r\n        $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").find(\".alert\").show();\r\n    }\r\n\r\n\tvar isExpired = function(tokenExpire) {\r\n\t\treturn moment.utc(tokenExpire).subtract(5, \"minutes\").isBefore(moment());\r\n\t}\r\n\r\n\tfunction updateTracking(character) {\r\n\t\t// Send to Tripwire server on next refresh call\r\n\t\ttripwire.data.tracking[character.characterID] = {\r\n\t\t\tcharacterID: character.characterID,\r\n\t\t\tcharacterName: character.characterName,\r\n\t\t\tsystemID: character.systemID,\r\n\t\t\tsystemName: character.systemName,\r\n\t\t\tstationID: character.stationID,\r\n\t\t\tstationName: character.stationName,\r\n\t\t\tshipID: character.shipID,\r\n\t\t\tshipName: character.shipName,\r\n\t\t\tshipTypeID: character.shipTypeID,\r\n\t\t\tshipTypeName: character.shipTypeName,\r\n\t\t\tmassOptions: tripwire.massOptions,\r\n\t\t\tcharacterOptions: options.tracking.characterOptions[character.characterID]\r\n\t\t};\t\t\t\t\r\n\t}\r\n\tthis.esi.updateTracking = updateTracking;\t// so it can be called outside\r\n\r\n    this.esi.location = function() {\r\n        clearTimeout(locationTimer);\r\n\r\n        for (characterID in tripwire.esi.characters) {\r\n            var character = tripwire.esi.characters[characterID];\r\n\r\n            // Check for expiring token\r\n            if (isExpired(character.tokenExpire)) {\r\n                tripwire.data.esi = {\"expired\": true};\r\n                continue;\r\n            }\r\n\r\n            const xhr = $.ajax({\r\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/location/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\r\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\r\n                type: \"GET\",\r\n                dataType: \"JSON\",\r\n                characterID: characterID\r\n            }).done(function(data, status, jqXHR) {\r\n                var character = tripwire.esi.characters[this.characterID];\r\n\r\n                if (character) {\r\n                    character.locationDate = moment(jqXHR.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\r\n\r\n                    if (character.systemID != data.solar_system_id) {\r\n                        character.systemID = data.solar_system_id || null;\r\n\t\t\t\t\t\tconst system = systemAnalysis.analyse(data.solar_system_id);\r\n                        character.systemName = system ? system.name : null;\r\n\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".system\").html(systemRendering.renderSystem(system) || \"&nbsp;\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tupdateTracking(character);\r\n                    }\r\n\r\n                    if (character.stationID != data.station_id) {\r\n                        character.stationID = data.station_id || null;\r\n\r\n                        if (data.station_id) {\r\n                            tripwire.esi.stationLookup(data.station_id, this.characterID)\r\n                                .always(function(data) {\r\n                                    var character = tripwire.esi.characters[this.reference];\r\n\r\n                                    character.stationName = data.name || null;\r\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".station\").html(data.name.substring(0, 17) + \"...\" || \"&nbsp;\").attr(\"data-tooltip\", data.name);\r\n                                    Tooltips.attach($(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"'] .station[data-tooltip]\"));\r\n\r\n                                    updateTracking(character);\r\n                                });\r\n                        } else {\r\n                            character.stationName = null;\r\n                            // $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".station\").html(\"&nbsp;\").attr(\"data-tooltip\", \"&nbsp;\");\r\n                            Tooltips.detach($(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"'] .station[data-tooltip]\"));\r\n\t\t\t\t\t\t\tupdateTracking(character);\r\n                        }\r\n                    }\r\n\r\n                    if (options.tracking.active == this.characterID) {\r\n                        tripwire.EVE(tripwire.esi.characters[options.tracking.active]);\r\n                    }\r\n                }\r\n            }).fail(function(data) {\r\n                if (data.status == 403) {\r\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\r\n                }\r\n            }).always(function(data, status, jqXHR) {\r\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\r\n                    tripwire.esi.connection = false;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\r\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\r\n                    tripwire.esi.connection = true;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\r\n                }\r\n            });\r\n            xhr.always(function(){\r\n                const warn = xhr.getResponseHeader('warning');\r\n                if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n            });\r\n        }\r\n\r\n        locationTimer = setTimeout(\"tripwire.esi.location()\", 5000);\r\n    }\r\n\r\n    this.esi.ship = function() {\r\n        clearTimeout(shipTimer);\r\n\r\n        for (characterID in tripwire.esi.characters) {\r\n            var character = tripwire.esi.characters[characterID];\r\n\r\n            // Check for expiring token\r\n            if (isExpired(character.tokenExpire)) {\r\n                tripwire.data.esi = {\"expired\": true};\r\n                continue;\r\n            }\r\n\r\n            const xhr = $.ajax({\r\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/ship/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\r\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\r\n                type: \"GET\",\r\n                dataType: \"JSON\",\r\n                characterID: characterID\r\n            }).done(function(data, status, jqXHR) {\r\n                var character = tripwire.esi.characters[this.characterID];\r\n\r\n                if (character) {\r\n                    character.shipDate = moment(jqXHR.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\r\n\r\n                    if (character.shipID != data.ship_item_id) {\r\n                        character.shipID = data.ship_item_id || null;\r\n\t\t\t\t\t\ttripwire.resetMassOptions();\r\n\t\t\t\t\t\tupdateTracking(character);\r\n                    }\r\n\r\n                    if (character.shipName != data.ship_name) {\r\n                        character.shipName = data.ship_name || null;\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".shipname\").html(data.ship_name || \"&nbsp;\");\r\n\t\t\t\t\t\tupdateTracking(character);\r\n                    }\r\n\r\n                    if (character.shipTypeID != data.ship_type_id) {\r\n                        character.shipTypeID = data.ship_type_id || null;\r\n\r\n                        if (data.ship_type_id) {\r\n                            tripwire.esi.typeLookup(data.ship_type_id, this.characterID)\r\n                                .always(function(data) {\r\n                                    var character = tripwire.esi.characters[this.reference];\r\n\r\n                                    character.shipTypeName = data.name || null;\r\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".ship\").html(data.name || \"&nbsp;\");\r\n\t\t\t\t\t\t\t\t\tupdateTracking(character);\r\n                                });\r\n                        } else {\r\n                            character.shipTypeName = null;\r\n                            $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".ship\").html(\"&nbsp;\");\r\n\t\t\t\t\t\t\tupdateTracking(character);\r\n                        }\r\n                    }\r\n                }\r\n            }).fail(function(data) {\r\n                if (data.status == 403) {\r\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\r\n                }\r\n            }).always(function(data, status, jqXHR) {\r\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\r\n                    tripwire.esi.connection = false;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\r\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\r\n                    tripwire.esi.connection = true;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\r\n                }\r\n            });\r\n            xhr.always(function(){\r\n                const warn = xhr.getResponseHeader('warning');\r\n                if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n            });\r\n\r\n        }\r\n\r\n        shipTimer = setTimeout(\"tripwire.esi.ship()\", 5000);\r\n    }\r\n\r\n    this.esi.online = function() {\r\n        clearTimeout(onlineTimer);\r\n\r\n        for (characterID in tripwire.esi.characters) {\r\n            var character = tripwire.esi.characters[characterID];\r\n\r\n            tripwire.esi.characterStatus(character.characterID, character)\r\n                .done(function(data) {\r\n                    if (data.online) {\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"critical\").addClass(\"stable\");\r\n                    } else {\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\r\n                    }\r\n                }).fail(function(data) {\r\n                    if (data && data.status == 403) {\r\n                        scopeError(this.reference.characterID);\r\n                    }\r\n                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\r\n                });\r\n        }\r\n\r\n        onlineTimer = setTimeout(\"tripwire.esi.online()\", 60000);\r\n    }\r\n\r\n    this.esi.typeLookup = function(typeID, reference) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v3/universe/types/\"+ typeID +\"/?\" + $.param({\"user_agent\": userAgent}),\r\n            // headers: {\"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.stationLookup = function(stationID, reference) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/universe/stations/\"+ stationID +\"/?\" + $.param({\"user_agent\": userAgent}),\r\n            // headers: {\"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.setDestination = function(destinationID, characterID, clear_waypoints, beginning) {\r\n        clear_waypoints = clear_waypoints ? clear_waypoints : false;\r\n        beginning = beginning ? beginning : false;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/ui/autopilot/waypoint/?\" + $.param({destination_id: destinationID, clear_other_waypoints: clear_waypoints, add_to_beginning: beginning}),\r\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\r\n            type: \"POST\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.showInfo = function(targetID, characterID) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v1/ui/openwindow/information/?\" + $.param({target_id: targetID}),\r\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\r\n            type: \"POST\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.characterStatus = function(characterID, reference) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/characters/\" + characterID + \"/online/?\" + $.param({\"token\": tripwire.esi.characters[characterID].accessToken, \"user_agent\": userAgent}),\r\n            // headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.eveStatus = function() {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v1/status/?\" + $.param({\"user_agent\": userAgent}),\r\n            // headers: {\"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.idLookup = function(eveIDs) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/universe/names/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"POST\",\r\n            dataType: \"JSON\",\r\n            contentType: \"application/json\",\r\n            processData: false,\r\n            data: JSON.stringify(eveIDs)\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.characterLookup = function(eveID, reference, async) {\r\n        var async = typeof(async) !== 'undefined' ? async : true;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/latest/characters/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            async: async,\r\n            eveID: eveID,\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.corporationLookup = function(eveID, reference, async) {\r\n        var async = typeof(async) !== 'undefined' ? async : true;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v4/corporations/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            async: async,\r\n            eveID: eveID,\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.allianceLookup = function(eveID, reference, async) {\r\n        var async = typeof(async) !== 'undefined' ? async : true;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v3/alliances/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            async: async,\r\n            eveID: eveID,\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.search = function(searchString, categories, strict) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/latest/characters/\" + tripwire.esi.oauth.subject + \"/search/?\" + $.param({\"user_agent\": userAgent}),\r\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.oauth.accessToken},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            contentType: \"application/json\",\r\n            data: {\"search\": searchString, \"categories\": categories, \"strict\": strict}\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.universeJumps = function() {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v1/universe/system_jumps/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.universeKills = function() {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/universe/system_kills/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    // Wrapper to make lookups easier\r\n    this.esi.fullLookup = function(eveIDs) {\r\n        var promise = $.Deferred();\r\n\r\n        tripwire.esi.idLookup(eveIDs)\r\n            .done(function(data) {\r\n                for (item in data) {\r\n                    if (data[item].category == \"character\") {\r\n                        tripwire.esi.characterLookup(data[item].id, data[item], false)\r\n                            .done(function(characterData) {\r\n                                $.extend(data[item], characterData);\r\n                                tripwire.esi.corporationLookup(characterData.corporation_id, this.reference, false)\r\n                                    .done(function(corporationData) {\r\n                                        data[item].corporation = corporationData;\r\n                                        if (corporationData.alliance_id) {\r\n                                            tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\r\n                                                .done(function(allianceData) {\r\n                                                    data[item].alliance = allianceData;\r\n                                                });\r\n                                        }\r\n                                    });\r\n                            });\r\n                    } else if (data[item].category == \"corporation\") {\r\n                        tripwire.esi.corporationLookup(data[item].id, data[item], false)\r\n                            .done(function(corporationData) {\r\n                                $.extend(data[item], corporationData);\r\n                                if (corporationData.alliance_id) {\r\n                                    tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\r\n                                        .done(function(allianceData) {\r\n                                            data[item].alliance = allianceData;\r\n                                        });\r\n                                }\r\n                            })\r\n                    } else if (data[item].category == \"alliance\") {\r\n                        tripwire.esi.allianceLookup(data[item].id, data[item], false)\r\n                            .done(function(allianceData) {\r\n                                $.extend(data[item], allianceData);\r\n                            })\r\n                    }\r\n                }\r\n\r\n                promise.resolve(data);\r\n            });\r\n\r\n        return promise;\r\n    }\r\n\r\n    // Parse main account oauth information out of refresh data. This is used\r\n    // to make authenticated ESI requests for enpoints that are not specific to\r\n    // tracking characters, e.g., mask access management.\r\n    this.esi.parseOauth = function(data) {\r\n        const _data = data || {}\r\n        tripwire.esi.oauth = {\r\n            subject: _data.subject,\r\n            accessToken: _data.accessToken\r\n        };\r\n    }\r\n\r\n    this.esi.parse = function(characters) {\r\n        for (characterID in tripwire.esi.characters) {\r\n            if (!(characterID in characters)) {\r\n                delete tripwire.esi.characters[characterID];\r\n                tracking.remove(characterID);\r\n                if (options.tracking.active == characterID) {\r\n                    tripwire.EVE(false, true);\r\n                    $(\"#removeESI\").attr(\"disabled\", \"disabled\");\r\n                }\r\n            }\r\n        }\r\n\r\n        for (characterID in characters) {\r\n            if (options.tracking.active == \"new\") {\r\n                options.tracking.active = characterID;\r\n            }\r\n\r\n            if (!(characterID in tripwire.esi.characters)) {\r\n                var $clone = tracking.add(characters[characterID]);\r\n\t\t\t\t\r\n                if (options.tracking.active == characterID) {\r\n                    $clone.addClass(\"active\");\r\n                    $(\"#removeESI\").removeAttr(\"disabled\");\r\n                }\r\n\r\n            }\r\n\r\n            tripwire.esi.characters[characterID] = characters[characterID];\r\n        }\r\n\t\t\r\n\t\tset_tracking_text();\r\n\r\n        tripwire.esi.ship();\r\n        tripwire.esi.location();\r\n        tripwire.esi.online();\r\n    }\r\n}\r\ntripwire.esi();\r\n","// Handles data from EVE in-game data\r\ntripwire.EVE = function(EVE, characterChange) {\r\n    var systemChange = this.client.EVE && this.client.EVE.systemChange || false;\r\n\r\n    if (EVE) {\r\n        // Automapper\r\n        if (!characterChange) {\r\n            // Did the system change or did it previously and we have yet to try an autoMapper call?\r\n            if ((this.client.EVE && this.client.EVE.systemID != EVE.systemID) || systemChange == true) {\r\n                systemChange = true;\r\n\r\n                // Check if location was updated after the last ship update\r\n                // if (moment(EVE.locationDate).isAfter(moment(this.client.EVE.shipDate))) {\r\n                    systemChange = false;\r\n                    tripwire.autoMapper(this.client.EVE.systemID, EVE.systemID);\r\n                // }\r\n            }\r\n        }\r\n\r\n        // System follower\r\n        if (!characterChange && options.buttons.follow && (this.client.EVE && this.client.EVE.systemID != EVE.systemID) && $(\".ui-dialog:visible\").length == 0) {\r\n            tripwire.systemChange(EVE.systemID);\r\n        }\r\n\r\n        if (!$(\"#search\").hasClass(\"active\")) {\r\n            $(\"#currentSpan\").show();\r\n        }\r\n\r\n        // Enable auto-mapper\r\n        $(\"#toggle-automapper\").removeClass(\"disabled\");\r\n\r\n        // Update current system\r\n        if (EVE.systemID) {\r\n            // add system to Leads To dropdown\r\n            if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\r\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\r\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"addToSelect\", tripwire.systems[EVE.systemID]);\r\n            }\r\n            $(\"#EVEsystem\").html(systemRendering.renderSystem(systemAnalysis.analyse(EVE.systemID)));\r\n        }\r\n    } else {\r\n        // Update current system\r\n        $(\"#EVEsystem\").html(\"Not tracking\");\r\n        $(\"#currentSpan\").hide();\r\n        // Disable automapper\r\n        $(\"#toggle-automapper\").addClass(\"disabled\");\r\n        // remove system from Leads To dropdown\r\n        if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\r\n            $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\r\n        }\r\n    }\r\n\r\n    this.client.EVE = {\r\n        characterID: EVE.characterID,\r\n        characterName: EVE.characterName,\r\n        systemID: EVE.systemID,\r\n        systemName: EVE.systemName,\r\n        shipTypeID: EVE.shipTypeID,\r\n        shipTypeName: EVE.shipTypeName,\r\n        stationID: EVE.stationID,\r\n        stationName: EVE.stationName,\r\n        locationDate: EVE.locationDate,\r\n        shipDate: EVE.shipDate,\r\n        systemChange: systemChange\r\n    };\r\n}\r\n","appData.genericSystemTypes = [\r\n\t\"Null-Sec\", \"Low-Sec\", \"High-Sec\",\r\n\t\"Class-1\", \"Class-2\", \"Class-3\", \"Class-4\", \"Class-5\", \"Class-6\", \"Class-13\", \r\n\t\"Triglavian\",\r\n\t\"Unknown\", \"Unknown (small)\", \"Dangerous\",\r\n\t\"Class-14\", \"Class-15\", \"Class-16\", \"Class-17\", \"Class-18\", \r\n\t];","tripwire.parse = function(server, mode) {\r\n    var data = $.extend(true, {}, server);\r\n\r\n    var updateSignatureTable = false;\r\n\tconst newSigsInSystem = { };\r\n\r\n    if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout != true)) {\r\n        if (options.masks.active != \"273.0\") {\r\n            for (var key in data.signatures) {\r\n                if (data.signatures[key].mask == \"273.0\") {\r\n                    delete data.signatures[key];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if (mode == 'refresh') {\r\n        // preserve client.EVE across refresh otherwise tracking/automapper will be confused\r\n        var EVE = this.client.EVE;\r\n        this.client = server;\r\n        this.client.EVE = EVE;\r\n\r\n        for (var key in data.signatures) {\r\n            if (data.signatures[key].systemID != viewingSystemID) {\r\n                continue;\r\n            }\r\n\t\t\tnewSigsInSystem[key] = data.signatures[key];\r\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\r\n\r\n            // Check for differences\r\n            if (!tripwire.signatures.list[key]) {\r\n\t\t\t\ttripwire.signatures.list[key] = data.signatures[key];\t// To reduce race condition chance\r\n                this.addSig(data.signatures[key], {animate: true}, disabled);\r\n                updateSignatureTable = true;\r\n            } else if (tripwire.signatures.list[key].modifiedTime !== data.signatures[key].modifiedTime) {\r\n                var edit = false;\r\n                for (column in data.signatures[key]) {\r\n                    if (data.signatures[key][column] != tripwire.signatures.list[key][column] && column != \"editing\") {\r\n                        edit = true;\r\n                    }\r\n                }\r\n\r\n                if (edit) {\r\n                    this.editSig(data.signatures[key], disabled);\r\n                } else {\r\n                    // this.sigEditing(data.signatures[key]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Sigs needing removal\r\n        for (var key in tripwire.signatures.list) {\r\n            if (!data.signatures[key]) {\r\n                this.deleteSig(key);\r\n            }\r\n        }\r\n    } else if (mode == 'init' || mode == 'change') {\r\n        this.client = server;\r\n\r\n        for (var key in data.signatures) {\r\n            if (data.signatures[key].systemID != viewingSystemID) {\r\n                continue;\r\n            }\r\n\t\t\tnewSigsInSystem[key] = data.signatures[key];\r\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\r\n\t\t\t\r\n\t\t\tif(!tripwire.signatures.list[key]) {\r\n\t\t\t\tthis.addSig(data.signatures[key], {animate: false}, disabled);\r\n\t\t\t\tupdateSignatureTable = true;\r\n\t\t\t}\r\n            if (data.signatures[key].editing) {\r\n                this.sigEditing(data.signatures[key]);\r\n            }\r\n        }\r\n    } else { return; }\t// unknown type of parse request so do nothing\r\n\r\n    if (updateSignatureTable) {\r\n        $(\"#sigTable\").trigger(\"update\");\r\n    }\r\n    tripwire.signatures.list = data.signatures;\r\n\ttripwire.signatures.currentSystem = newSigsInSystem;\r\n\t\t\r\n    // set the sig count in the UI\r\n    var signatureCount = 0;\r\n    $.map(data.signatures, function(signature) {signature.systemID == viewingSystemID ? signatureCount++ : null;});\r\n    $(\"#signature-count\").html(signatureCount);\r\n}\r\n\r\n/** Find if there is an unknown return sig. The markup is always generated (in addSignature.js) */\r\ntripwire.updateReturnStatus = function() {\r\n\tconst inSigId = $(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']:not(.calc)\").attr('data-insigid');\r\n\tconst wormholeId = $(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']:not(.calc)\").attr('data-sigid');\r\n\tconst wormhole = tripwire.client.wormholes[wormholeId] || {};\r\n\t// One of the two ends should be in this system, In sig will be the wrong end, so find the other end\r\n\tconst returnSigId = wormhole.initialID == inSigId ? wormhole.secondaryID : wormhole.initialID;\r\n\ttripwire.signatures.returnSig = tripwire.signatures.list[returnSigId];\r\n\tconst needReturn = tripwire.signatures.returnSig && (tripwire.signatures.returnSig.signatureID == '???' || tripwire.signatures.returnSig.signatureID == '' || tripwire.signatures.returnSig.signatureID === null || tripwire.signatures.returnSig.signatureID === undefined);\r\n\tdocument.getElementById('sigTableWrapper').className = needReturn ? 'return-visible' : 'return-invisible';\t\r\n}","// Handles pasting sigs from EVE\r\ntripwire.pasteSignatures = function() {\r\n    var processing = false;\r\n\r\n    var rowParse = function(row) {\r\n        var scanner = {};\r\n        var columns = row.split(\"\t\"); // Split by tab\r\n        var validScanGroups = [\r\n            // English (en-us)\r\n            \"Cosmic Signature\",\r\n            \"Cosmic Anomaly\",\r\n\r\n            // French (fr)\r\n            \"Signature cosmique\",\r\n            \"Anomalie cosmique\",\r\n\r\n            // German (de)\r\n            \"Kosmische Anomalie\",\r\n            \"Kosmische Signatur\",\r\n\r\n            // Japanese (ja)\r\n            \"宇宙の特異点\",\r\n            \"宇宙のシグネチャ\",\r\n\r\n            // Korean (ko)\r\n            \"코즈믹 시그니처\",\r\n            \"코즈믹 어노말리\",\r\n\r\n            // Russian (ru)\r\n            \"Скрытый сигнал\",\r\n            \"Космическая аномалия\",\r\n        ];\r\n\r\n        var validTypes = {\r\n            // English (en-us)\r\n            \"Combat Site\": \"Combat\",\r\n            \"Data Site\": \"Data\",\r\n            \"Gas Site\": \"Gas\",\r\n            \"Ore Site\": \"Ore\",\r\n            \"Relic Site\": \"Relic\",\r\n            \"Wormhole\": \"Wormhole\",\r\n\r\n            // French (fr)\r\n            \"Site de combat\": \"Combat\",\r\n            \"Site de données\": \"Data\",\r\n            \"Site de collecte de gaz\": \"Gas\",\r\n            \"Site de minerai\": \"Ore\",\r\n            \"Site de reliques\": \"Relic\",\r\n            \"Trou de ver\": \"Wormhole\",\r\n\r\n            // German (de)\r\n            \"Kampfgebiet\": \"Combat\",\r\n            \"Datengebiet\": \"Data\",\r\n            \"Gasgebiet\": \"Gas\",\r\n            \"Mineraliengebiet\": \"Ore\",\r\n            \"Reliktgebiet\": \"Relic\",\r\n            \"Wurmloch\": \"Wormhole\",\r\n\r\n            // Japanese (ja)\r\n            \"戦闘サイト\": \"Combat\",\r\n            \"データサイト\": \"Data\",\r\n            \"ガスサイト\": \"Gas\",\r\n            \"鉱石サイト\": \"Ore\",\r\n            \"遺物サイト\": \"Relic\",\r\n            \"ワームホール\": \"Wormhole\",\r\n\r\n            // Korean (ko)\r\n            \"전투 사이트\": \"Combat\",\r\n            \"데이터 사이트\": \"Data\",\r\n            \"가스 사이트\": \"Gas\",\r\n            \"채광 사이트\": \"Ore\",\r\n            \"유물 사이트\": \"Relic\",\r\n            \"웜홀\": \"Wormhole\",\r\n\r\n            // Russian (ru)\r\n            \"Боевой район\": \"Combat\",\r\n            \"Информационный район\": \"Data\",\r\n            \"Газовый район\": \"Gas\",\r\n            \"Астероидный район\": \"Ore\",\r\n            \"Археологический район\": \"Relic\",\r\n            \"Червоточина\": \"Wormhole\",\r\n        };\r\n\r\n        for (var x in columns) {\r\n            if (columns[x].match(/^([A-Z]{3}[-]\\d{3})$/)) {\r\n                scanner.id = columns[x].split(\"-\");\r\n                continue;\r\n            }\r\n\r\n            if (columns[x].match(/(\\d([.|,]\\d)?[ ]?(%))/) || columns[x].match(/(\\d[.|,]?\\d+\\s?(UA|AU|AE|km|m|а.е.|км|м))/i)) { // Exclude scan % || AU\r\n                continue;\r\n            }\r\n\r\n            if ($.inArray(columns[x], validScanGroups) != -1) {\r\n                scanner.scanGroup = columns[x];\r\n                continue;\r\n            }\r\n\r\n            if (validTypes[columns[x]]) {\r\n                scanner.type = validTypes[columns[x]];\r\n                continue;\r\n            }\r\n\r\n            if (columns[x] != \"\") {\r\n                scanner.name = columns[x].trim();\r\n            }\r\n        }\r\n\r\n        if (!scanner.id || scanner.id.length !== 2) {\r\n            return false;\r\n        }\r\n\r\n        return scanner;\r\n    }\r\n\r\n    this.pasteSignatures.parsePaste = function(paste) {\r\n        var paste = paste.split(\"\\n\");\r\n        var payload = {\"signatures\": {\"add\": [], \"update\": []}, \"systemID\": viewingSystemID};\r\n        var undo = [];\r\n        processing = true;\r\n\r\n        for (var i in paste) {\r\n            var scanner = rowParse(paste[i]);\r\n\r\n            if (scanner.id) {\r\n                var signature = $.map(tripwire.client.signatures, function(signature) { if (signature.signatureID && signature.signatureID.toUpperCase() == scanner.id[0] + scanner.id[1] && signature.systemID == viewingSystemID) return signature; })[0];\r\n                if (signature) {\r\n                    // Update signature (only non-wormholes can be updated to a wormhole)\r\n                    if (scanner.type == \"Wormhole\" && signature.type != \"wormhole\") {\r\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\r\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\r\n                        payload.signatures.update.push({\r\n                            \"wormhole\": {\r\n                                \"id\": wormhole.id || null,\r\n                                \"type\": wormhole.type || null,\r\n                                \"life\": wormhole.life || \"stable\",\r\n                                \"mass\": wormhole.mass || \"stable\"\r\n                            },\r\n                            \"signatures\": [\r\n                                {\r\n                                    \"id\": signature.id,\r\n                                    \"signatureID\": signature.signatureID,\r\n                                    \"systemID\": viewingSystemID,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"name\": signature.name\r\n                                },\r\n                                {\r\n                                    \"id\": otherSignature.id || null,\r\n                                    \"signatureID\": otherSignature.signatureID || null,\r\n                                    \"systemID\": otherSignature.systemID || null,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"name\": otherSignature.name\r\n                                }\r\n                            ]\r\n                        });\r\n\r\n                        if (tripwire.client.wormholes[wormhole.id]) {\r\n\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[otherSignature.id]]});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// used to be just a regular signature\r\n\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\r\n\t\t\t\t\t\t}\r\n                    // Make sure we are only updating when we have new info (we never turn wormholes into regular signatures)\r\n                    } else if (signature.type != \"wormhole\" && ((scanner.type && scanner.type.toLowerCase() != signature.type) || (scanner.name && scanner.name != signature.name))) {\r\n                        payload.signatures.update.push({\r\n                            \"id\": signature.id,\r\n                            \"systemID\": viewingSystemID,\r\n                            \"type\": scanner.type || 'unknown',\r\n                            \"name\": scanner.name,\r\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                        });\r\n                        undo.push(tripwire.client.signatures[signature.id]);\r\n                    }\r\n                } else {\r\n                    // Add signature\r\n                    if (scanner.type == \"Wormhole\") {\r\n                        payload.signatures.add.push({\r\n                            \"wormhole\": {\r\n                                \"type\": null,\r\n                                \"parent\": \"initial\",\r\n                                \"life\": \"stable\",\r\n                                \"mass\": \"stable\"\r\n                            },\r\n                            \"signatures\": [\r\n                                {\r\n                                    \"signatureID\": scanner.id[0] + scanner.id[1],\r\n                                    \"systemID\": viewingSystemID,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                                },\r\n                                {\r\n                                    \"signatureID\": null,\r\n                                    \"systemID\": null,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                                }\r\n                            ]\r\n                        });\r\n                    } else {\r\n                        payload.signatures.add.push({\r\n                            \"signatureID\": scanner.id[0] + scanner.id[1],\r\n                            \"systemID\": viewingSystemID,\r\n                            \"type\": scanner.type || 'unknown',\r\n                            \"name\": scanner.name,\r\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (payload.signatures.add.length || payload.signatures.update.length) {\r\n            var success = function(data) {\r\n                if (data.resultSet && data.resultSet[0].result == true) {\r\n                    $(\"#undo\").removeClass(\"disabled\");\r\n\r\n                    if (data.results) {\r\n                        if (viewingSystemID in tripwire.signatures.undo) {\r\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\r\n                        } else {\r\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\r\n                        }\r\n                    }\r\n\r\n                    if (undo.length) {\r\n                        if (viewingSystemID in tripwire.signatures.undo) {\r\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\r\n\t\t\t\t\t\t} else {\r\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\r\n\t\t\t\t\t\t}\r\n                    }\r\n\r\n                    sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n                }\r\n            }\r\n\r\n            var always = function(data) {\r\n                processing = false;\r\n            }\r\n\r\n            tripwire.refresh('refresh', payload, success, always);\r\n        } else {\r\n            processing = false;\r\n        }\r\n    }\r\n\r\n    this.pasteSignatures.init = function() {\r\n        $(document).keydown(function(e)\t{\r\n            if ((e.metaKey || e.ctrlKey) && (e.keyCode == 86 || e.keyCode == 91) && !processing) {\r\n                //Abort - user is in input or textarea\r\n                if ($(document.activeElement).is(\"textarea, input\")) return;\r\n\r\n                $(\"#clipboard\").focus();\r\n            }\r\n        });\r\n\r\n        $(\"body\").on(\"click\", \"#fullPaste\", function(e) {\r\n            e.preventDefault();\r\n\r\n            var paste = $(this).data(\"paste\").split(\"\\n\");\r\n            var pasteIDs = [];\r\n            var removes = [];\r\n            var undo = [];\r\n\r\n            for (var i in paste) {\r\n                if (scan = rowParse(paste[i])) {\r\n                    pasteIDs.push((scan.id[0] + scan.id[1]).toLowerCase());\r\n                }\r\n            }\r\n\r\n            for (var i in tripwire.client.signatures) {\r\n                var signature = tripwire.client.signatures[i];\r\n\r\n                if (signature.systemID == viewingSystemID && signature.signatureID && $.inArray(signature.signatureID.toLowerCase(), pasteIDs) === -1 && signature.signatureID !== \"???\") {\r\n                    if (signature.type == \"wormhole\") {\r\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\r\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\r\n                        if (wormhole.type !== \"GATE\") {\r\n                            removes.push(wormhole);\r\n                            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, otherSignature]});\r\n                        }\r\n                    } else {\r\n                        removes.push(signature.id);\r\n                        undo.push(signature);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (removes.length > 0) {\r\n                var payload = {\"signatures\": {\"remove\": removes}};\r\n\r\n                var success = function(data) {\r\n                    if (data.resultSet && data.resultSet[0].result == true) {\r\n                        $(\"#undo\").removeClass(\"disabled\");\r\n                        if (viewingSystemID in tripwire.signatures.undo) {\r\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\r\n                        } else {\r\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\r\n                        }\r\n\r\n                        sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n                    }\r\n                }\r\n\r\n                tripwire.refresh('refresh', payload, success);\r\n            }\r\n        });\r\n\r\n        $(\"#clipboard\").on(\"paste\", function(e) {\r\n            e.preventDefault();\r\n            var paste = window.clipboardData ? window.clipboardData.getData(\"Text\") : (e.originalEvent || e).clipboardData.getData('text/plain');\r\n\r\n            $(\"#clipboard\").blur();\r\n            Notify.trigger(\"Paste detected<br/>(<a id='fullPaste' href=''>Click to delete missing sigs</a>)\");\r\n            $(\"#fullPaste\").data(\"paste\", paste);\r\n            tripwire.pasteSignatures.parsePaste(paste);\r\n        });\r\n    }\r\n\r\n    this.pasteSignatures.init();\r\n}\r\ntripwire.pasteSignatures();\r\n","tripwire.redo = function() {\n    if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n        $(\"#redo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.redo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var redoItem = tripwire.signatures.redo[viewingSystemID][lastIndex];\n        var undo = $.map(redoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(redoItem.action) {\n            case \"add\":\n                data.signatures.add = data.signatures.add.concat(redoItem.signatures);\n                break;\n            case \"remove\":\n                data.signatures.remove = data.signatures.remove.concat($.map(redoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(redoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.redo[viewingSystemID].pop();\n\n                $(\"#undo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.undo) {\n                    if (redoItem.action == \"add\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": data.results});\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": undo});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID].push({action: redoItem.action, signatures: redoItem.signatures});\n                    }\n                } else {\n                    if (redoItem.action == \"add\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": data.results}];\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": undo}];\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: redoItem.action, signatures: redoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n                $(\"#redo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","// Handles pulling TQ status & player count\r\ntripwire.serverStatus = function() {\r\n    this.data;\r\n    this.timer;\r\n\r\n    clearTimeout(tripwire.serverStatus.timer);\r\n\r\n    tripwire.esi.eveStatus()\r\n        .always(function(data) {\r\n            if (data && data.players && data.players > 0) {\r\n                if (!tripwire.serverStatus.data || tripwire.serverStatus.data.players !== data.players) {\r\n                    $('#serverStatus').html(\"<span class='\"+(data.players > 0 ? 'stable' : 'critical')+\"'>TQ</span>: \"+Intl.NumberFormat().format(data.players));\r\n\r\n                    if (tripwire.serverStatus.data) {\r\n                        $(\"#serverStatus\").effect('pulsate', {times: 5});\r\n                    }\r\n                }\r\n\r\n                tripwire.serverStatus.data = data;\r\n            } else {\r\n                $('#serverStatus').html(\"<span class='critical'>TQ</span>\");\r\n            }\r\n\r\n            tripwire.serverStatus.timer = setTimeout(\"tripwire.serverStatus();\", 15000);\r\n        });\r\n}\r\ntripwire.serverStatus();\r\n\r\ntripwire.updateServerTime = function() {\r\n\tdocument.getElementById('serverTime').innerText = moment.utc().format('HH:mm')\r\n};\r\nsetInterval(tripwire.updateServerTime, 5000);\r\ntripwire.updateServerTime();","tripwire.sync = function(mode, data, successCallback, alwaysCallback) {\t\r\n    var data = typeof(data) === \"object\" ? $.extend(true, {}, data) : {};\r\n\r\n    // Grab any pending changes\r\n    $.extend(true, data, tripwire.data);\r\n\r\n    // Remove old timer to prevent multiple\r\n    if (this.timer) clearTimeout(this.timer);\r\n    if (this.xhr) {\r\n\t\tconsole.log('Awaiting existing XHR ' + this.xhr.data.mode + ': ', this.xhr);\r\n\t\ttripwire.data = data;\r\n\t\tthis.timer = setTimeout(function() { tripwire.sync(mode, data, successCallback, alwaysCallback); }, 50);\r\n\t\treturn false;\r\n\t}\r\n\r\n    if (mode == 'refresh' || mode == 'change') {\r\n        data.signatureCount = tripwire.serverSignatureCount;\r\n        data.signatureTime = maxTimeByProperty(this.client.signatures, \"modifiedTime\");\r\n\r\n        data.flareCount = chain.data.flares ? chain.data.flares.flares.length : 0;\r\n        data.flareTime = chain.data.flares ? chain.data.flares.last_modified : 0;\r\n\r\n        data.commentCount = Object.keys(this.comments.data||{}).length;\r\n        data.commentTime = maxTimeByProperty(this.comments.data, \"modified\");\r\n\r\n        data.activity = this.activity;\r\n    } else {\r\n        // Expand Tripwire with JSON data from EVE Data Dump and other static data\r\n        $.extend(this, appData);\r\n\r\n        this.aSigSystems = Object.assign(\r\n\t\t\t// Using the index as a key here because numeric keys always come first and we want these before real systems\r\n\t\t\t// see https://stackoverflow.com/questions/47881998/\r\n\t\t\tappData.genericSystemTypes.reduce(function(o, s, i) { o[i] = systemAnalysis.analyse(s); o[i].name = s; return o; }, {} ),\r\n\t\t\tthis.systems);\r\n\t\t\r\n        $(\".systemsAutocomplete\").inlinecomplete({source: this.systems, renderer: 'system', maxSize: 10, delay: 0});\r\n    }\r\n\r\n    data.mode = mode != \"init\" ? \"refresh\" : \"init\";\r\n    data.systemID = viewingSystemID;\r\n    data.systemName = viewingSystem;\r\n    data.instance = tripwire.instance;\r\n    data.version = tripwire.version;\r\n\r\n    this.xhr = $.ajax({\r\n        url: \"refresh.php\",\r\n        data: data,\r\n        type: \"POST\",\r\n        dataType: \"JSON\",\r\n        cache: false\r\n    }).done(function(data) {\r\n        if (data) {\r\n            tripwire.server = data;\r\n            if(data.signatures) { // Save this count before we delete entries\r\n                tripwire.serverSignatureCount = Object.keys(data.signatures||{}).length;\r\n            }\r\n\r\n            if (data.wormholes) {\r\n                // Purge bad wormhole signatures\r\n                var wormholeInitialIDs = {};\r\n                var wormholeSecondaryIDs = {};\r\n                Object.values(data.wormholes).forEach(function (wh) {\r\n                    wormholeInitialIDs[parseInt(wh.initialID)] = wh.id;\r\n                    wormholeSecondaryIDs[parseInt(wh.secondaryID)] = wh.id;\r\n                })\r\n                for (var i in data.signatures) {\r\n                  if (data.signatures[i].type == \"wormhole\") {\r\n                    var id = data.signatures[i].id;\r\n                    if (wormholeInitialIDs[id] === undefined && wormholeSecondaryIDs[id] === undefined) {\r\n                      delete data.signatures[i];\r\n                    }\r\n                  }\r\n                }\r\n            }\r\n\r\n            if (data.esi) {\r\n                tripwire.esi.parse(data.esi);\r\n            }\r\n\r\n            if (data.oauth) {\r\n                tripwire.esi.parseOauth(data.oauth);\r\n            }\r\n\r\n            if (data.sync) {\r\n                tripwire.serverTime.time = new Date(data.sync);\r\n            }\r\n\r\n            if (data.signatures) {\r\n                tripwire.parse(data, mode);\r\n            }\r\n\r\n            if (data.comments) {\r\n                tripwire.comments.parse(data.comments);\r\n            }\r\n\r\n            if (data.wormholes || data.occupied || data.flares) {\r\n                tripwire.chainMap.parse({\"map\": data.wormholes || null, \"occupied\": data.occupied || null, \"flares\": data.flares || null});\r\n            } else if (chain.data.occupied && chain.data.occupied.length && !data.occupied) {\r\n                // send update to remove all occupied system indicators\r\n                tripwire.chainMap.parse({\"occupied\": []});\r\n            }\r\n\r\n\t\t\ttripwire.updateReturnStatus();\r\n\r\n            tripwire.active(data.activity);\r\n\r\n            if (data.notify && !$(\"#serverNotification\")[0]) Notify.trigger(data.notify, \"yellow\", false, \"serverNotification\");\r\n\t\t\t\r\n\t\t\t$('[data-command=ping]')[data.discord_integration ? 'show' : 'hide']();\r\n        }\r\n\r\n        tripwire.data = {tracking: {}, esi: {}};\r\n        successCallback ? successCallback(data) : null;\r\n    }).always(function(data, status) {\r\n        tripwire.timer = setTimeout(\"tripwire.refresh();\", tripwire.refreshRate);\r\n\r\n        alwaysCallback ? alwaysCallback(data) : null;\r\n\r\n        if (data.status == 403) {\r\n            window.location.href = \".\";\r\n        } else if (status != \"success\" && status != \"abort\" && tripwire.connected == true) {\r\n            tripwire.connected = false;\r\n            $(\"#ConnectionSuccess\").click();\r\n            Notify.trigger(\"Error syncing with server\", \"red\", false, \"connectionError\");\r\n        } else if (status == \"success\" && tripwire.connected == false) {\r\n            tripwire.connected = true;\r\n            $(\"#connectionError\").click();\r\n            Notify.trigger(\"Successfully reconnected with server\", \"green\", 5000, \"connectionSuccess\");\r\n        }\r\n\t\t\r\n\t\ttripwire.xhr = null;\r\n    });\r\n\tthis.xhr.data = data;\r\n\t\r\n    return true;\r\n};\r\n\r\nfunction maxTimeByProperty(obj, prop) {\r\n\tvar maxTimeString = \"\", maxTime;\r\n\r\n\tfor (var key in obj) {\r\n\t\tif (!maxTime || maxTime < new Date(obj[key][prop])) {\r\n\t\t\tmaxTime = new Date(obj[key][prop]);\r\n\t\t\tmaxTimeString = obj[key][prop];\r\n\t\t}\r\n\t}\r\n\treturn maxTimeString;\r\n}\r\n\r\ntripwire.sync(\"init\");\r\n","// Change the currently viewed system\r\ntripwire.systemChange = function(systemID, mode) {\r\n\tconst system = systemAnalysis.analyse(systemID);\r\n\tif(!system) { return; }\r\n\t\t\r\n    if (mode != \"init\") {\r\n        $(\"#infoSecurity\").removeClass();\r\n        $(\"#infoStatics\").empty();\r\n\r\n        viewingSystem = system.name;\r\n        viewingSystemID = systemID;\r\n\r\n        // Reset activity\r\n        activity.refresh(true);\r\n\r\n        // Reset signatures\r\n        $(\"#sigTable span[data-age]\").countdown(\"destroy\");\r\n        $(\"#sigTable tbody\").empty();\r\n        $(\"#signature-count\").html(0);\r\n        tripwire.signatures.list = {};\r\n        tripwire.client.signatures = null;\r\n\r\n        // Reset chain map\r\n        chain.redraw();\r\n\r\n        // Reset comments\r\n        $(\"#notesWidget .content .comment:visible\").remove();\r\n        tripwire.comments.data = null;\r\n\r\n        // Change the URL & history\r\n        history.replaceState(null, null, \"?system=\"+viewingSystem);\r\n\r\n        tripwire.refresh(\"change\");\r\n    }\r\n\r\n    // Change the title\r\n    document.title = system.name + \" - \" + app_name;\r\n\r\n    $(\"#infoSystem\").text(system.name);\r\n\r\n    // Current system favorite\r\n    $.inArray(parseInt(viewingSystemID), options.favorites) != -1 ? $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\") : $(\"#system-favorite\").attr(\"data-icon\", \"star-empty\").removeClass(\"active\");\r\n\t\r\n    if (system.class) {\r\n        // Security\r\n        $(\"#infoSecurity\").html(\"<span class='\" + system.systemTypeClass+\" pointer'>Class \" + system.class + \"</span>\");\r\n\r\n        // Effects\r\n        if (system.effect) {\r\n            var tooltip = \"<table cellpadding=\\\"0\\\" cellspacing=\\\"1\\\">\";\r\n            for (var x in tripwire.effects[system.effect]) {\r\n                var effect = tripwire.effects[system.effect][x].name;\r\n                var base = tripwire.effects[system.effect][x].base;\r\n                var bad = tripwire.effects[system.effect][x].bad;\r\n                var whClass = system.class > 6 ? 6 : system.class;\r\n                var modifier = 0;\r\n\r\n                switch (Math.abs(base)) {\r\n                    case 15:\r\n                        modifier = base > 0 ? 7 : -7;\r\n                        break;\r\n                    case 30:\r\n                        modifier = base > 0 ? 14 : -14;\r\n                        break;\r\n                    case 60:\r\n                        modifier = base > 0 ? 28 : -28;\r\n                        break;\r\n                }\r\n\r\n                tooltip += \"<tr><td>\" + effect + \"</td><td style=\\\"padding-left: 25px; text-align: right;\\\" class=\\\"\" + (bad ? \"critical\" : \"stable\") + \"\\\">\";\r\n                tooltip += base + (modifier * (whClass -1)) + \"%</td></tr>\";\r\n            }\r\n            tooltip += \"</table>\";\r\n            $(\"#infoSecurity\").append(\"&nbsp;<span class='pointer' data-tooltip='\" + tooltip + \"'>\" + system.effect + \"</span>\");\r\n        }\r\n\r\n        // Statics\r\n        for (var x in system.statics) {\r\n            var type = system.statics[x];\r\n            var wormhole = appData.wormholes[type];\r\n            var color = \"wh\";\r\n\r\n            switch (wormhole.leadsTo) {\r\n                case \"High-Sec\":\r\n                    color = \"hisec\";\r\n                    break;\r\n                case \"Low-Sec\":\r\n                    color = \"lowsec\";\r\n                    break;\r\n                case \"Null-Sec\":\r\n                    color = \"nullsec\";\r\n                    break;\r\n            }\r\n\r\n            $(\"#infoStatics\").append(\"<div><span class='\"+ color +\"'>&#9679;</span> <b class='\"+ color +\"'>\"+ wormhole.leadsTo +\"</b> via <span>\"+ wormholeRendering.renderWormholeType(wormhole, type, system) +\"</span></div>\");\r\n        }\r\n\r\n        // Faction\r\n        $(\"#infoFaction\").html(\"&nbsp;\");\r\n    } else {\r\n        // Security\r\n\t\tconst securityText = {HS: 'High-Sec', LS: 'Low-Sec', NS: 'Null-Sec', 'Trig': 'Triglavian' }[system.systemTypeName];\r\n       $(\"#infoSecurity\").addClass(system.systemTypeClass).html(securityText + \" \" + system.baseSecurity.toFixed(2) + system.systemTypeModifiers.join(' '));\r\n\r\n        // Faction\r\n        if(fw) { $(\"#infoFaction\").html(fw.factionMarkup(system)); }\r\n\t\t\r\n\t\t// Gates\r\n\t\tconst connections = guidance.connections(tripwire.map.shortest, viewingSystemID);\r\n\t\tif(connections.length) {\r\n\t\t\t$('#infoStatics').append('<p><b>Gates</b>: ' + connections.map(c => {\r\n\t\t\t\tconst system = systemAnalysis.analyse(c.systemID);\r\n\t\t\t\treturn c.closed ? '<s>' + system.name + '</s> (closed)' : systemRendering.renderSystem(system); \r\n\t\t\t}).join(', ') + '</p>');\r\n\t\t}\r\n\t\t\r\n\t\t// Route to favourites\r\n\t\tfor (var fi in options.favorites) {\r\n\t\t\tconst f = options.favorites[fi];\r\n\t\t\tconst path = guidance.findShortestPath(tripwire.map.shortest, f, viewingSystemID);\r\n\t\t\tif(path) { $('#infoStatics').append('<p><b><a href=\".?system=' + tripwire.systems[f].name + '\">' +tripwire.systems[f].name + '</a></b>: ' + systemRendering.renderPath(path) + '</p>'); }\r\n\t\t}\r\n    }\r\n\r\n\tTooltips.attach($(\"#infoStatics [data-tooltip]\"));\r\n    Tooltips.attach($(\"#infoSecurity [data-tooltip]\"));\r\n\r\n    // Region\r\n    $(\"#infoRegion\").text(tripwire.regions[system.regionID].name);\r\n\r\n    // Info Links\r\n    $(\"#infoWidget .infoLink\").each(function() {\r\n        this.href = $(this).data(\"href\").replace(/\\$systemName/gi, system.name).replace(/\\$systemID/gi, systemID);\r\n    });\r\n\r\n    // Reset undo/redo\r\n    tripwire.signatures.undo[systemID] && tripwire.signatures.undo[systemID].length > 0 ? $(\"#undo\").removeClass(\"disabled\") : $(\"#undo\").addClass(\"disabled\");\r\n    tripwire.signatures.redo[systemID] && tripwire.signatures.redo[systemID].length > 0 ? $(\"#redo\").removeClass(\"disabled\") : $(\"#redo\").addClass(\"disabled\");\r\n\r\n    // Reset delete signature icon\r\n    $(\"#sigTable tr.selected\").length == 0 ? $(\"#signaturesWidget #delete-signature\").addClass(\"disabled\") : $(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\r\n}\r\n\r\nsetTimeout(() => tripwire.systemChange(viewingSystemID, \"init\"), 0);\r\n","var tutorial;\r\n\r\n// infoWidget\r\n$(\"#infoWidget .tutorial\").click(function() {\r\n    tutorial = introJs().setOptions({\r\n        showStepNumbers: false,\r\n        steps: [\r\n            {\r\n                element: document.querySelector(\"#infoWidget\"),\r\n                intro: \"<h4>System information widget</h4><br/><p>Displays information on the currently <b>selected</b> Tripwire system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoGeneral\"),\r\n                intro: \"<p>This section includes:<br/>System Name<br/>Security Rating<br/>Region<br/>Owning Faction Name</p><br/><p>If the selected system is a wormhole with a system effect, that will also be shown - hover over it to view the effect breakdown.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#activityGraph\"),\r\n                intro: \"<p>For K space systems, a graph is shown here containing hourly ship jump and kill information from the EVE API.</p><br/><p>Each category can be toggled by clicking the keys above the graph, and the time period selected with the links below.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoStatics\"),\r\n                intro: \"<p>If a wormhole system is selected, its static wormhole types will appear here. (A static is a wormhole which is always present; when it is closed or expires, a new one will spawn.)</p><br/><p>In K space, the route to each of your favorite systems is shown here.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#favorite-control-wrapper\"),\r\n                intro: \"<p>Use the star to toggle whether this is a 'favorite' system. It shows orange when the current system is a favorite. The other button shows the Favorites panel which will show you all your favorite systems.</p><br/><p>'Favorite' systems in K space can be shown in the chain map, and in the routing panel to the lower left.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#show-favorite\"),\r\n                intro: \"<p>Use this toggle to show favorite systems and their routes on the chain map.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoExtra\"),\r\n                intro: \"<p>For K space systems, the shortest route to the currently visible chain will be shown here, along with the route within the chain.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoLinks\"),\r\n                intro: \"<p>These are some quick links to various sites for this specific system.</p>\"\r\n            },\t\t\t\r\n        ]\r\n    }).start();\r\n});\r\n\r\n// signaturesWidget\r\n$(\"#signaturesWidget .tutorial\").click(function() {\r\n    tutorial = introJs().setOptions({\r\n        showStepNumbers: false,\r\n        steps: [\r\n            {\r\n                element: document.querySelector(\"#signaturesWidget\"),\r\n                intro: \"<h4>System signatures widget</h4><br/><p>Displays all signatures and wormholes in the currently <b>selected</b> Tripwire system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#add-signature\"),\r\n                intro: \"<p>Add new signatures and wormholes manually by clicking the + icon.</p><br/><p>Copy & Paste EVE scanner results anywhere once Tripwire has focus to add or update signatures, repeated pastes will only update with new information.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#delete-signature\"),\r\n                intro: \"<p>Click here or use the keyboard shortcut <b>DELETE</b> to delete <b>selected</b> signatures from this system.</p><br/><p>Click on a row to select it, click multiple rows to delete multiple signatures at once, click a selected row again to unselect it.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#signature-count\"),\r\n                intro: \"<p>This shows the current count of signatures, including wormholes, in the selected system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#undo\"),\r\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Z</b> to undo the last changes you made in this sytem (this includes clipboard pasted changes).</p><br/><p>You can undo multiple times as history is kept in the browser.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#redo\"),\r\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Y</b> to redo the last changes you made in this system (this includes clipboard pasted changes).</p><br/><p>You can redo multiple times as history is kept in the browser.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#toggle-automapper\"),\r\n                intro: \"<p>Click here to toggle the Auto-mapper feature on (orange) or off.</p><br/><p>This feature only works when an in-game character is being actively tracked, otherwise this icon appears disabled.</p><br/><p>The automapper will watch for a change in your in-game system not via a star gate and try to automatically add or update wormholes.</p><br/><p>First it tries to seach for wormholes already added but missing a leads to system, this includes via wormhole type (B274) or with a leads to of 'High-Sec' for example.</p><br/><p>Next it searches for wormholes without any type or leads to at all.</p><br/><p>Finally if there are no wormholes or they all have a leads to system already, it will add a new wormhole.</p><br/><p>If at any time if finds multiple wormholes it can update, a dialog window will appear asking which wormhole you want to update.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#sigTable\"),\r\n                intro: \"<p>Each column can be sorted by clicking the column label, sort by multiple columns by holding the shift key.</p><br/><p>Right-click a column to change the text-alignment.</p>\"\r\n            }\r\n        ]\r\n    }).start();\r\n});\r\n\r\n// notesWidget\r\n$(\"#notesWidget .tutorial\").click(function(e) {\r\n    e.preventDefault();\r\n\r\n    tutorial = introJs().setOptions({\r\n        showStepNumbers: false,\r\n        exitOnEsc: false,\r\n        exitOnOverlayClick: false,\r\n        skipLabel: \"Abort\",\r\n        steps: [\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<h4>System notes widget</h4><br/><p>Displays comments based on the currently <b>selected</b> Tripwire system.</p><br/><p>The rest of this tutorial will guide you through actually adding a comment, but don't worry we will switch you to your private Tripwire mask so we don't disturb anyone else.</p><br/><p>When you finish or leave this tutorial we will switch you back to your previous Tripwire mask.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#add-comment\"),\r\n                intro: \"<p>Now click the + icon to begin adding a new comment in this system (\" + viewingSystem + \").</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>Type some basic text now and click save.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>This is our newly created comment. Hover over the comment with your mouse to see additional information and controls.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>You can click the 'pin' or 'sticky' button to toggle showing this comment for every system, not just this system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>Use the <b>Edit</b> to modify a comment and <b>Delete</b> to remove a comment.</p><br/><p>You can also quickly edit any comment by simply doubling clicking anywhere on it.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>Click on the <b>Edit</b> now on our comment.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>The toolbar at the top allows you to customize your notes.</p><br/><p>You can also click on the <b>Maximize/Minimize</b> button (the far right toolbar icon) to edit this comment in full screen mode.</p><br/><p>In full screen mode you will see 1 new button added to the toolbar to view the source code of the comment where you can write HTML, CSS, and even Javascript in your notes!</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>This concludes the tutorial, we will now switch you back to your previous Tripwire mask and delete the comment we created.</p>\"\r\n            }\r\n        ]\r\n    }).start();\r\n\r\n    tutorial.onchange(function(element) {\r\n        switch(tutorial._currentStep) {\r\n            case 1:\r\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\r\n\r\n                console.log(\"switch mask to private\");\r\n                tutorial.previousMask = options.masks.active;\r\n                options.masks.active = options.character.id + \".1\";\r\n                options.save();\r\n\r\n                tutorial.stepFunc = function() {\r\n                    setTimeout(function() {\r\n                        tutorial._options.steps[2].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\r\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\r\n\r\n                        tutorial.exiting = false;\r\n                        tutorial.exit().start().goToStep(3);\r\n                        tutorial.exiting = true;\r\n                    }, 200);\r\n                }\r\n\r\n                $(\"#notesWidget #add-comment\").on(\"click\", tutorial.stepFunc);\r\n                break;\r\n            case 2:\r\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\r\n                $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\r\n\r\n                tutorial.stepFunc = function() {\r\n                    tutorial.comment = $(this).closest(\".comment\");\r\n                    setTimeout(function() {\r\n                        tutorial._options.steps[3].element = tutorial.comment[0];\r\n                        tutorial._options.steps[4].element = tutorial.comment.find(\".commentSticky\")[0];\r\n                        tutorial._options.steps[5].element = tutorial.comment.find(\".commentControls\")[0];\r\n                        tutorial._options.steps[6].element = tutorial.comment.find(\".commentControls\")[0];\r\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\r\n\r\n                        tutorial.exiting = false;\r\n                        tutorial.exit().start().goToStep(4);\r\n                        tutorial.exiting = true;\r\n                    }, 200);\r\n                }\r\n\r\n                $(\"#notesWidget\").on(\"click\", \".commentSave\", tutorial.stepFunc);\r\n                break;\r\n            case 6:\r\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\r\n                $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\r\n\r\n                tutorial.stepFunc = function() {\r\n                    setTimeout(function() {\r\n                        tutorial._options.steps[7].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\r\n                        tutorial._options.steps[8].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\r\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\r\n\r\n                        tutorial.exiting = false;\r\n                        tutorial.exit().start().goToStep(8);\r\n                        tutorial.exiting = true;\r\n                    }, 200);\r\n                }\r\n\r\n                $(\"#notesWidget\").on(\"click\", \".commentEdit\", tutorial.stepFunc);\r\n                break;\r\n        }\r\n    });\r\n\r\n    tutorial.onexit(function() {\r\n        if (tutorial.exiting) {\r\n            $(\".commentCancel:visible\").click();\r\n            // delete the tutorial comment that was created\r\n            if (tutorial.comment) {\r\n                var data = {\"mode\": \"delete\", \"commentID\": tutorial.comment.data(\"id\")};\r\n\r\n                $.ajax({\r\n                    url: \"comments.php\",\r\n                    type: \"POST\",\r\n                    data: data,\r\n                    dataType: \"JSON\"\r\n                }).done(function(data) {\r\n                    if (data && data.result == true) {\r\n                        tutorial.comment.remove();\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (tutorial.previousMask) {\r\n                setTimeout(function() {\r\n                    console.log(\"change mask back, delete comment\", tutorial.previousMask);\r\n                    options.masks.active = tutorial.previousMask;\r\n                    options.save();\r\n                }, 200);\r\n            }\r\n\r\n            // remove event listeners\r\n            $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\r\n            $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\r\n            $(\"#notesWidget\").off(\"click\", \".commentEdit\", tutorial.stepFunc);\r\n            $(\"#notesWidget\").off(\"click\", \".cke_toolgroup:has(.cke_button__toolbarswitch)\", tutorial.stepFunc);\r\n        }\r\n    });\r\n\r\n    tutorial.previousMask;\r\n    tutorial.comment;\r\n    tutorial.stepFunc;\r\n    tutorial.exiting = true;\r\n});\r\n","tripwire.undo = function() {\n    if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n        $(\"#undo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.undo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var undoItem = tripwire.signatures.undo[viewingSystemID][lastIndex];\n        var redo = $.map(undoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(undoItem.action) {\n            case \"add\":\n                data.signatures.remove = data.signatures.remove.concat($.map(undoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"remove\":\n                data.signatures.add = data.signatures.add.concat(undoItem.signatures);\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(undoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.undo[viewingSystemID].pop();\n\n                $(\"#redo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.redo) {\n                    if (undoItem.action == \"remove\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": data.results});\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": redo});\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": undoItem.signatures});\n                    }\n                } else {\n                    if (undoItem.action == \"remove\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": data.results}];\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": redo}];\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": undoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n                $(\"#undo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","var activity = new function() {\r\n\tthis.graph;\r\n\tthis.options;\r\n\tthis.view;\r\n\tthis.span = 24;\r\n\tthis.columns = [\r\n\t\t{id: \"time\", label: \"Time\", role: \"domain\", type: \"string\", calc: function(d, r) { return d.getValue(r, 0) + \"h\"; }},\r\n\t\t{id: \"jumps\", label: \"Jumps\", role: \"data\", type: \"number\", sourceColumn: 1, column: 1, title: \"Jumps\"},\r\n\t\t{id: \"podkills\", label: \"Pod Kills\", role: \"data\", type: \"number\", sourceColumn: 2, column: 2, title: \"Pod Kills\"},\r\n\t\t{id: \"shipkills\", label: \"Ship Kills\", role: \"data\", type: \"number\", sourceColumn: 3, column: 3, title: \"Ship Kills\"},\r\n\t\t{id: \"npckills\", label: \"NPC Kills\", role: \"data\", type: \"number\", sourceColumn: 4, column: 4, title: \"NPC Kills\"},\r\n\t\t//{id: \"annotationLabel\", label: \"Test\", role: \"annotation\", type: \"string\", sourceColumn: 5, title: \"Test\"},\r\n\t\t//{id: \"annotationText\", label: \"Test\", role: \"annotationText\", type: \"string\", sourceColumn: 6, title: \"Test\"}\r\n\t];\r\n\r\n\tthis.getData = function(span, cache) {\r\n\t\tvar span = typeof(span) !== \"undefined\" ? span : this.span;\r\n\t\tvar cache = typeof(cache) !== \"undefined\" ? cache : true;\r\n\r\n\t\t// Google hasn't finished loading yet\r\n\t\tif (!activity.graph) {\r\n\t\t\t\tsetTimeout(function() {activity.getData(span, cache)}, 500);\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn $.ajax({\r\n\t\t\turl: \"activity_graph.php\",\r\n\t\t\tdata: {systemID: viewingSystemID, time: span},\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"JSON\",\r\n\t\t\tcache: cache\r\n\t\t}).done(function(json) {\r\n\t\t\tif (json) {\r\n\t\t\t\tjson.rows.reverse();\r\n\t\t\t\tactivity.view = new google.visualization.DataView(new google.visualization.DataTable(json));\r\n\t\t\t\tactivity.view.setColumns(activity.columns);\r\n\t\t\t\tactivity.graph.draw(activity.view, activity.options);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tthis.selectHandler = function() {\r\n\t\tvar selections = activity.graph.getSelection();\r\n\r\n\t\tif (selections[0] && selections[0].row == null) {\r\n\t\t\tvar c = selections[0].column;\r\n\r\n\t\t\tif (activity.columns[c].sourceColumn) {\r\n\t\t\t\t//activity.columns[c].calc = function() { return null };\r\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title + \" (off)\";\r\n\t\t\t\tdelete activity.columns[c].sourceColumn;\r\n\t\t\t} else {\r\n\t\t\t\tactivity.columns[c].sourceColumn = activity.columns[c].column;\r\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title;\r\n\t\t\t\t//delete activity.columns[c].calc;\r\n\t\t\t}\r\n\r\n\t\t\tactivity.view.setColumns(activity.columns);\r\n\t\t\tactivity.options.animation.duration = 0;\r\n\t\t\tactivity.graph.draw(activity.view, activity.options);\r\n\t\t\tactivity.options.animation.duration = 500;\r\n\t\t}\r\n\t}\r\n\r\n\tthis.init = function() {\r\n\t\tactivity.graph = new google.visualization.AreaChart(document.getElementById(\"activityGraph\"));\r\n\t\tactivity.options = {\r\n\t\t\tisStacked: false,\r\n\t\t\tbackgroundColor: \"transparent\",\r\n\t\t\thAxis: {textStyle: {color: \"#999\", fontName: \"Verdana\", fontSize: 10}, showTextEvery: 3},\r\n\t\t\tvAxis: {textStyle: {color: \"#666\", fontName: \"Verdana\", fontSize: 10}, viewWindowMode: \"maximized\", viewWindow: {min: 0}, maxValue: 5},\r\n\t\t\tgridlineColor: \"#454545\",\r\n\t\t\tpointSize: 2,\r\n\t\t\tlineWidth: 1,\r\n\t\t\theight: 150,\r\n\t\t\tchartArea: {left: \"10%\", top: \"5%\", width: \"88%\", height: \"85%\"},\r\n\t\t\tlegend: {position: \"in\", textStyle: {color: \"#CCC\", fontName: \"Verdana\", fontSize: 8.5}},\r\n\t\t\tanimation: {duration: 500, easing: \"inAndout\"},\r\n\t\t\ttooltip: {showColorCode: true},\r\n\t\t\tannotations: {style: \"line\", textStyle: {fontSize: 12, color: \"#ccc\"}, domain: 0},\r\n\t\t\tfocusTarget: \"category\"\r\n\t\t}\r\n\r\n\t\tgoogle.visualization.events.addListener(activity.graph, \"select\", activity.selectHandler);\r\n\r\n\t\tactivity.getData(activity.span);\r\n\t}\r\n\r\n\tthis.time = function(span) {\r\n\t\tswitch(span) {\r\n\t\t\tcase 24:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 3;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 48:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 6;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 168:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 24;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis.span = span;\r\n\t\tthis.getData(span);\r\n\t}\r\n\r\n\tthis.redraw = function() {\r\n\t\tthis.graph.draw(this.view, this.options);\r\n\t}\r\n\r\n\tthis.refresh = function(cache) {\r\n\t\tthis.getData(this.span, cache);\r\n\t}\r\n\r\n\tgoogle.charts.setOnLoadCallback(this.init);\r\n}\r\n","var CKConfig = {\n\tskin: \"custom\",\n\theight: 100,\n\tallowedContent: true,\n\textraPlugins: \"toolbarswitch,autogrow,autolink\",\n\tenterMode: CKEDITOR.ENTER_BR,\n\tremoveDialogTabs: 'link:advanced',\n\tautoGrow_onStartup: true,\n\tautoGrow_minHeight: 100,\n\ttoolbar_minToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\"]},\n\t\t{name: \"paragraph\", items: [\"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\"]},\n\t\t{name: \"tools\", items: [\"Toolbarswitch\"]}\n\t],\n\ttoolbar_maxToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\", \"Subscript\", \"Superscript\"]},\n\t\t{name: \"paragraph\", items: [\"NumberedList\", \"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\", \"Font\"]},\n\t\t{name: \"tools\", items: [\"Source\", \"Toolbarswitch\"]}\n\t],\n\ttoolbar: \"minToolbar\",\n\tsmallToolbar: \"minToolbar\",\n\tmaximizedToolbar: \"maxToolbar\",\n\tfontSize_style: {\n\t    element:        'span',\n\t    styles:         { 'font-size': '#(size)' },\n\t    overrides:      [ { element :'font', attributes: { 'size': null } } ]\n\t}\n}\n\nCKEDITOR.on(\"instanceLoaded\", function(cke) {\n\tcke.editor.on(\"contentDom\", function() {\n\t\tcke.editor.on(\"key\", function(e) {\n\t\t\tif (e.data.keyCode == 27) {\n\t\t\t\t// escape key cancels\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentCancel\").click();\n\t\t\t\treturn false;\n\t\t\t} else if (e.data.domEvent.$.altKey && e.data.domEvent.$.keyCode == 83) {\n\t\t\t\t// alt+s saves\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentSave\").click();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t});\n\n\t$(\".cke_combo__font a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n\n\t$(\".cke_combo__fontsize a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n});\n\nCKEDITOR.on(\"instanceReady\", function(cke) {\n\t// ensure focus on init\n\tcke.editor.focus();\n\n\tvar s = cke.editor.getSelection(); // getting selection\n\tvar selected_ranges = s.getRanges(); // getting ranges\n\tvar node = selected_ranges[0].startContainer; // selecting the starting node\n\tvar parents = node.getParents(true);\n\n\tnode = parents[parents.length - 2].getFirst();\n\n\tif (!node) return false;\n\n\twhile (true) {\n\t\tvar x = node.getNext();\n\t\tif (x == null) {\n\t\t\tbreak;\n\t\t}\n\t\tnode = x;\n\t}\n\n\ts.selectElement(node);\n\tselected_ranges = s.getRanges();\n\tselected_ranges[0].collapse(false);  //  false collapses the range to the end of the selected node, true before the node.\n\ts.selectRanges(selected_ranges);  // putting the current selection there\n});\n\nCKEDITOR.on(\"dialogDefinition\", function(ev) {\n\tif (ev.data.name == 'link') {\n\t\tev.data.definition.getContents('target').get('linkTargetType')['default'] = '_blank';\n\t}\n});\n","// Firefox (and some other browsers) don't support 'zoom' CSS\r\n// This snippet hooks up a variant using transform(scale) to JQuery\r\n// See e.g. https://medium.com/@sai_prasanna/simulating-css-zoom-with-css3-transform-scale-461d1b9762d6\r\nif (document.createElement(\"detect\").style.zoom != \"\"){\r\n\t$.cssNumber.zoom = true;\r\n    $.cssHooks.zoom = {\r\n        get: function(elem, computed, extra) {\r\n            var value = $(elem).data('zoom');\r\n            return value != null ? value : 1;\r\n        },\r\n        set: function(elem, scale) {\r\n            var $e = $(elem);\r\n            var e = $e[0];\r\n            var data = $e.data('zoom');\r\n            if (data == null) {\r\n                $e.data('origWidth', e.clientWidth);\r\n                $e.data('origHeight', e.clientHeight);\r\n            }\r\n            $e.data('zoom', scale);\r\n            const width = $e.data('origWidth');\r\n            const height = $e.data('origHeight');\r\n            e.style.transform = 'scale(' + scale + ')';\r\n            e.style.transformOrigin = '0 0';\r\n            const bot = (height/scale - height);\r\n            const right = (width/scale - width);\r\n            e.style.marginBottom = (-bot) + 'px';\r\n            e.style.marginRight = (-right) + 'px';\r\n        }\r\n    };\r\n}","const fw = new _FactionWarfare();\r\n\r\nfunction _FactionWarfare() {\r\n\tconst _this = this;\r\n\tthis.listeners = [];\r\n\tthis.data = null;\r\n\tthis.systems = {};\r\n\tthis.SamanuniAthounonGateOpen = true;\r\n\t\r\n\t/** Refresh the FW data from the public ESI endpoint */\r\n\tthis.refresh = function() {\r\n\t\t$.ajax({\r\n\t\t\turl: 'cached_third_party.php?key=fw',\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"JSON\"\r\n\t\t}).done(function(data, status, xhr) {\t\r\n\t\t\tif(!_.isEqual(data, _this.data)) {\r\n\t\t\t\tconsole.info('Updating faction warfare status');\r\n\t\t\t\t_this.data = data;\r\n\t\t\t\t_this.parse(data);\r\n\t\t\t\ttripwire.systemChange(viewingSystemID);\r\n\t\t\t\tguidance.clearCache();\r\n\t\t\t}\r\n\t\t}).fail(function(xhr, status, error) {\r\n\t\t\tconsole.warn('Failed to fetch FW data from ESI: ' + status, error);\r\n\t\t});\r\n\t};\t\r\n\t\r\n\tthis.parse = function(data) {\r\n\t\tthis.systems = {};\r\n\t\tfor(var i = 0; i < data.length; i++) { this.systems[data[i].solar_system_id] = data[i]; }\r\n\t\tthis.SamanuniAthounonGateOpen = this.systems[30003856].occupier_faction_id == 500001;\r\n\t}\r\n\t\r\n\t// Guidance plugin\r\n\tthis.adjustJumpCost = function(from, to, cost) {\r\n\t\tconst gateOpen = this.SamanuniAthounonGateOpen || !((from == 3856 && to == 45322) || (to == 3856 && from == 45322));\r\n\t\treturn gateOpen ? cost : -1;\r\n\t}.bind(this);\t// because it's called from outside\r\n\tguidance.jumpCostModifiers.push(this.adjustJumpCost);\r\n\t\r\n\t/** Gets the markup for faction text for a system. If it's in FW, it will show contested status; if not it will just show the faction */\r\n\tthis.factionMarkup = function(system) {\r\n\t\treturn system.factionID ? (\r\n\t\t\t_this.systems[system.systemID] ? \r\n\t\t\t\tappData.factions[_this.systems[system.systemID].occupier_faction_id].name + ' (FW: ' + \r\n\t\t\t\t\t(_this.systems[system.systemID].contested == 'uncontested' ? 'uncontested' : \r\n\t\t\t\t\t\tMath.floor(100 * _this.systems[system.systemID].victory_points / _this.systems[system.systemID].victory_points_threshold) + '% contested') + ')'\r\n\t\t\t\t: appData.factions[system.factionID].name\r\n\t\t) : \"&nbsp;\";\r\n\t};\r\n\t\r\n\tsetInterval(this.refresh, 3600000);\r\n\tthis.refresh();\t\r\n}","/** Functions for rendering things relating to masks */\r\nconst maskRendering = new function() { \r\n\t/** Render a mask, as returned from masks.php */\r\n\tthis.renderMask = function(mask) {\r\n\t\tconst icons = { global: 'eye', character: 'user', corporate: 'star', alliance: 'star' };\r\n\r\n\t\treturn '<span class=\"mask\" data-mask=\"' + mask.mask + '\">'\r\n\t\t\t+ '<i data-icon=\"' + icons[mask.ownerType] + '\" class=\"' + mask.ownerType + '\"></i>'\r\n\t\t\t+ mask.label\r\n\t\t\t+ '</span>';\r\n\t}\r\n\t\r\n\tthis.update = function(masks, newActive) {\r\n\t\tconst activeMask = masks.find(x => newActive !== undefined ? x.mask === newActive : x.active);\r\n\t\tdocument.getElementById('mask').innerHTML = maskRendering.renderMask(activeMask);\r\n\t\tconst list = document.getElementById('mask-menu-mask-list');\r\n\t\tlist.innerHTML = '';\r\n\t\tmasks.filter(m => m.owner || (m.joined || m.joinedBy == 'alliance') || m == activeMask).map(m => {\r\n\t\t\tconst a = document.createElement('a');\r\n\t\t\ta.href = '#';\r\n\t\t\ta.innerHTML = this.renderMask(m);\r\n\t\t\tif(m === activeMask) { a.className = 'active'; }\r\n\t\t\ta.addEventListener('click', e => {\r\n\t\t\t\tmaskFunctions.updateActiveMask(m.mask, () => document.getElementById('mask-menu').style.display = 'none');\r\n\t\t\t});\r\n\t\t\tlist.appendChild(a);\r\n\t\t});\r\n\t}\r\n};","// Model and data binding for mass related UI\r\ntripwire.massOptions = {\r\n\thiggs: false,\r\n\tprop: false\r\n}\r\n\t\r\ntripwire.resetMassOptions = function() {\r\n\t$(\"#hot-jump\").removeClass(\"active\");\r\n\ttripwire.massOptions.prop = false;\t\t\r\n\t$(\"#higgs-jump\").removeClass(\"active\");\r\n\ttripwire.massOptions.higgs = false;\r\n};\r\n\r\n$(\"#hot-jump\").click(function() {\r\n\tif ($(this).hasClass(\"active\")) {\t\t\r\n\t\t$(this).removeClass(\"active\");\r\n\t\ttripwire.massOptions.prop = false;\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\t\ttripwire.massOptions.prop = true;\r\n\t}\r\n});\r\n\r\n$(\"#higgs-jump\").click(function() {\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\t\ttripwire.massOptions.higgs = false;\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\t\ttripwire.massOptions.higgs = true;\r\n\t}\r\n});\r\n","const tracking = {\r\n\tremove: function(characterID) {\r\n\t\t$(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\t\t\r\n\t},\r\n\tadd: function(character) {\r\n\t\tvar $clone = $(\"#tracking-clone\").clone();\r\n\t\t$clone.attr(\"data-characterid\", characterID);\r\n\t\t$clone.find(\".avatar img\").attr(\"src\", \"https://image.eveonline.com/Character/\"+ character.characterID +\"_32.jpg\");\r\n\t\t$clone.find(\".name\").html(character.characterName);\r\n\t\t$clone.removeAttr(\"id\");\r\n\t\t$clone.removeClass(\"hidden\");\r\n\t\t$clone.addClass(\"tracking-clone\");\r\n\r\n\t\t$(\"#tracking\").append($clone);\r\n\t\tTooltips.attach($clone.find(\".avatar [data-tooltip]\"));\r\n\t\t\r\n\t\tconst charOptions = options.tracking.characterOptions[character.characterID] || tracking.defaultCharacterOptions;\r\n\t\tif(charOptions.show) { $clone.find('.show').addClass('active'); }\r\n\t\tif(charOptions.showShip) { $clone.find('.show-ship').addClass('active'); }\r\n\t\t\r\n\t\treturn $clone;\r\n\t},\r\n\tdefaultCharacterOptions: { show: true, showShip: true }\r\n\t\r\n};\r\n\r\n$(\"#track\").on(\"click\", \".tracking-clone\", function() {\r\n\tvar characterID =$(this).attr(\"data-characterid\");\r\n\t$(\"#tracking .tracking-clone\").removeClass(\"active\");\r\n\r\n\tif (options.tracking.active == characterID) {\r\n\t\toptions.tracking.active = null;\r\n\t\ttripwire.EVE(false, true);\r\n\t\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\r\n\t} else {\r\n\t\toptions.tracking.active = characterID;\r\n\r\n\t\tif (tripwire.esi.characters[options.tracking.active]) {\r\n\t\t\t$(\"#tracking .tracking-clone[data-characterid='\"+ options.tracking.active +\"']\").addClass(\"active\");\r\n\t\t\ttripwire.EVE(tripwire.esi.characters[options.tracking.active], true);\r\n\t\t}\r\n\r\n\t\t$(\"#removeESI\").removeAttr(\"disabled\");\r\n\t}\r\n\tset_tracking_text();\r\n\toptions.save();\r\n});\r\n\r\n$(\"#track\").on(\"click\", \".tracking-clone i.interactable\", function(e) {\r\n\tconst elem = e.target;\r\n\tconst container = $(elem).closest('.tracking-clone')[0];\r\n\tconst characterID = container.dataset.characterid;\r\n\tconst wasActive = $(elem).hasClass('active');\r\n\tif(wasActive) {\r\n\t\t$(elem).removeClass('active');\r\n\t} else {\r\n\t\t$(elem).addClass('active');\r\n\t}\r\n\te.stopPropagation();\r\n\t\r\n\tif(!options.tracking.characterOptions[characterID]) { options.tracking.characterOptions[characterID] = tracking.defaultCharacterOptions; }\r\n\t\r\n\toptions.tracking.characterOptions[characterID][elem.dataset.property] = !wasActive;\r\n\ttripwire.esi.updateTracking(tripwire.esi.characters[characterID]);\r\n});\r\n\r\n$(\"#login\").on(\"click\", \"#removeESI\", function() {\r\n\tvar characterID = options.tracking.active;\r\n\r\n\toptions.tracking.active = null;\r\n\ttripwire.EVE(false, true);\r\n\toptions.save();\r\n\r\n\t$(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\r\n\r\n\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\r\n\r\n\tif ($.isArray(tripwire.data.esi.delete)) {\r\n\t\ttripwire.data.esiDelete.push(characterID);\r\n\t} else {\r\n\t\ttripwire.data.esiDelete = [characterID];\r\n\t}\r\n});\r\n\r\n\r\n/** Set UI text based on the current tracked character */\r\nfunction set_tracking_text() {\r\n\tif(tripwire.esi.characters[options.tracking.active]) {\r\n\t\tdocument.getElementById('user-track-name').textContent = tripwire.esi.characters[options.tracking.active].characterName;\r\n\t\tdocument.getElementById('user-track').style.display = '';\r\n\t\tdocument.getElementById('user-no-track').style.display = 'none';\r\n\t} else {\r\n\t\tdocument.getElementById('user-track').style.display = 'none';\r\n\t\tdocument.getElementById('user-no-track').style.display = '';\t\r\n\t}\r\n}\r\n","const wormholeAnalysis = new function() {\r\n\t/** Finds the ID for a target system or system type for the given system name text and wormhole type.\r\n\t@param systemText The name of a system, or a system class from appData.genericSystemTypes, e.g. 'Low-Sec'\r\n\t@param wormholeType The type text of a wormhole e.g. 'U210'\r\n\t@return An ID - either a systemID (31001031), a system type ID (7) or null if there isn't enough information */\r\n\tthis.targetSystemID = function(systemText, wormholeType) {\r\n\t\tconst lookupText = systemText || (appData.wormholes[(wormholeType + '').toUpperCase()] || {}).leadsTo;\r\n\t\tif(!lookupText) { return null; }\r\n\t\tif (Object.index(appData.systems, \"name\", lookupText, true)) {\r\n\t\t\t// Leads To is a normal EVE system, so use the sytem ID\r\n\t\t\treturn Object.index(appData.systems, \"name\", lookupText, true)\r\n\t\t} else if (wormholeType && appData.wormholes[wormholeType.toUpperCase()]) {\r\n\t\t\t// Leads To can be determined by the wormhole type, so lets use what we know it leads to\r\n\t\t\tif (appData.genericSystemTypes.findIndex((item) => lookupText.replace(' ', '-').toLowerCase() === item.toLowerCase()) > -1) {\r\n\t\t\t\treturn appData.genericSystemTypes.findIndex((item) => lookupText.replace(' ', '-').toLowerCase() === item.toLowerCase());\r\n\t\t\t}\r\n\t\t} else if (appData.genericSystemTypes.findIndex((item) => lookupText.toLowerCase() === item.toLowerCase()) !== -1) {\r\n\t\t\t// Leads To is one of the valid types we allow, so use of of those indexes as reference\r\n\t\t\treturn appData.genericSystemTypes.findIndex((item) => systemText.toLowerCase() === item.toLowerCase());\r\n\t\t} else { return null; }\r\n\t};\r\n\t\r\n\t/** Get all the eligible wormhole types for this connection.\r\n\tIf both systems are known (e.g. C3 to C2) then only wormhole types matching that specific connection will be returned. If either side is unknown then all connections to/from the known side are listed, which will be quite large. If both are unknown then return null (as it could be any wormhole).\r\n\t@param sourceID The system ID, type ID (into genericSystemType) or chain format string (e.g. 2|1232) for the source system\r\n\t@param targetID As above for the target system\r\n\t@param dataSource A source set of wormhole types to evaluate (defaults to appData.wormholes)\r\n\t@return An object of the form { from: [...], to: [...] } where each list is the wormhole types (from appData.wormholes) eligible for that direction */\r\n\tthis.eligibleWormholeTypes = function(sourceDef, targetDef, dataSource) {\r\n\t\tconst coerce = function(def) { return def === undefined || def === null || def.genericSystemType ? def : systemAnalysis.analyse(def); };\r\n\t\tconst source = coerce(sourceDef), target = coerce(targetDef);\r\n\t\t\r\n\t\tif(!source && !target) { return null; }\r\n\t\t\r\n\t\tconst from = [], to = [];\r\n\t\tconst systemTypeMatch = function(possibleSystems, genericTypes) {\r\n\t\t\treturn genericTypes.some(genericType => possibleSystems.indexOf(genericType) >= 0 ||\r\n\t\t\t\t(genericType.indexOf('/') >= 0 && _.some(genericType.substring('Class-'.length).split('/'), x => possibleSystems.indexOf('Class-' + x) >= 0))\r\n\t\t\t);\r\n\t\t};\r\n\t\tconst matches = function(possibleSystems, exclusions, system) {\r\n\t\t\tif(typeof possibleSystems === 'string') { possibleSystems = [possibleSystems]; }\r\n\t\t\treturn (!system) || (\r\n\t\t\t\t((!possibleSystems) || (possibleSystems.indexOf(system.name) >= 0 || systemTypeMatch(possibleSystems, system.genericSystemType))) && \r\n\t\t\t\t((!exclusions) || exclusions.indexOf(system.genericSystemType) < 0)\t// no exclusion\r\n\t\t\t);\r\n\t\t}\r\n\t\tObject.entries(dataSource || appData.wormholes).forEach(function(e) {\r\n\t\t\tconst wt = e[1], key = e[0];\r\n\t\t\tif(matches(wt.from, wt.notFrom, source) && matches(wt.leadsTo, wt.notLeadsTo, target)) { from.push(objAndKey(wt, key)); }\r\n\t\t\tif(matches(wt.from, wt.notFrom, target) && matches(wt.leadsTo, wt.notLeadsTo, source)) { to.push(objAndKey(wt, key)); }\r\n\t\t});\r\n\t\treturn { from: from, to: to };\r\n\t}\r\n\t\r\n\tfunction objAndKey(o, k) { return o && Object.assign({key: k}, o); }\r\n\t\r\n\t/** Placeholder wormholes which don't have an exact known type, but still provide some information */\r\n\tthis.dummyWormholes = {\r\n\t\t\"GATE\": { from: [ \"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Triglavian\"], leadsTo: [ \"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Triglavian\"] },\r\n\t\t\"SML\": { \"key\": \"SML\", \"jump\": 5000000, \"dummy\": true },\r\n\t\t\"MED\": { \"key\": \"MED\", \"jump\": 62000000, \"mass\": 500000000, \"dummy\": true },\r\n\t\t\"LRG\": { \"key\": \"LRG\", \"jump\": 375000000, \"mass\": 2000000000, \"dummy\": true },\r\n\t\t\"XLG\": { \"key\": \"XLG\", \"jump\": 2000000000, \"mass\": 3300000000, \"dummy\": true },\r\n\t};\r\n\t\r\n\t/** Get the wormhole type object from the type names for a sig pair. One of the types is probably K162 */\r\n\tthis.wormholeFromTypePair = function(type1, type2) {\r\n\t\treturn appData.wormholes[type1] || appData.wormholes[type2] ||\r\n\t\t\tthis.dummyWormholes[type1] || this.dummyWormholes[type2] ||\r\n\t\t\tundefined;\t// we don't know anything\r\n\t}\r\n\t\r\n\tthis.likelyWormhole = function(system1, system2) {\r\n\t\tconst class1 = systemAnalysis.analyse(system1).genericSystemType,\r\n\t\t\tclass2 = systemAnalysis.analyse(system2).genericSystemType;\r\n\t\t\r\n\t\tfunction isHighClass(classes) { return classes && classes.some(c => ['Class-5', 'Class-6' ].indexOf(c) >= 0); }\r\n\t\tfunction isKSpace(classes) { return classes && classes.toString().indexOf('-Sec') >= 0; }\r\n\t\tfunction inferKSpace(genericTypes) {\r\n\t\t\treturn isHighClass(genericTypes) ? 'XLG' :\r\n\t\t\tgenericTypes == 'Class-1' ? 'MED' :\r\n\t\t\t'LRG';\r\n\t\t}\r\n\t\t\r\n\t\treturn this.dummyWormholes[\r\n\t\t\tisKSpace(class1) ? inferKSpace(class2) : isKSpace(class2) ? inferKSpace(class1) :\r\n\t\t\tString(class1 + '/' + class2).indexOf('-13') >= 0 ? 'SML' :\r\n\t\t\tclass1 == 'Class-1' || class2 == 'Class-1' ? 'MED' :\r\n\t\t\tisHighClass(class1) && isHighClass(class2) ? 'XLG' :\r\n\t\t\t'LRG'\r\n\t\t];\r\n\t}\r\n}","$(\"#admin\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\")) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (!$(\"#dialog-admin\").hasClass(\"ui-dialog-content\")) {\r\n\t\tvar refreshTimer = null;\r\n\t\tvar $total = null;\r\n\t\tvar $ajax = null;\r\n\r\n\t\tfunction refreshWindow() {\r\n\t\t\tif ($ajax) $ajax.abort();\r\n\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\r\n\r\n\t\t\t$ajax = $.ajax({\r\n\t\t\t\turl: \"admin.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: {mode: $(\"#dialog-admin .menu .active\").attr(\"data-window\")},\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.results) {\r\n\t\t\t\t\tvar rows = data.results;\r\n\t\t\t\t\tvar ids = [];\r\n\r\n\t\t\t\t\tfor (var i = 0, l = rows.length; i < l; i++) {\r\n\t\t\t\t\t\tvar $row = $(\"#dialog-admin .window .hasFocus tbody tr[data-id='\"+ rows[i].id +\"']\");\r\n\t\t\t\t\t\tids.push(rows[i].id);\r\n\r\n\t\t\t\t\t\tif ($row.length) {\r\n\t\t\t\t\t\t\tfor (col in rows[i]) {\r\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\r\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? Intl.NumberFormat().format(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$row = $(\"#dialog-admin .window .hasFocus table tr.hidden\").clone();\r\n\t\t\t\t\t\t\t$row.attr(\"data-id\", rows[i].id);\r\n\r\n\t\t\t\t\t\t\tfor (col in rows[i]) {\r\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\r\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? Intl.NumberFormat().format(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$row.removeClass(\"hidden\");\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-admin .window .hasFocus tbody\").append($row);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").each(function() {\r\n\t\t\t\t\t\tif ($.inArray($(this).data(\"id\").toString(), ids) == -1) {\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table\").trigger(\"update\", [true]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\r\n\t\t\t});\r\n\r\n\t\t\tif ($(\"#dialog-admin\").dialog(\"isOpen\") && $(\"#dialog-admin .menu .active\").attr(\"data-refresh\")) {\r\n\t\t\t\trefreshTimer = setTimeout(refreshWindow, $(\"#dialog-admin .menu .active\").attr(\"data-refresh\"));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$(\"#dialog-admin\").dialog({\r\n\t\t\tautoOpen: true,\r\n\t\t\tmodal: true,\r\n\t\t\theight: 350,\r\n\t\t\twidth: 800,\r\n\t\t\tbuttons: {\r\n\t\t\t\tClose: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t// menu toggle\r\n\t\t\t\t$(\"#dialog-admin\").on(\"click\", \".menu li\", function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t$menuItem = $(this);\r\n\t\t\t\t\tclearTimeout(refreshTimer);\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .menu .active\").removeClass(\"active\");\r\n\t\t\t\t\t$menuItem.addClass(\"active\");\r\n\t\t\t\t\t$(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\").html(\"\");\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window [data-window]\").removeClass(\"hasFocus\").hide();\r\n\t\t\t\t\t$(\"#dialog-admin .window [data-window='\"+ $menuItem.data(\"window\") +\"']\").addClass(\"hasFocus\").show();\r\n\r\n\t\t\t\t\trefreshWindow();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-admin [data-sortable='true']\").tablesorter({\r\n\t\t\t\t\tsortReset: true,\r\n\t\t\t\t\twidgets: ['saveSort'],\r\n\t\t\t\t\tsortList: [[0,0]]\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// dialog bottom tray\r\n\t\t\t\t$($(this)[0].parentElement).find(\".ui-dialog-buttonpane\").append(\"<div class='ui-dialog-traypane'></div>\");\r\n\t\t\t\t$total = $(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\");\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$menuItem = $(\"#dialog-admin .menu li.active\");\r\n\t\t\t\trefreshWindow();\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tclearTimeout(refreshTimer);\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-admin\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-admin\").dialog(\"open\");\r\n\t}\r\n});\r\n","// Dialog effects\r\n$(\"#wrapper\").addClass(\"transition\");\r\n\r\n$(document).on(\"dialogopen\", \".ui-dialog\", function (event, ui) {\r\n\t// Add additional full screen overlay for 2nd level dialog\r\n\tif ($(\".ui-dialog:visible\").length == 2 && $(this).hasClass(\"dialog-modal\"))\r\n\t\t$(\"body\").append($(\"<div id='overlay' class='overlay' />\").css(\"z-index\", $(this).css(\"z-index\") - 1));\r\n\telse if ($(\"#overlay\"))\r\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 1);\r\n\r\n\tif (!$(this).hasClass(\"dialog-noeffect\"))\r\n\t\t$(\"#wrapper\").addClass(\"blur\");\r\n});\r\n\r\n$(document).on(\"dialogclose\", \".ui-dialog\", function (event, ui) {\r\n\tif (!$(\".ui-dialog\").is(\":visible\"))\r\n\t\t$(\"#wrapper\").removeClass(\"blur\");\r\n\r\n\tif ($(\".ui-dialog:visible\").length == 1)\r\n\t\t$(\"#overlay\").remove();\r\n\telse if ($(\"#overlay\"))\r\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 2);\r\n\r\n\t//if ($(\".ui-dialog:visible\").length == 0 && options.buttons.follow && viewingSystemID != tripwire.client.EVE.systemID)\r\n\t//\twindow.location = \"?system=\"+tripwire.client.EVE.systemName;\r\n});\r\n\r\n","const maskFunctions = {\r\n\t\tgetMasks: function() {\r\n\t\t\t// Get masks\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"masks.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(response) {\r\n\t\t\t\tif (response && response.masks) {\r\n\t\t\t\t\ttripwire.masks = response.masks;\r\n\t\t\t\t\tmaskRendering.update(tripwire.masks);\r\n\t\t\t\t\t$(\"#dialog-masks #masks #default\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-masks #masks #owned\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-masks #masks #invited\").html(\"\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst iconBar = mask => \r\n\t\t\t\t\t\t'<span class=\"icon_bar\">' +\r\n\t\t\t\t\t\t(mask.optional ? '<a href=\"#\" class=\"icon ' + (mask.joined ? 'closeIcon' : 'joinIcon') + '\" data-tooltip=\"' + (mask.joined ? 'Remove from quick switch' : 'Add to quick switch') + '\">' +\r\n\t\t\t\t\t\t\t(mask.joined ? '×' : '+') + '</a>' : '')\r\n\t\t\t\t\t\t+ '</span>';\r\n\r\n\r\n\t\t\t\t\tfor (var x in response.masks) {\r\n\t\t\t\t\t\tvar mask = response.masks[x];\r\n\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t+ iconBar(mask)\r\n\t\t\t\t\t\t\t+ '<span class=\"source_bar ' + mask.joinedBy+'\">&nbsp;</span>'\r\n\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+maskRendering.renderMask(mask)\r\n\t\t\t\t\t\t\t\t+ ((mask.joined || mask.owner) ? ' <i data-icon=\"star\" data-tooltip=\"On quick switch\"></i>' : '')\r\n\t\t\t\t\t\t\t+ '</span></label>');\r\n\r\n\t\t\t\t\t\t$(\"#dialog-masks #masks #\"+mask.type).append(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"create\" id=\"create-mask\" class=\"selector\" />'\r\n\t\t\t\t\t\t+ '<label for=\"create-mask\"><i data-icon=\"plus\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i>'\r\n\t\t\t\t\t\t+ '<span class=\"source_bar personal\">&nbsp;</span>'\r\n\t\t\t\t\t\t+ '<span class=\"selector_label\">Create</span></label>');\r\n\t\t\t\t\t\r\n\t\t\t\t\tnode.click(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t$(\"#dialog-createMask\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(\"#dialog-masks #masks #owned\").append(node);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst activeMask = response.masks.find(x => x.active);\r\n\t\t\t\t\t$(\"#dialog-masks input[name='mask']\").filter(\"[value='\"+activeMask.mask+\"']\").attr(\"checked\", true).trigger(\"change\");\r\n\r\n\t\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t\tdocument.getElementById('admin').style.display = activeMask.admin ? '' : 'none';\r\n\t\t\t\t\t\r\n\t\t\t\t\t// fix tooltips for new elements\r\n\t\t\t\t\tTooltips.attach($(\"#dialog-masks\").find(\"[data-tooltip]\"));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}, \r\n\t\tupdateActiveMask: function(newActive, afterFunction) {\r\n\t\t\t\tvar maskChange = false;\r\n\t\t\t\tif (options.masks.active != newActive) {\r\n\t\t\t\t\tmaskChange = true;\r\n\t\t\t\t\toptions.masks.active = newActive;\r\n\t\t\t\t\tmaskRendering.update(tripwire.masks, newActive);\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions.save() // Performs AJAX\r\n\t\t\t\t\t.done(function() {\r\n\t\t\t\t\t\tif (maskChange) {\r\n\t\t\t\t\t\t\t// Reset signatures\r\n\t\t\t\t\t\t\t$(\"#sigTable span[data-age]\").countdown(\"destroy\");\r\n\t\t\t\t\t\t\t$(\"#sigTable tbody\").empty()\r\n\t\t\t\t\t\t\t$(\"#signature-count\").html(0);\r\n\t\t\t\t\t\t\ttripwire.signatures.list = {};\r\n\t\t\t\t\t\t\ttripwire.client.signatures = [];\r\n\r\n\t\t\t\t\t\t\ttripwire.refresh('change');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(afterFunction) { afterFunction(); }\r\n\t\t\t\t\t});\t\t\r\n\t\t},\r\n};\r\n\r\n$(\"#dialog-masks\").dialog({\r\n\tautoOpen: false,\r\n\twidth: 450,\r\n\tminHeight: 400,\r\n\tmodal: true,\r\n\tbuttons: {\r\n\t\tSave: function() {\r\n\t\t\tmaskFunctions.updateActiveMask($(\"#dialog-masks input[name='mask']:checked\").val(), () => {\r\n\t\t\t\t// toggle mask admin icon\r\n\t\t\t\tdocument.getElementById('admin').disabled = !$(\"#dialog-masks input[name='mask']:checked\").data(\"admin\");\t\t\t\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t});\r\n\t\t},\r\n\t\tClose: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\t\t\r\n\t}, \r\n\r\n\t\topen: function() { maskFunctions.getMasks(); }\r\n\t\r\n});\r\n\r\n$(\"#mask-menu-link\").click(function(e) {\r\n\te.preventDefault();\r\n\tconst elem = document.getElementById('mask-menu');\r\n\telem.style.display = elem.style.display == 'none' ? '' : 'none';\r\n});\r\n\r\n$(\"#mask-link\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\"))\r\n\t\treturn false;\r\n\t\r\n\t$(\"#dialog-masks\").dialog('open');\r\n });\r\n \r\n// Mask selections\r\n$(\"#masks\").on(\"change\", \"input.selector:checked\", function() {\r\n\tif ($(this).data(\"owner\")) {\r\n\t\t$(\"#maskControls #edit\").removeAttr(\"disabled\");\r\n\t\t$(\"#maskControls #delete\").removeAttr(\"disabled\");\r\n\t} else {\r\n\t\t$(\"#maskControls #edit\").attr(\"disabled\", \"disabled\");\r\n\t\t$(\"#maskControls #delete\").attr(\"disabled\", \"disabled\");\r\n\t}\r\n\r\n\tif ($(this).val() != 0.0 && $(this).val().split(\".\")[1] == 0) {\r\n\t\t$(\"#dialog-masks #leave\").removeAttr(\"disabled\");\r\n\t} else {\r\n\t\t$(\"#dialog-masks #leave\").attr(\"disabled\", \"disabled\");\r\n\t}\r\n});\r\n\r\nconst joinMask = maskID => {\r\n\tconst completeFunction = () => {\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: {mask: maskID, mode: \"join\"},\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\tmaskFunctions.getMasks();\r\n\t\t\t\t\t\t\t\t$(\"#dialog-joinMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\t\r\n\t};\r\n\t\r\n\tconst mask = tripwire.masks.find(m => m.mask === maskID);\r\n\tif(!mask) { throw 'unknown mask ' + maskID; }\r\n\t\r\n\tif(mask.joinedBy === 'corporate') {\r\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"This will add the mask '\" + mask.label + \" to the quick switch list for your whole corporation. Is that what you want?\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tConfirm: function() {\r\n\t\t\t\t\t\t\tcompleteFunction();\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\t\t\r\n\t} else { completeFunction(); }\r\n};\r\n\r\n\t\t\t// Mask join\r\n\t\t\t$(\"#dialog-masks #masks\").on(\"click\", \".joinIcon\", function() {\r\n\t\t\t\tvar maskElem = $(this).closest(\"input.selector+label\").prev();\r\n\t\t\t\tjoinMask(maskElem.val());\r\n\t\t\t});\r\n\r\n\t\t\t// Mask leave\r\n\t\t\t$(\"#dialog-masks #masks\").on(\"click\", \".closeIcon\", function() {\r\n\t\t\t\tvar maskElem = $(this).closest(\"input.selector+label\").prev();\r\n\t\t\t\tconst mask = tripwire.masks.find(m => m.mask === maskElem.val());\r\n\t\t\t\tif(!mask) { throw 'unexpected mask ' + maskElem.val(); }\r\n\t\t\t\t\r\n\t\t\t\tconst completeFunction = () => {\r\n\t\t\t\t\t\t\tvar send = {mode: \"leave\", mask: maskElem.val()};\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\tdata: send,\r\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t\tmaskFunctions.getMasks();\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\tif(mask.joinedBy === 'corporate') {\r\n\t\t\t\t\t$(\"#dialog-confirm #msg\").text(\"This will remove the mask '\" + mask.label + \" from the quick switch list for your whole corporation. Is that what you want?\");\r\n\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\tConfirm: function() {\r\n\t\t\t\t\t\t\t\tcompleteFunction();\r\n\t\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).dialog(\"open\");\t\t\t\t\t\t\t\r\n\t\t\t\t} else { completeFunction(); }\r\n\t\t\t\t\r\n\t\t\t});\r\n\r\n\t\t\t// Mask delete\r\n\t\t\t$(\"#maskControls #delete\").click(function() {\r\n\t\t\t\tvar mask = $(\"#masks input.selector:checked\");\r\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to delete this mask?\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tDelete: function() {\r\n\t\t\t\t\t\t\tvar send = {mode: \"delete\", mask: mask.val()};\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\tdata: send,\r\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t\tmaskFunctions.getMasks();\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// User Create mask\r\n\t\t\t$(\"#dialog-createMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tCreate: function() {\r\n\t\t\t\t\t\t$(\"#dialog-createMask form\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \"#create_add+label\", function() {\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-createMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\tmaskFunctions.getMasks();\r\n\r\n\t\t\t\t\t\t\t\t$(\"#dialog-createMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-createMask select\").selectmenu({width: 100});\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\t$(\"#dialog-createMask input[name='name']\").val(\"\");\r\n\t\t\t\t\t$(\"#dialog-createMask #accessList :not(.static)\").remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \".maskRemove\", function() {\r\n\t\t\t\t$(this).closest(\"input.selector+label\").prev().remove();\r\n\t\t\t\t$(this).closest(\"label\").remove();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tfunction makeAccessListNode(item, prefix, name) {\r\n\t\t\t\tconst extraAttributes = prefix == 'edit' ? 'checked=\"checked\" onclick=\"return false\"' : '';\r\n\t\t\t\tconst buttons = prefix == 'edit' ? '<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />' : '';\r\n\t\t\t\tif (item.category == \"character\") {\r\n\t\t\t\t\treturn $(''\r\n\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" ' + extraAttributes + ' name=\"' + name + '\" id=\"' + prefix + '_'+item.id+'_1373\" value=\"'+item.id+'_1373\" class=\"selector\" />'\r\n\t\t\t\t\t\t+ '<label for=\"' + prefix + '_'+item.id+'_1373\">'\r\n\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+item.id+'_64.jpg\" />'\r\n\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\r\n\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t+ '\t\t'+item.name + '<br/>'\r\n\t\t\t\t\t\t+ '\t\t'+item.corporation.name+'<br/>'\r\n\t\t\t\t\t\t+ '\t\t'+(item.alliance ? item.alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t+ buttons\r\n\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t+ '</label></div>');\r\n\r\n\t\t\t\t} else if (item.category == \"corporation\") {\r\n\t\t\t\t\treturn $(''\r\n\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" ' + extraAttributes + ' name=\"' + name + '\" id=\"' + prefix + '_'+item.id+'_2\" value=\"'+item.id+'_2\" class=\"selector\" />'\r\n\t\t\t\t\t\t+ '<label for=\"' + prefix + '_'+item.id+'_2\">'\r\n\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+item.id+'_64.png\" />'\r\n\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\r\n\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t+ '\t\t'+item.name+'<br/>'\r\n\t\t\t\t\t\t+ '\t\t'+(item.alliance ? item.alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t+ buttons\r\n\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t+ '</label></div>');\r\n\r\n\t\t\t\t} else if (item.category == \"alliance\") {\r\n\t\t\t\t\treturn $(''\r\n\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" ' + extraAttributes + ' name=\"' + name + '\" id=\"' + prefix + '_'+item.id+'_3\" value=\"'+item.id+'_3\" class=\"selector\" />'\r\n\t\t\t\t\t\t+ '<label for=\"' + prefix + '_'+item.id+'_3\">'\r\n\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Alliance/'+item.id+'_64.png\" />'\r\n\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Alliance</span>'\r\n\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t+ '\t\t'+item.name+'<br/>'\r\n\t\t\t\t\t\t+ buttons\r\n\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t+ '</label></div>');\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\t$(\"#dialog-editMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#dialog-editMask form\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \".maskRemove\", function() {\r\n\t\t\t\t\t\t$(this).closest(\"input.selector+label\").prev().attr(\"name\", \"deletes[]\").hide();\r\n\t\t\t\t\t\t$(this).closest(\"label\").hide();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \"#edit_add+label\", function() {\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-editMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-editMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\tvar mask = $(\"#dialog-masks input[name='mask']:checked\").val();\r\n\t\t\t\t\t$(\"#dialog-editMask input[name='mask']\").val(mask);\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").hide();\r\n\t\t\t\t\t$(\"#dialog-editMask #loading\").show();\r\n\t\t\t\t\t$(\"#dialog-editMask #name\").text($(\"#dialog-masks input[name='mask']:checked+label .selector_label\").text());\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: {mode: \"edit\", mask: mask},\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).then(function(response) {\r\n\t\t\t\t\t\tif (response && response.results && response.results.length) {\r\n\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.results)\r\n\t\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar node = makeAccessListNode(results[x], 'edit', '');\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).then(function(response) {\r\n\t\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").show();\r\n\t\t\t\t\t\t$(\"#dialog-editMask #loading\").hide();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList :not(.static)\").remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// EVE search dialog\r\n\t\t\t$(\"#dialog-EVEsearch\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tAdd: function() {\r\n\t\t\t\t\t\tif ($(\"#accessList input[value='\"+$(\"#EVESearchResults input\").val()+\"']\").length) {\r\n\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Already has access\");\r\n\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(\"#EVESearchResults .info\").append('<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />');\r\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"checked\", \"checked\");\r\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"onclick\", \"return false\");\r\n\r\n\t\t\t\t\t\tvar nodes = $(\"#EVESearchResults .maskNode:has(input:checked)\");\r\n\r\n\t\t\t\t\t\tif ($(\"#dialog-createMask\").dialog(\"isOpen\"))\r\n\t\t\t\t\t\t\t$(\"#dialog-createMask #accessList .static:first\").before(nodes);\r\n\t\t\t\t\t\telse if ($(\"#dialog-editMask\").dialog(\"isOpen\"))\r\n\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(nodes);\r\n\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t},\r\n\t\t\t\t\tClose: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#EVEsearch\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tif ($(\"#EVEsearch input[name='name']\").val() == \"\") {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\r\n\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").show();\r\n\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\t\t\ttripwire.esi.search($(\"#EVEsearch input[name='name']\").val(), $(\"#EVEsearch input[name='category']:checked\").map((x, e) => e.value).get().join(','), $(\"#EVEsearch input[name='exact']\")[0].checked)\r\n\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\tif (results && (results.character || results.corporation || results.alliance)) {\r\n\t\t\t\t\t\t\t\t\t// limit results\r\n\t\t\t\t\t\t\t\t\tresults = [].concat(results.character || [],results.corporation || [], results.alliance || []);\r\n\t\t\t\t\t\t\t\t\ttotal = results.length;\r\n\t\t\t\t\t\t\t\t\tresults = results.slice(0, 10);\r\n\t\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(results)\r\n\t\t\t\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchCount\").html(\"Found: \"+total+\"<br/>Showing: \"+(total<10?total:10));\r\n\t\t\t\t\t\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = makeAccessListNode(results[x], 'find', 'adds[]');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"No Results\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\r\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).fail(data => {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Error from ESI while searching\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\r\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#EVEsearch input[name='name']\").val(\"\");\r\n\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$(\"#maskControls #edit\").click(function() {\r\n\t\t\t\t$(\"#dialog-editMask\").dialog(\"open\");\r\n\t\t\t});\r\n","\r\n\t\t$(\"#dialog-mass\").dialog({\r\n\t\t\tautoOpen: false,\r\n\t\t\twidth: \"auto\",\r\n\t\t\theight: \"auto\",\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tClose: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\tvar wormholeID = $(this).data(\"id\");\r\n\t\t\t\tvar systemID = $(this).data(\"systemID\");\r\n\t\t\t\tvar wormhole = tripwire.client.wormholes[wormholeID];\r\n\t\t\t\tvar signature = tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\tvar otherSignature = tripwire.client.signatures[wormhole.secondaryID];\r\n\t\t\t\t\r\n\t\t\t\tconst fromSystem = systemAnalysis.analyse(signature.systemID), toSystem = systemAnalysis.analyse(otherSignature.systemID);\r\n\t\t\t\t\r\n\t\t\t\tconst wormholeType = wormhole.type ? tripwire.wormholes[wormhole.type] : \r\n\t\t\t\t\tObject.assign({from: fromSystem.genericSystemType, leadsTo: toSystem.genericSystemType }, wormholeAnalysis.likelyWormhole(signature.systemID, otherSignature.systemID));\r\n\r\n\t\t\t\t$(\"#dialog-mass\").dialog(\"option\", \"title\", \"From \"+fromSystem.name+\" to \"+toSystem.name);\r\n\t\t\t\tdocument.getElementById('mass-systems').innerHTML = \"From \"+systemRendering.renderSystem(fromSystem)+\r\n\t\t\t\t\" To \"+systemRendering.renderSystem(toSystem) +\r\n\t\t\t\t\" via \"+wormholeRendering.renderWormholeType(wormholeType, wormhole.type, fromSystem, toSystem);\r\n\r\n\t\t\t\t$(\"#dialog-mass #massTable tbody tr\").remove();\r\n\t\t\t\tdocument.getElementById('mass-jumped').innerText = '?';\r\n\t\t\t\tdocument.getElementById('mass-capacity').innerText = '?';\r\n\r\n\t\t\t\tvar payload = {wormholeID: wormhole.id};\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"mass.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: payload,\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(data) {\r\n\t\t\t\t\tif (data && data.jumps) {\r\n\t\t\t\t\t\tconst massData = parseMassData(data.jumps);\r\n\t\t\t\t\t\tdocument.getElementById('mass-jumped').innerText = wormholeRendering.renderMass(massData.totalMass);\r\n\t\t\t\t\t\tdocument.getElementById('mass-capacity').innerText = wormholeType.mass ? wormholeRendering.renderMass(wormholeType.mass) : 'Unknown';\r\n\t\t\t\t\t\tdocument.getElementById('mass-placeholder-desc').style.display = wormholeType.dummy ? '' : 'none';\r\n\t\t\t\t\t\tfor (x in massData.jumps) {\r\n\t\t\t\t\t\t\tconst j = massData.jumps[x];\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst massMarkup = (j.massClass === 'Small' ? '' :\r\n\t\t\t\t\t\t\t\t\t'<i data-icon=\"prop-mod\" class=\"' + (j.prop ? ' active' : 'inactive') + '\"></i>' +\r\n\t\t\t\t\t\t\t\t\t'<i data-icon=\"anchor\" class=\"' + (j.higgs ? ' active' : 'inactive') + '\"></i> '\r\n\t\t\t\t\t\t\t\t) + wormholeRendering.renderMass(j.mass);\r\n\t\t\t\t\t\t\t$(\"#dialog-mass #massTable tbody\").append(\"<tr class='mass-\" + getMassClass(j.mass) + \"'><td>\"+j.characterName+\"</td><td>\"+(j.targetSystem == systemID ? \"Into \" + systemRendering.renderSystem(toSystem, 'span') : \"Return to \" + systemRendering.renderSystem(fromSystem, 'span'))+\"</td><td>\"+j.shipName+\"</td><td>\"+massMarkup+\"</td><td>\"+j.time+\"</td></tr>\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Summary rows\r\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr id='small-mass'><td></td><td></td><td>Small jumps</td><td>\"+ wormholeRendering.renderMass(massData.smallMass) +\"</td><td></td></tr>\");\r\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr id='medium-mass'><td></td><td></td><td>Medium jumps</td><td>\"+ wormholeRendering.renderMass(massData.mediumMass) +\"</td><td></td></tr>\");\r\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr id='large-mass'><td></td><td></td><td>Large jumps</td><td>\"+ wormholeRendering.renderMass(massData.largeMass) +\"</td><td></td></tr>\");\r\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr><td></td><td></td><td></td><th>\"+ wormholeRendering.renderMass(massData.totalMass) +\"</th><td></td></tr>\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\nfunction getMassClass(jumpMass) {\r\n\treturn jumpMass <= 5e6 ? 'Small' :\r\n\t jumpMass <= 80e6 ? 'Medium' :\r\n\t jumpMass <= 500e6 ? 'Large' :\r\n\t 'X-Large';\r\n}\r\n\r\nfunction parseMassData(jumps) {\r\n\tconst result = { totalMass: 0, smallMass: 0, mediumMass: 0, largeMass: 0, xlMass: 0, jumps: [] };\r\n\tfor (x in jumps) {\r\n\t\tconst shipData = appData.mass[jumps[x].shipTypeID];\r\n\t\tif(!shipData) { continue; }\t// sometimes ship is not recorded, or ship isn't in SDE dump yet\r\n\t\tconst originalMass = parseFloat(shipData.mass);\r\n\t\tconst shipFlagsText = jumps[x].shipType.split('|', 2)[1] || '';\r\n\t\tconst shipFlags = { higgs: shipFlagsText.indexOf('h') >= 0, prop: shipFlagsText.indexOf('p') >= 0 };\r\n\t\tconst massClass = getMassClass(originalMass);\r\n\t\tconst jumpMass = (originalMass + (shipFlags.prop ? (massClass === 'X-Large' ? 500e6 : 50e6) : 0)) * (shipFlags.higgs ? 2 : 1);\r\n\t\tresult.totalMass += jumpMass;\r\n\t\tswitch(massClass) {\r\n\t\t\tcase 'Small': result.smallMass += jumpMass; break;\r\n\t\t\tcase 'Medium': result.mediumMass += jumpMass; break;\r\n\t\t\tcase 'Large': result.largeMass += jumpMass; break;\r\n\t\t\tcase 'X-Large': result.xlMass += jumpMass; break;\r\n\t\t}\r\n\t\tresult.jumps.push( { \r\n\t\t\toriginalMass: originalMass, mass: jumpMass, massClass: massClass,\r\n\t\t\thiggs: shipFlags.higgs, prop: shipFlags.prop, shipName: shipData.typeName,\r\n\t\t\ttargetSystem: jumps[x].toID, \r\n\t\t\tcharacterName: jumps[x].characterName.split('|')[0],\r\n\t\t\ttime: jumps[x].time \r\n\t\t});\r\n\t}\r\n\treturn result;\r\n}","$(\".options\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\"))\r\n\t\treturn false;\r\n\r\n\t$(\"#dialog-options\").dialog({\r\n\t\tautoOpen: false,\r\n\t\twidth: 450,\r\n\t\tminHeight: 400,\r\n\t\tmodal: true,\r\n\t\tbuttons: {\r\n\t\t\tSave: function() {\r\n\t\t\t\t// Options\r\n\t\t\t\tvar data = {mode: \"set\", options: JSON.stringify(options)};\r\n\r\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\r\n\t\t\t\t\r\n\t\t\t\toptions.chain.sigNameLocation = $(\"#dialog-options #chainSigNameLocation\").val();\r\n\t\t\t\toptions.chain.routingLimit = 1 * $(\"#dialog-options #chainRoutingLimit\").val();\r\n\t\t\t\toptions.chain.routeSecurity = $(\"#dialog-options #chainRouteSecurity\").val();\r\n\t\t\t\toptions.chain.routeIgnore.enabled = $(\"#dialog-options #route-ignore-enabled\").prop('checked');\r\n\t\t\t\toptions.chain.routeIgnore.systems = $(\"#dialog-options #route-ignore\").val().split(\",\").map(x => x.trim());\r\n\r\n\t\t\t\toptions.chain.gridlines = 'true' == $(\"#dialog-options input[name=gridlines]:checked\").val();\r\n\t\t\t\toptions.chain.aura = 'true' == $(\"#dialog-options input[name=aura]:checked\").val();\r\n\t\t\t\toptions.chain.scrollWithoutCtrl = 'true' == $(\"#dialog-options input[name=scrollWithoutCtrl]:checked\").val();\r\n\r\n\t\t\t\toptions.chain.nodeSpacing.x = $(\"#dialog-options #node-spacing-x-slider\").slider(\"value\");\r\n\t\t\t\toptions.chain.nodeSpacing.y = $(\"#dialog-options #node-spacing-y-slider\").slider(\"value\");\r\n\t\t\t\t\r\n\t\t\t\toptions.chain.lineWeight = $(\"#dialog-options #node-spacing-line-weight-slider\").slider(\"value\");\r\n\t\t\t\t\r\n\t\t\t\toptions.chain[\"node-reference\"] = $(\"#dialog-options input[name=node-reference]:checked\").val();\r\n\t\t\t\t\r\n\t\t\t\toptions.chain.renderer = $(\"#dialog-options #renderer\").val();\r\n\r\n\t\t\t\toptions.signatures.editType = $(\"#dialog-options #editType\").val();\r\n\r\n\t\t\t\toptions.signatures.pasteLife = $(\"#dialog-options #pasteLife\").val();\r\n\r\n\t\t\t\toptions.signatures.copySeparator = $(\"#dialog-options #copySeparator\").val();\r\n\r\n\t\t\t\toptions.background = $(\"#dialog-options #background-image\").val();\r\n\r\n\t\t\t\toptions.uiscale = $(\"#dialog-options #uiscale-slider\").slider(\"value\");\r\n\r\n\t\t\t\toptions.apply();\r\n\t\t\t\toptions.save(); // Performs AJAX\r\n\r\n\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\r\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", false).removeClass(\"ui-state-disabled\");\r\n\r\n\t\t\t},\r\n\t\t\tReset: function() {\r\n\t\t\t\t$(\"#dialog-confirm #msg\").html(\"Settings will be reset to defaults temporarily.<br/><br/><p><em>Save settings to make changes permanent.</em></p>\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tReset: function() {\r\n\t\t\t\t\t\t\toptions.reset();\r\n\t\t\t\t\t\t\toptions.apply();\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t},\r\n\t\t\tClose: function() {\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t}\r\n\t\t},\r\n\t\topen: function() {\r\n\t\t\t// Get user stats data\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"user_stats.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tfor (i in data.stats) {\r\n\t\t\t\t\tfor (x in data.stats[i]) {\r\n\t\t\t\t\t\t$(\"#optionsAccordion #\"+ x).text(data.stats[i][x]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(\"#optionsAccordion #systems_visited\").text(data.system_visits);\r\n\t\t\t\t$(\"#optionsAccordion #logins\").text(data.account.logins);\r\n\t\t\t\t$(\"#optionsAccordion #lastLogin\").text(data.account.lastLogin);\r\n\t\t\t\t$(\"#optionsAccordion #username\").text(data.username);\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-options #editType\").val(options.signatures.editType);\r\n\t\t\t$(\"#dialog-options #pasteLife\").val(options.signatures.pasteLife);\r\n\t\t\t$(\"#dialog-options #copySeparator\").val(options.signatures.copySeparator);\r\n\t\t\t$(\"#dialog-options #chainRoutingLimit\").val(options.chain.routingLimit);\r\n\t\t\t$(\"#dialog-options #chainSigNameLocation\").val(options.chain.sigNameLocation);\r\n\t\t\t$(\"#dialog-options #chainRouteSecurity\").val(options.chain.routeSecurity);\r\n\t\t\t$(\"#dialog-options #route-ignore-enabled\").prop('checked', options.chain.routeIgnore.enabled);\r\n\t\t\t$(\"#dialog-options #route-ignore\").val(options.chain.routeIgnore.systems.join(','));\r\n\t\t\t$(\"#dialog-options #renderer\").val(options.chain.renderer);\r\n\t\t\t$(\"#dialog-options input[name='node-reference'][value='\"+options.chain[\"node-reference\"]+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options input[name='gridlines'][value='\"+options.chain.gridlines+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options input[name='aura'][value='\"+options.chain.aura+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options input[name='scrollWithoutCtrl'][value='\"+options.chain.scrollWithoutCtrl+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options #node-spacing-x-slider\").slider(\"value\", options.chain.nodeSpacing.x);\r\n\t\t\t$(\"#dialog-options #node-spacing-y-slider\").slider(\"value\", options.chain.nodeSpacing.y);\r\n\t\t\t$(\"#dialog-options #node-spacing-line-weight-slider\").slider(\"value\", options.chain.lineWeight);\r\n\t\t\t$(\"#dialog-options #background-image\").val(options.background);\r\n\t\t},\r\n\t\tcreate: function() {\r\n\t\t\t$(\"#optionsAccordion\").accordion({heightStyle: \"content\", collapsible: true, active: false});\r\n\t\t\tfunction setUpSlider(id, value, change, range) {\r\n\t\t\t\trange = Object.assign({min: 0.7, max:1.4, step:0.05}, range);\r\n\t\t\t\t$(\"#\" + id).slider({\r\n\t\t\t\t\tmin: range.min,\r\n\t\t\t\t\tmax: range.max,\r\n\t\t\t\t\tstep: range.step,\r\n\t\t\t\t\tvalue: value || 1.0,\r\n\t\t\t\t\tchange: change,\r\n\t\t\t\t\tslide: function(e, ui) {\r\n\t\t\t\t\t\t$(\"label[for='\" + id + \"']\").html(ui.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"label[for='\" + id + \"']\").html($(\"#\" + id).slider(\"value\"));\r\n\t\t\t}\r\n\t\t\tsetUpSlider('uiscale-slider', options.uiscale, function(e, ui) {\r\n\t\t\t\t\t\t$(\"body\").css(\"zoom\", ui.value);\r\n\t\t\t\t\t});\r\n\t\t\tsetUpSlider('node-spacing-x-slider', options.chain.nodeSpacing.x);\r\n\t\t\tsetUpSlider('node-spacing-y-slider', options.chain.nodeSpacing.y);\r\n\t\t\tsetUpSlider('node-spacing-line-weight-slider', options.chain.lineWeight, undefined, { min: 0.5, max: 1.5 });\r\n\r\n\t\t\t$(\"#dialog-pwChange\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#pwForm\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#pwForm input[name='password'], #pwForm input[name='confirm']\").val(\"\");\r\n\t\t\t\t\t$(\"#pwError\").text(\"\").hide();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pwChange\").click(function() {\r\n\t\t\t\t$(\"#dialog-pwChange\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pwForm\").submit(function(e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$(\"#pwError\").text(\"\").hide();\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"options.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Password changed\");\r\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-pwChange\").dialog(\"close\");\r\n\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t$(\"#pwError\").text(response.error).show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#pwError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-usernameChange\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#usernameForm\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\t$(\"#usernameForm #username\").html($(\"#dialog-options #username\").html());\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#usernameForm [name='username']\").val(\"\");\r\n\t\t\t\t\t$(\"#usernameError\").text(\"\").hide();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#usernameChange\").click(function() {\r\n\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#usernameForm\").submit(function(e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$(\"#usernameError\").text(\"\").hide();\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"options.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Username changed\");\r\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-options #username\").html(response.result);\r\n\r\n\t\t\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"close\");\r\n\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t$(\"#usernameError\").text(response.error).show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#usernameError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"#dialog-options\").dialog(\"open\");\r\n});\r\n","\t\t$(\"#dialog-ping\").dialog({\r\n\t\t\tautoOpen: false,\r\n\t\t\theight: \"auto\",\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tSend: function() {\r\n\t\t\t\t\tvar payload = {systemName: this.systemName, systemText: this.systemText, message: $('#ping-text').val() };\r\n\t\t\t\t\tconst _this = this;\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"ping.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: payload,\r\n\t\t\t\t\t\tdataType: \"text\"\r\n\t\t\t\t\t}).done(function(data) {\t$(_this).dialog(\"close\"); })\r\n\t\t\t\t\t.fail(function(xhr, status, error) { console.log(status, error); });\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\tconst wormholeID = $(this).data(\"id\");\r\n\t\t\t\tconst systemID = $(this).data(\"systemID\");\r\n\t\t\t\tconst wormhole = tripwire.client.wormholes[wormholeID];\r\n\t\t\t\tconst fromSignature = wormhole ? tripwire.client.signatures[wormhole.initialID] : { name: null};\r\n\t\t\t\t\r\n\t\t\t\tthis.systemName = tripwire.systems[systemID].name;\r\n\t\t\t\tthis.systemText = this.systemName + (fromSignature.name !== null && fromSignature.name.length ? ' (' + fromSignature.name + ')' : '');\r\n\t\t\t\t\r\n\t\t\t\t$(\"#dialog-ping\").dialog(\"option\", \"title\", \"Ping about \"+this.systemText);\r\n\t\t\t\t$('#ping-text').val('');\r\n\t\t\t\t$('#ping-text').focus();\r\n\t\t\t}\r\n\t\t});","$(\"#signaturesWidget\").on(\"click\", \"#delete-signature\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).closest(\"tr\").attr(\"disabled\")) {\r\n\t\treturn false;\r\n\t} else if ($(\"#sigTable tr.selected\").length == 0) {\r\n\t\treturn false;\r\n\t} else if ($(\"#dialog-sigEdit\").hasClass(\"ui-dialog-content\") && $(\"#dialog-sigEdit\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-sigEdit\").parent().effect(\"shake\", 300);\r\n\t\treturn false;\r\n\t}\r\n\t\t\r\n\topenDeleteDialog({\r\n\t\tsignatures: $.map($(\"#sigTable tr.selected\"), function(n) {\r\n\t\t\treturn tripwire.client.signatures[$(n).data(\"id\")];\r\n\t\t})\r\n\t});\r\n});\r\n\r\nfunction openDeleteDialog(vm, successFunction) {\r\n\topenDeleteDialog.deleteDialogVM = vm;\t// outside so it's not saved in the closure first time we open the dialog\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-deleteSig\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-deleteSig\").dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tDelete: function() {\r\n\t\t\t\t\t// Prevent duplicate submitting\r\n\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"enable\");\r\n\t\t\t\t\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\r\n\t\t\t\t\tvar undo = [];\r\n\r\n\t\t\t\t\tvar signaturePayload = $.map(openDeleteDialog.deleteDialogVM.signatures, function(signature) {\r\n\t\t\t\t\t\tif (signature.type != \"wormhole\") {\r\n\t\t\t\t\t\t\tundo.push(signature);\r\n\t\t\t\t\t\t\treturn signature.id;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\t\t\t\t\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\r\n\t\t\t\t\t\t\treturn wormhole;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tpayload.signatures.remove = signaturePayload;\r\n\r\n\t\t\t\t\tvar success = function(data) {\r\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\r\n\t\t\t\t\t\t\t$(\"#dialog-deleteSig\").dialog(\"close\");\r\n\t\t\t\t\t\t\tif(successFunction) { successFunction(); }\r\n\r\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\t\t\t\t\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar always = function(data) {\r\n\t\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"enable\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\tconst sigs = openDeleteDialog.deleteDialogVM.signatures;\r\n\t\t\t\t$(\"#dialog-deleteSig\").dialog(\"option\", \"title\", sigs.length == 1 ? 'Delete Signature ' + formatSignatureID(sigs[0].signatureID) : 'Delete Multiple Signatures');\r\n\t\t\t\tdocument.getElementById('deleteSigText').innerText = sigs.length == 1 ? 'The ' + sigs[0].type + ' signature ' + formatSignatureID(sigs[0].signatureID) \r\n\t\t\t\t\t: 'The signatures ' + sigs.map(s => formatSignatureID(s.signatureID)).join(', ');\r\n\t\t\t\tdocument.getElementById('deleteSigSystem').innerHTML = systemRendering.renderSystem(systemAnalysis.analyse(sigs[0].systemID));\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\r\n\t\t\t\t//$(\"#sigTable .sigDelete\").removeClass(\"invisible\");\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-deleteSig\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-deleteSig\").dialog(\"open\");\r\n\t}\r\n}\r\n","const sigDialog = {};\r\nconst sigDialogVM = {};\r\n\r\nsigDialog.openSignatureDialog = function(e) {\r\n\tif(e.preventDefault) { e.preventDefault(); }\t// Allow calls with fake event-like objects too\r\n\tsigDialogVM.mode = e.data.mode;\r\n\t\r\n\tswitch(sigDialogVM.mode) {\r\n\t\tcase 'update':\r\n\t\t\tif (e.data.source == \"sig-row\") {\r\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\r\n\t\t\t\t$(this).closest(\"tr\").addClass(\"selected\");\r\n\t\t\t\tsigDialogVM.sigId = $(this).data('id');\r\n\t\t\t} else if (e.data.source == \"edit-sig\") {\r\n\t\t\t\tvar elements = $(\"#sigTable tbody tr.selected\");\r\n\t\t\t\tif (elements.length !== 1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsigDialogVM.sigId = $(elements[0]).data('id');\r\n\t\t\t\t}\r\n\t\t\t} else { sigDialogVM.sigId = e.data.signature; }\r\n\t\t\tbreak;\r\n\t\tdefault: delete sigDialogVM.sigId;\r\n\t}\r\n\t\r\n\tsigDialogVM.viewingSystemID = ( sigDialogVM.sigId ) ? tripwire.client.signatures[sigDialogVM.sigId].systemID : viewingSystemID;\r\n\tsigDialogVM.viewingSystem = tripwire.systems[sigDialogVM.viewingSystemID];\r\n\t\r\n\tif (!$(\"#dialog-signature\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-signature\").dialog({\r\n\t\t\tautoOpen: true,\r\n\t\t\tresizable: false,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#signaturesWidget\")},\r\n\t\t\tbuttons: {\r\n\t\t\t\tDelete: function() {\r\n\t\t\t\t\tconst d = $(this);\r\n\t\t\t\t\topenDeleteDialog({ signatures: [tripwire.client.signatures[sigDialogVM.sigId]] }, () => d.dialog('close') );\r\n\t\t\t\t},\r\n\t\t\t\tSave: function() {\r\n\t\t\t\t\t$(\"#form-signature\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tAdd: function() {\r\n\t\t\t\t\t$(\"#form-signature\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\tvar aSigWormholes = Object.assign({}, appData.wormholes, wormholeAnalysis.dummyWormholes, { K162: {} } );\r\n\t\t\t\t\r\n\t\t\t\tfunction system_select_item_mapper(items) {\r\n\t\t\t\t\treturn items.concat(appData.genericSystemTypes).map(function(name) {\r\n\t\t\t\t\t\treturn Object.assign({name:name}, systemAnalysis.analyse(name)); \r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='signatureType'], #dialog-signature [name='signatureLife']\").selectmenu({width: 100});\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife'], #dialog-signature [name='wormholeMass']\").selectmenu({width: 80});\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete({source: tripwire.aSigSystems, renderer: 'system', select_item_mapper: system_select_item_mapper, maxSize: 10, delay: 0});\r\n\t\t\t\t\r\n\t\t\t\tfunction getTargetName() { return $(\"#dialog-signature .leadsTo:visible\").val(); }\r\n\t\t\t\tfunction getTargetSystem() {\r\n\t\t\t\t\treturn wormholeAnalysis.targetSystemID(getTargetName(), undefined);\t\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tfunction sigTypeDropdownFiller(extractor) {\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\tconst eligible = wormholeAnalysis.eligibleWormholeTypes(sigDialogVM.viewingSystemID, getTargetSystem());\r\n\t\t\t\t\t\treturn extractor(eligible);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction renderInbound(item) {\t// Render with the type of the systems, if we know, so we don't get \"from: [drifter wormholes]\" if we know we're in a C2\r\n\t\t\t\t\treturn wormholeRendering.renderWormholeType(item, item.key, getTargetName(), sigDialogVM.viewingSystem.name);\r\n\t\t\t\t}\r\n\t\t\t\tfunction renderOutbound(item) {\t// As above\r\n\t\t\t\t\treturn wormholeRendering.renderWormholeType(item, item.key, sigDialogVM.viewingSystem.name, getTargetName());\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigTypeFrom']\").inlinecomplete({source: aSigWormholes, renderer: renderOutbound, maxSize: 10, delay: 0, customDropdown: sigTypeDropdownFiller(function(x) { return x.from; })});\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigTypeTo']\").inlinecomplete({source: aSigWormholes, renderer: renderInbound, maxSize: 10, delay: 0, customDropdown: sigTypeDropdownFiller(function(x) { return x.to; })});\r\n\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").durationPicker();\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").on(\"change\", function() {\r\n\t\t\t\t\t// prevent negative values\r\n\t\t\t\t\tif (this.value < 0) {\r\n\t\t\t\t\t\tthis.value = 0;\r\n\t\t\t\t\t\t$(this).change();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Ensure first signature ID field only accepts letters\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha'], #dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\twhile (!/^[a-zA-Z?]*$/g.test(this.value)) {\r\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Move to the numeric ID after filling out alpha ID\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\tif (this.value.length === 3) {\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric']\").select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\tif (this.value.length === 3) {\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID2_Numeric']\").select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Ensure second signature ID field only accepts numbers\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric'], #dialog-signature [name='signatureID2_Numeric']\").on(\"input\", function() {\r\n\t\t\t\t\twhile (!/^[0-9?]*$/g.test(this.value)) {\r\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// Positioning hack to separate delete button visually\r\n\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Delete')\").css( { position: 'absolute', left: '30px' } );\r\n\r\n\t\t\t\t// Select value on click\r\n\t\t\t\t$(\"#dialog-signature .signatureID, #dialog-signature .wormholeType\").on(\"click\", function() {\r\n\t\t\t\t\t$(this).select();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Auto fill opposite side wormhole w/ K162\r\n\t\t\t\t$(\"#dialog-signature .wormholeType\").on(\"input, change\", function() {\r\n\t\t\t\t\tif (this.value.length > 0 && aSigWormholes[this.value.toUpperCase()] != -1 && this.value.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\r\n\r\n\t\t\t\t\t\t// Also auto calculate duration\r\n\t\t\t\t\t\tif (appData.wormholes[this.value.toUpperCase()]) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(appData.wormholes[this.value.toUpperCase()].life.substring(0, 2) * 60 * 60).change();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (this.value.toUpperCase() === \"K162\") {\r\n\t\t\t\t\t\tif (aSigWormholes[$(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase()] || $(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase() === \"K162\") {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"????\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (this.value == \"????\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Toggle between wormhole and regular signatures\r\n\t\t\t\t$(\"#dialog-signature\").on(\"selectmenuchange\", \"[name='signatureType']\", function() {\r\n\t\t\t\t\tif (this.value == \"wormhole\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideUp(200, function() { $(this).hide(0); });\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideDown(200, function() { $(this).show(200); });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideDown(200, function() { $(this).show(200); });\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideUp(200, function() { $(this).hide(0); });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tValidationTooltips.close();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#form-signature\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar form = $(this).serializeObject();\r\n\t\t\t\t\tvar valid = true;\r\n\t\t\t\t\tValidationTooltips.close();\r\n\r\n\t\t\t\t\t// Validate full signature ID fields (blank | 3 characters)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .signatureID:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.length < 3) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be 3 characters in length!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate full signature ID doesn't already exist in current system\r\n\t\t\t\t\tif (form.signatureID_Alpha.length === 3 && form.signatureID_Numeric.length === 3) {\r\n\t\t\t\t\t\tfor(var sigKey in tripwire.client.signatures) {\r\n\t\t\t\t\t\t\tconst existing = tripwire.client.signatures[sigKey];\r\n\t\t\t\t\t\t\tif((existing.id != sigDialogVM.sigId) && // not the sig we are editing\r\n\t\t\t\t\t\t\t\t(existing.signatureID == form.signatureID_Alpha.toLowerCase() + form.signatureID_Numeric) && // same name\r\n\t\t\t\t\t\t\t\t(existing.systemID == sigDialogVM.viewingSystemID) // in current system\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-signature .signatureID:first\")}).setContent(\"Signature ID already exists! <input type='button' autofocus='true' id='overwrite' value='Overwrite' style='margin-bottom: -4px; margin-top: -4px; font-size: 0.8em;' data-id='\"+ sigKey +\"' />\");\r\n\t\t\t\t\t\t\t\t$(\"#overwrite\").focus();\r\n\t\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate wormhole types (blank | wormhole)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .wormholeType:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && !aSigWormholes[this.value.toUpperCase()] && this.value != \"????\") {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid wormhole type!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate leads to system (blank | system)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && appData.genericSystemTypes.findIndex((item) => this.value.toLowerCase() === item.toLowerCase()) == -1 && !findSystemID(this.value)) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid leads to system!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate leads to isn't the viewing system which causes a inner loop\r\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.toLowerCase() === sigDialogVM.viewingSystem.name.toLowerCase()) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Wormhole cannot lead to the same system it comes from!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\tvar payload = {};\r\n\t\t\t\t\tvar undo = [];\r\n\t\t\t\t\tif (form.signatureType === \"wormhole\") {\r\n\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\r\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\r\n\t\t\t\t\t\t\t\"name\": form.wormholeName,\r\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar leadsTo = wormholeAnalysis.targetSystemID(form.leadsTo, form.wormholeType);\r\n\r\n\t\t\t\t\t\tvar signature2 = {\r\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID2_Alpha + form.signatureID2_Numeric,\r\n\t\t\t\t\t\t\t\"systemID\": leadsTo,\r\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\r\n\t\t\t\t\t\t\t\"name\": form.wormholeName2,\r\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar type = null;\r\n\t\t\t\t\t\tvar parent = null;\r\n\t\t\t\t\t\tif (form.wormholeType.length > 0 && aSigWormholes[form.wormholeType.toUpperCase()] && form.wormholeType.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"initial\";\r\n\t\t\t\t\t\t\ttype = form.wormholeType.toUpperCase();\r\n\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && aSigWormholes[form.wormholeType2.toUpperCase()] && form.wormholeType2.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"secondary\";\r\n\t\t\t\t\t\t\ttype = form.wormholeType2.toUpperCase();\r\n\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"secondary\";\r\n\t\t\t\t\t\t\ttype = \"????\";\r\n\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"initial\";\r\n\t\t\t\t\t\t\ttype = \"????\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar wormhole = {\r\n\t\t\t\t\t\t\t\"type\": type,\r\n\t\t\t\t\t\t\t\"parent\": parent,\r\n\t\t\t\t\t\t\t\"life\": form.wormholeLife,\r\n\t\t\t\t\t\t\t\"mass\": form.wormholeMass\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (sigDialogVM.mode == \"update\") {\r\n\t\t\t\t\t\t\tsignature.id = $(\"#dialog-signature\").data(\"signatureid\");\r\n\t\t\t\t\t\t\tsignature2.id = $(\"#dialog-signature\").data(\"signature2id\");\r\n\t\t\t\t\t\t\twormhole.id = $(\"#dialog-signature\").data(\"wormholeid\");\r\n\r\n\t\t\t\t\t\t\t// Update the initial and type based on which side of the wormhole we are editing\r\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\r\n\t\t\t\t\t\t\t\tif (form.wormholeType.length > 0 && aSigWormholes[form.wormholeType.toUpperCase()] && form.wormholeType.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType.toUpperCase();\r\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && aSigWormholes[form.wormholeType2.toUpperCase()] && form.wormholeType2.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType2.toUpperCase();\r\n\t\t\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\r\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\r\n\r\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\r\n\t\t\t\t\t\t\t\t\t//used to be a wormhole\r\n\t\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// used to be just a regular signature\r\n\t\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (sigDialogVM.mode == \"update\") {\r\n\t\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\t\"id\": $(\"#dialog-signature\").data(\"signatureid\"),\r\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\r\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\r\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\r\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [signature]}};\r\n\r\n\t\t\t\t\t\t\tif (tripwire.client.signatures[signature.id].type == \"wormhole\") {\r\n\t\t\t\t\t\t\t\t//used to be a wormhole\r\n\t\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\t\t\t\t\t\t\tvar signature2 = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// used to be just a regular signature\r\n\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\r\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\r\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\r\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [signature]}};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"disable\");\r\n\r\n\t\t\t\t\tvar success = function(data) {\r\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\r\n\t\t\t\t\t\t\tif (sigDialogVM.mode == \"add\") {\r\n\t\t\t\t\t\t\t\tundo = data.results;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (sigDialogVM.viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[sigDialogVM.viewingSystemID].push({action: sigDialogVM.mode, signatures: undo});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[sigDialogVM.viewingSystemID] = [{action: sigDialogVM.mode, signatures: undo}];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar always = function() {\r\n\t\t\t\t\t\t$(\"#sigEditForm input[type=submit]\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"enable\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\r\n\r\n\t\t\t\t$(\"#dialog-signature input\").val(\"\");\r\n\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(\"unknown\").selectmenu(\"refresh\");\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(\"stable\").selectmenu(\"refresh\");\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(\"stable\").selectmenu(\"refresh\");\r\n\r\n\t\t\t\t$(\"#dialog-signature #site\").show();\r\n\t\t\t\t$(\"#dialog-signature #wormhole\").hide();\r\n\r\n\t\t\t\t// Side labels\r\n\t\t\t\t$(\"#dialog-signature .sideLabel:first\").html(sigDialogVM.viewingSystem.name + \" Side\");\r\n\t\t\t\t$(\"#dialog-signature .sideLabel:last\").html(\"Other Side\");\r\n\r\n\t\t\t\t// Default signature life\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").val(options.signatures.pasteLife * 60 * 60).change();\r\n\r\n\t\t\t\tvar id = sigDialogVM.sigId;\r\n\t\t\t\tif (sigDialogVM.mode == \"update\" && id && tripwire.client.signatures[id]) {\r\n\t\t\t\t\tvar signature = tripwire.client.signatures[id];\r\n\t\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", id);\r\n\r\n\t\t\t\t\t// Change the dialog buttons\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").hide();\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").show();\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Delete')\").show();\r\n\r\n\t\t\t\t\t// Change the dialog title\r\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Edit Signature\");\r\n\r\n\t\t\t\t\tif (signature.type == \"wormhole\") {\r\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == id || wormhole.secondaryID == id) return wormhole; })[0];\r\n\t\t\t\t\t\tvar otherSignature = id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", otherSignature.id);\r\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", wormhole.id);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst sigAlpha = signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\";\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(sigAlpha);\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName']\").val(signature.name);\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='leadsTo']\").val(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : (appData.genericSystemTypes[otherSignature.systemID] ? appData.genericSystemTypes[otherSignature.systemID] : \"\"));\r\n\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Alpha']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(0, 3) : \"???\");\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Numeric']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(3, 5) : \"\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName2']\").val(otherSignature.name);\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(wormhole.life).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(wormhole.mass).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\r\n\t\t\t\t\t\tif (wormhole[wormhole.parent+\"ID\"] == signature.id) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType']\").val(wormhole.type).change();\r\n\t\t\t\t\t\t} else if (wormhole[wormhole.parent+\"ID\"] == otherSignature.id) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType2']\").val(wormhole.type).change();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Focus the sig ID, if it isn't set, otherwise the sig name\r\n\t\t\t\t\t\tif(sigAlpha != '???') { $(\"#dialog-signature input[name='wormholeName']\").select(); }\r\n\t\t\t\t\t\telse { $(\"#dialog-signature input[name='signatureID_Alpha']\").select(); }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\");\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureName']\").val(signature.name);\r\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Not a wormhole - always focus the sig ID\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").select();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Hightlight first ID section, if not set, otherwise the name\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Change the dialog buttons\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").show();\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Delete')\").hide();\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").hide();\r\n\r\n\t\t\t\t\t// Change the dialog title\r\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Add Signature\");\r\n\r\n\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(options.signatures.editType || \"unknown\").selectmenu(\"refresh\")\r\n\t\t\t\t\tif ($(\"#dialog-signature [name='signatureType']\").val() === \"wormhole\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").hide();\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").show();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-signature\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-signature\").dialog(\"open\");\r\n\t}\r\n};\r\n\r\n$(\"#sigTable tbody\").on(\"dblclick\", \"tr\", {mode: \"update\", source:\"sig-row\"}, sigDialog.openSignatureDialog);\r\n$(\"#edit-signature\").on(\"click\", {mode: \"update\", source:\"edit-sig\"}, sigDialog.openSignatureDialog);\r\n$(\"#add-signature\").click({mode: \"add\"}, sigDialog.openSignatureDialog);\r\n\r\n// Signature overwrite. Attached to document because the element gets recreated each time\r\nsigDialog.overwriteSignature = function(sigToRemove, completeFunction, always) {\r\n\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\r\n\tvar undo = [];\r\n\r\n\tvar signature = tripwire.client.signatures[sigToRemove];\r\n\tif (signature.type != \"wormhole\") {\r\n\t\tundo.push(signature);\r\n\t\tpayload.signatures.remove.push(signature.id);\r\n\t} else {\r\n\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\r\n\t\tpayload.signatures.remove.push(wormhole);\r\n\t}\r\n\r\n\tvar success = function(data) {\r\n\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\t\tif (viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\r\n\t\t} else {\r\n\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\r\n\t\t}\r\n\r\n\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t\r\n\t\tcompleteFunction(data);\r\n\t}\r\n\r\n\ttripwire.refresh('refresh', payload, success, always);\r\n}\r\n\r\n/** Delegate the next action after sig overwrite to the save dialog */\r\nsigDialog.delegateSave = function(data) {\r\n\tif (data.resultSet && data.resultSet[0].result == true) {\r\n\t\tValidationTooltips.close();\r\n\r\n\t\tif ($(\"#dialog-signature\").parent().find(\":button:contains('Save')\")) {\r\n\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").click();\r\n\t\t} else {\r\n\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Add')\").click();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$(document).on(\"click\", \"#overwrite\", function() { \r\n\t$(\"#overwrite\").attr(\"disable\", true);\r\n\tsigDialog.overwriteSignature($(this).data(\"id\"), sigDialog.delegateSave, function() {\r\n\t\t$(\"#overwrite\").removeAttr(\"disable\");\r\n\t}); \r\n});\r\n"]}